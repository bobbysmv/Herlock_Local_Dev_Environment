/*
 RequireJS 2.1.5 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 Available via the MIT or new BSD license.
 see: http://github.com/jrburke/requirejs for details

 Sonicmoov bobby@sonicmoov.com
 */
var herlock = (function(){

var requirejs,require,define;
(function(aa){function I(b){return"[object Function]"===L.call(b)}function J(b){return"[object Array]"===L.call(b)}function y(b,c){if(b){var d;for(d=0;d<b.length&&(!b[d]||!c(b[d],d,b));d+=1);}}function M(b,c){if(b){var d;for(d=b.length-1;-1<d&&(!b[d]||!c(b[d],d,b));d-=1);}}function s(b,c){return ga.call(b,c)}function m(b,c){return s(b,c)&&b[c]}function G(b,c){for(var d in b)if(s(b,d)&&c(b[d],d))break}function R(b,c,d,m){c&&G(c,function(c,j){if(d||!s(b,j))m&&"string"!==typeof c?(b[j]||(b[j]={}),R(b[j],
    c,d,m)):b[j]=c});return b}function u(b,c){return function(){return c.apply(b,arguments)}}function ba(b){if(!b)return b;var c=aa;y(b.split("."),function(b){c=c[b]});return c}function B(b,c,d,m){c=Error(c+"\nhttp://requirejs.org/docs/errors.html#"+b);c.requireType=b;c.requireModules=m;d&&(c.originalError=d);return c}function ha(b){function c(a,f,b){var e,n,c,g,d,S,i,h=f&&f.split("/");e=h;var j=k.map,l=j&&j["*"];if(a&&"."===a.charAt(0))if(f){e=m(k.pkgs,f)?h=[f]:h.slice(0,h.length-1);f=a=e.concat(a.split("/"));
    for(e=0;f[e];e+=1)if(n=f[e],"."===n)f.splice(e,1),e-=1;else if(".."===n)if(1===e&&(".."===f[2]||".."===f[0]))break;else 0<e&&(f.splice(e-1,2),e-=2);e=m(k.pkgs,f=a[0]);a=a.join("/");e&&a===f+"/"+e.main&&(a=f)}else 0===a.indexOf("./")&&(a=a.substring(2));if(b&&j&&(h||l)){f=a.split("/");for(e=f.length;0<e;e-=1){c=f.slice(0,e).join("/");if(h)for(n=h.length;0<n;n-=1)if(b=m(j,h.slice(0,n).join("/")))if(b=m(b,c)){g=b;d=e;break}if(g)break;!S&&(l&&m(l,c))&&(S=m(l,c),i=e)}!g&&S&&(g=S,d=i);g&&(f.splice(0,d,
    g),a=f.join("/"))}return a}function d(a){A&&y(document.getElementsByTagName("script"),function(f){if(f.getAttribute("data-requiremodule")===a&&f.getAttribute("data-requirecontext")===i.contextName)return f.parentNode.removeChild(f),!0})}function z(a){var f=m(k.paths,a);if(f&&J(f)&&1<f.length)return d(a),f.shift(),i.require.undef(a),i.require([a]),!0}function h(a){var f,b=a?a.indexOf("!"):-1;-1<b&&(f=a.substring(0,b),a=a.substring(b+1,a.length));return[f,a]}function j(a,f,b,e){var n,C,g=null,d=f?f.name:
    null,j=a,l=!0,k="";a||(l=!1,a="_@r"+(M+=1));a=h(a);g=a[0];a=a[1];g&&(g=c(g,d,e),C=m(q,g));a&&(g?k=C&&C.normalize?C.normalize(a,function(a){return c(a,d,e)}):c(a,d,e):(k=c(a,d,e),a=h(k),g=a[0],k=a[1],b=!0,n=i.nameToUrl(k)));b=g&&!C&&!b?"_unnormalized"+(Q+=1):"";return{prefix:g,name:k,parentMap:f,unnormalized:!!b,url:n,originalName:j,isDefine:l,id:(g?g+"!"+k:k)+b}}function r(a){var f=a.id,b=m(p,f);b||(b=p[f]=new i.Module(a));return b}function t(a,f,b){var e=a.id,n=m(p,e);if(s(q,e)&&(!n||n.defineEmitComplete))"defined"===
    f&&b(q[e]);else r(a).on(f,b)}function v(a,f){var b=a.requireModules,e=!1;if(f)f(a);else if(y(b,function(f){if(f=m(p,f))f.error=a,f.events.error&&(e=!0,f.emit("error",a))}),!e)l.onError(a)}function w(){T.length&&(ia.apply(H,[H.length-1,0].concat(T)),T=[])}function x(a){delete p[a];delete V[a]}function F(a,f,b){var e=a.map.id;a.error?a.emit("error",a.error):(f[e]=!0,y(a.depMaps,function(e,c){var g=e.id,d=m(p,g);d&&(!a.depMatched[c]&&!b[g])&&(m(f,g)?(a.defineDep(c,q[g]),a.check()):F(d,f,b))}),b[e]=!0)}
    function D(){var a,f,b,e,n=(b=1E3*k.waitSeconds)&&i.startTime+b<(new Date).getTime(),c=[],g=[],h=!1,j=!0;if(!W){W=!0;G(V,function(b){a=b.map;f=a.id;if(b.enabled&&(a.isDefine||g.push(b),!b.error))if(!b.inited&&n)z(f)?h=e=!0:(c.push(f),d(f));else if(!b.inited&&(b.fetched&&a.isDefine)&&(h=!0,!a.prefix))return j=!1});if(n&&c.length)return b=B("timeout","Load timeout for modules: "+c,null,c),b.contextName=i.contextName,v(b);j&&y(g,function(a){F(a,{},{})});if((!n||e)&&h)if((A||da)&&!X)X=setTimeout(function(){X=
        0;D()},50);W=!1}}function E(a){s(q,a[0])||r(j(a[0],null,!0)).init(a[1],a[2])}function K(a){var a=a.currentTarget||a.srcElement,b=i.onScriptLoad;a.detachEvent&&!Y?a.detachEvent("onreadystatechange",b):a.removeEventListener("load",b,!1);b=i.onScriptError;(!a.detachEvent||Y)&&a.removeEventListener("error",b,!1);return{node:a,id:a&&a.getAttribute("data-requiremodule")}}function L(){var a;for(w();H.length;){a=H.shift();if(null===a[0])return v(B("mismatch","Mismatched anonymous define() module: "+a[a.length-
        1]));E(a)}}var W,Z,i,N,X,k={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},shim:{},config:{}},p={},V={},$={},H=[],q={},U={},M=1,Q=1;N={require:function(a){return a.require?a.require:a.require=i.makeRequire(a.map)},exports:function(a){a.usingExports=!0;if(a.map.isDefine)return a.exports?a.exports:a.exports=q[a.map.id]={}},module:function(a){return a.module?a.module:a.module={id:a.map.id,uri:a.map.url,config:function(){return k.config&&m(k.config,a.map.id)||{}},exports:q[a.map.id]}}};Z=function(a){this.events=
        m($,a.id)||{};this.map=a;this.shim=m(k.shim,a.id);this.depExports=[];this.depMaps=[];this.depMatched=[];this.pluginMaps={};this.depCount=0};Z.prototype={init:function(a,b,c,e){e=e||{};if(!this.inited){this.factory=b;if(c)this.on("error",c);else this.events.error&&(c=u(this,function(a){this.emit("error",a)}));this.depMaps=a&&a.slice(0);this.errback=c;this.inited=!0;this.ignore=e.ignore;e.enabled||this.enabled?this.enable():this.check()}},defineDep:function(a,b){this.depMatched[a]||(this.depMatched[a]=
        !0,this.depCount-=1,this.depExports[a]=b)},fetch:function(){if(!this.fetched){this.fetched=!0;i.startTime=(new Date).getTime();var a=this.map;if(this.shim)i.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],u(this,function(){return a.prefix?this.callPlugin():this.load()}));else return a.prefix?this.callPlugin():this.load()}},load:function(){var a=this.map.url;U[a]||(U[a]=!0,i.load(this.map.id,a))},check:function(){if(this.enabled&&!this.enabling){var a,b,c=this.map.id;b=this.depExports;
        var e=this.exports,n=this.factory;if(this.inited)if(this.error)this.emit("error",this.error);else{if(!this.defining){this.defining=!0;if(1>this.depCount&&!this.defined){if(I(n)){if(this.events.error)try{e=i.execCb(c,n,b,e)}catch(d){a=d}else e=i.execCb(c,n,b,e);this.map.isDefine&&((b=this.module)&&void 0!==b.exports&&b.exports!==this.exports?e=b.exports:void 0===e&&this.usingExports&&(e=this.exports));if(a)return a.requireMap=this.map,a.requireModules=[this.map.id],a.requireType="define",v(this.error=
            a)}else e=n;this.exports=e;if(this.map.isDefine&&!this.ignore&&(q[c]=e,l.onResourceLoad))l.onResourceLoad(i,this.map,this.depMaps);x(c);this.defined=!0}this.defining=!1;this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else this.fetch()}},callPlugin:function(){var a=this.map,b=a.id,d=j(a.prefix);this.depMaps.push(d);t(d,"defined",u(this,function(e){var n,d;d=this.map.name;var g=this.map.parentMap?this.map.parentMap.name:null,h=
        i.makeRequire(a.parentMap,{enableBuildCallback:!0});if(this.map.unnormalized){if(e.normalize&&(d=e.normalize(d,function(a){return c(a,g,!0)})||""),e=j(a.prefix+"!"+d,this.map.parentMap),t(e,"defined",u(this,function(a){this.init([],function(){return a},null,{enabled:!0,ignore:!0})})),d=m(p,e.id)){this.depMaps.push(e);if(this.events.error)d.on("error",u(this,function(a){this.emit("error",a)}));d.enable()}}else n=u(this,function(a){this.init([],function(){return a},null,{enabled:!0})}),n.error=u(this,
        function(a){this.inited=!0;this.error=a;a.requireModules=[b];G(p,function(a){0===a.map.id.indexOf(b+"_unnormalized")&&x(a.map.id)});v(a)}),n.fromText=u(this,function(e,c){var d=a.name,g=j(d),C=O;c&&(e=c);C&&(O=!1);r(g);s(k.config,b)&&(k.config[d]=k.config[b]);try{l.exec(e)}catch(ca){return v(B("fromtexteval","fromText eval for "+b+" failed: "+ca,ca,[b]))}C&&(O=!0);this.depMaps.push(g);i.completeLoad(d);h([d],n)}),e.load(a.name,h,n,k)}));i.enable(d,this);this.pluginMaps[d.id]=d},enable:function(){V[this.map.id]=
        this;this.enabling=this.enabled=!0;y(this.depMaps,u(this,function(a,b){var c,e;if("string"===typeof a){a=j(a,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap);this.depMaps[b]=a;if(c=m(N,a.id)){this.depExports[b]=c(this);return}this.depCount+=1;t(a,"defined",u(this,function(a){this.defineDep(b,a);this.check()}));this.errback&&t(a,"error",this.errback)}c=a.id;e=p[c];!s(N,c)&&(e&&!e.enabled)&&i.enable(a,this)}));G(this.pluginMaps,u(this,function(a){var b=m(p,a.id);b&&!b.enabled&&i.enable(a,
        this)}));this.enabling=!1;this.check()},on:function(a,b){var c=this.events[a];c||(c=this.events[a]=[]);c.push(b)},emit:function(a,b){y(this.events[a],function(a){a(b)});"error"===a&&delete this.events[a]}};i={config:k,contextName:b,registry:p,defined:q,urlFetched:U,defQueue:H,Module:Z,makeModuleMap:j,nextTick:l.nextTick,onError:v,configure:function(a){a.baseUrl&&"/"!==a.baseUrl.charAt(a.baseUrl.length-1)&&(a.baseUrl+="/");var b=k.pkgs,c=k.shim,e={paths:!0,config:!0,map:!0};G(a,function(a,b){e[b]?
        "map"===b?(k.map||(k.map={}),R(k[b],a,!0,!0)):R(k[b],a,!0):k[b]=a});a.shim&&(G(a.shim,function(a,b){J(a)&&(a={deps:a});if((a.exports||a.init)&&!a.exportsFn)a.exportsFn=i.makeShimExports(a);c[b]=a}),k.shim=c);a.packages&&(y(a.packages,function(a){a="string"===typeof a?{name:a}:a;b[a.name]={name:a.name,location:a.location||a.name,main:(a.main||"main").replace(ja,"").replace(ea,"")}}),k.pkgs=b);G(p,function(a,b){!a.inited&&!a.map.unnormalized&&(a.map=j(b))});if(a.deps||a.callback)i.require(a.deps||[],
        a.callback)},makeShimExports:function(a){return function(){var b;a.init&&(b=a.init.apply(aa,arguments));return b||a.exports&&ba(a.exports)}},makeRequire:function(a,f){function d(e,c,h){var g,k;f.enableBuildCallback&&(c&&I(c))&&(c.__requireJsBuild=!0);if("string"===typeof e){if(I(c))return v(B("requireargs","Invalid require call"),h);if(a&&s(N,e))return N[e](p[a.id]);if(l.get)return l.get(i,e,a,d);g=j(e,a,!1,!0);g=g.id;return!s(q,g)?v(B("notloaded",'Module name "'+g+'" has not been loaded yet for context: '+
        b+(a?"":". Use require([])"))):q[g]}L();i.nextTick(function(){L();k=r(j(null,a));k.skipMap=f.skipMap;k.init(e,c,h,{enabled:!0});D()});return d}f=f||{};R(d,{isBrowser:A,toUrl:function(b){var d,f=b.lastIndexOf("."),g=b.split("/")[0];if(-1!==f&&(!("."===g||".."===g)||1<f))d=b.substring(f,b.length),b=b.substring(0,f);return i.nameToUrl(c(b,a&&a.id,!0),d,!0)},defined:function(b){return s(q,j(b,a,!1,!0).id)},specified:function(b){b=j(b,a,!1,!0).id;return s(q,b)||s(p,b)}});a||(d.undef=function(b){w();var c=
        j(b,a,!0),d=m(p,b);delete q[b];delete U[c.url];delete $[b];d&&(d.events.defined&&($[b]=d.events),x(b))});return d},enable:function(a){m(p,a.id)&&r(a).enable()},completeLoad:function(a){var b,c,e=m(k.shim,a)||{},d=e.exports;for(w();H.length;){c=H.shift();if(null===c[0]){c[0]=a;if(b)break;b=!0}else c[0]===a&&(b=!0);E(c)}c=m(p,a);if(!b&&!s(q,a)&&c&&!c.inited){if(k.enforceDefine&&(!d||!ba(d)))return z(a)?void 0:v(B("nodefine","No define call for "+a,null,[a]));E([a,e.deps||[],e.exportsFn])}D()},nameToUrl:function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           b,c){var e,d,h,g,j,i;if(l.jsExtRegExp.test(a))g=a+(b||"");else{e=k.paths;d=k.pkgs;g=a.split("/");for(j=g.length;0<j;j-=1)if(i=g.slice(0,j).join("/"),h=m(d,i),i=m(e,i)){J(i)&&(i=i[0]);g.splice(0,j,i);break}else if(h){a=a===h.name?h.location+"/"+h.main:h.location;g.splice(0,j,a);break}g=g.join("/");g+=b||(/\?/.test(g)||c?"":".js");g=("/"===g.charAt(0)||g.match(/^[\w\+\.\-]+:/)?"":k.baseUrl)+g}return k.urlArgs?g+((-1===g.indexOf("?")?"?":"&")+k.urlArgs):g},load:function(a,b){l.load(i,a,b)},execCb:function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       b,c,d){return b.apply(d,c)},onScriptLoad:function(a){if("load"===a.type||ka.test((a.currentTarget||a.srcElement).readyState))P=null,a=K(a),i.completeLoad(a.id)},onScriptError:function(a){var b=K(a);if(!z(b.id))return v(B("scripterror","Script error",a,[b.id]))}};i.require=i.makeRequire();return i}var l,w,x,D,t,E,P,K,Q,fa,la=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/mg,ma=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,ea=/\.js$/,ja=/^\.\//;w=Object.prototype;var L=w.toString,ga=w.hasOwnProperty,ia=
    Array.prototype.splice,A=!!("undefined"!==typeof window&&navigator&&document),da=!A&&"undefined"!==typeof importScripts,ka=A&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,Y="undefined"!==typeof opera&&"[object Opera]"===opera.toString(),F={},r={},T=[],O=!1;if("undefined"===typeof define){if("undefined"!==typeof requirejs){if(I(requirejs))return;r=requirejs;requirejs=void 0}"undefined"!==typeof require&&!I(require)&&(r=require,require=void 0);l=requirejs=function(b,c,d,z){var h,
    j="_";!J(b)&&"string"!==typeof b&&(h=b,J(c)?(b=c,c=d,d=z):b=[]);h&&h.context&&(j=h.context);(z=m(F,j))||(z=F[j]=l.s.newContext(j));h&&z.configure(h);return z.require(b,c,d)};l.config=function(b){return l(b)};l.nextTick="undefined"!==typeof setTimeout?function(b){setTimeout(b,4)}:function(b){b()};require||(require=l);l.version="2.1.5";l.jsExtRegExp=/^\/|:|\?|\.js$/;l.isBrowser=A;w=l.s={contexts:F,newContext:ha};l({});y(["toUrl","undef","defined","specified"],function(b){l[b]=function(){var c=F._;return c.require[b].apply(c,
    arguments)}});if(A&&(x=w.head=document.getElementsByTagName("head")[0],D=document.getElementsByTagName("base")[0]))x=w.head=D.parentNode;l.onError=function(b){throw b;};l.load=function(b,c,d){var l=b&&b.config||{},h;if(A)return h=l.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script"),h.type=l.scriptType||"text/javascript",h.charset="utf-8",h.async=!0,h.setAttribute("data-requirecontext",b.contextName),h.setAttribute("data-requiremodule",c),
    h.attachEvent&&!(h.attachEvent.toString&&0>h.attachEvent.toString().indexOf("[native code"))&&!Y?(O=!0,h.attachEvent("onreadystatechange",b.onScriptLoad)):(h.addEventListener("load",b.onScriptLoad,!1),h.addEventListener("error",b.onScriptError,!1)),h.src=d,K=h,D?x.insertBefore(h,D):x.appendChild(h),K=null,h;if(da)try{importScripts(d),b.completeLoad(c)}catch(j){b.onError(B("importscripts","importScripts failed for "+c+" at "+d,j,[c]))}};A&&M(document.getElementsByTagName("script"),function(b){x||(x=
    b.parentNode);if(t=b.getAttribute("data-main"))return r.baseUrl||(E=t.split("/"),Q=E.pop(),fa=E.length?E.join("/")+"/":"./",r.baseUrl=fa,t=Q),t=t.replace(ea,""),r.deps=r.deps?r.deps.concat(t):[t],!0});define=function(b,c,d){var l,h;"string"!==typeof b&&(d=c,c=b,b=null);J(c)||(d=c,c=[]);!c.length&&I(d)&&d.length&&(d.toString().replace(la,"").replace(ma,function(b,d){c.push(d)}),c=(1===d.length?["require"]:["require","exports","module"]).concat(c));if(O){if(!(l=K))P&&"interactive"===P.readyState||M(document.getElementsByTagName("script"),
    function(b){if("interactive"===b.readyState)return P=b}),l=P;l&&(b||(b=l.getAttribute("data-requiremodule")),h=F[l.getAttribute("data-requirecontext")])}(h?h.defQueue:T).push([b,c,d])};define.amd={jQuery:!0};l.exec=function(b){return eval(b)};l(r)}})(this);

    return {requirejs:requirejs,require:require,define:define};
})();

function checkGlError(e){return}(function(){var e=[];e.register=function(e){e.id=this.push(e)-1},e.has=function(e){return this.indexOf(e)!==-1},e.getById=function(e){return this[e]};var t=function(){this.id=-1,this.parent=null,this.isExternal=!1,Object.defineProperties(this,{root:{get:function(){return this.isExternal?this:this.parent.root}}}),e.register(this)};t.prototype={},t.prototype.getPrototypeObject=function(){return{}};var n=function(e){t.call(this),this.isExternal=!0,this.externalClassConstructor=e};n.prototype=Object.create(t.prototype),n.prototype.getProto=function(){var e=Object.create(this.externalClassConstructor.prototype,{constructor:{value:this.externalClassConstructor}});return e};var r=function(){t.call(this),this.isExternal=!1,this._implementation=null};r.prototype=new t,r.prototype.getProto=function(){return this._proto},r.prototype.inherit=function(t){t.id&&e.getById(t.id)?this.parent=e.getById(t.id):this.parent=new n(t),this._inheritList=[];var r=this;while(r)this._inheritList.unshift(r),r=r.parent},r.prototype.implement=function(e){this._implementation=e;var t=this.parent.getProto(),n={};try{this._implementation(n,t)}catch(r){throw r}var i={},s={};for(var o in n){var u=n[o];typeof u=="function"?i[o]=u:u&&u.get&&typeof u.get=="function"?(u.configurable="configurable"in u?u.configurable:!0,u.enumerable="enumerable"in u?u.enumerable:!0,Object.defineProperty(i,o,u)):s[o]=u}var a=this.parent&&this.parent.setupProperties?this.parent.setupProperties:function(){};this.setupProperties=function(){a.call(this);for(var e in s){var t=s[e];this[e]=t}},i.__proto__=t,this._proto=i,this.constructor=i.constructor},r.prototype.fix=function(){function r(e){if("id"in e!=1)throw new Error("ERROR: "+this+".isInstanceOf( "+e+" );");return n.indexOf(e.id)!==-1}function i(){var t=arguments;e.setupProperties.call(this),e.constructor.apply(this,t)}var e=this,t=this._inheritList,n=[];return t.forEach(function(e){n.push(e.id)}),i.prototype=e.getProto(),i.prototype.isInstanceOf=r,i.id=e.id,i};var i=function(){var e=null,t=null;arguments.length>1?(e=arguments[0]||{},t=arguments[1]):(e=Object,t=arguments[0]);var n=new r;return this._id=n.id,n.inherit(e),n.implement(t),n.fix()};typeof herlock.define=="function"&&herlock.define.amd&&herlock.define("lib/Class",[],function(){return i})})(),function(){return;var e,t,n}(),herlock.define("module/NJModule",["lib/Class"],function(e){var t=e(Object,function(e,t){e.constructor=function(){this._njs=null},e.getName=function(){return"Abstract"},e.onRegisterTo=function(e){this._njs=e},e.installTo=function(e){},e.initJs=function(e){},e.start=function(){},e.reset=function(){},e.pause=function(){},e.resume=function(){},e.destroy=function(){}});return t}),herlock.define("module/common/event/Event",["lib/Class"],function(e){var t=function(e,n,r){this._type=e||"event",this._bubbles=arguments.length>1?n:!1,this._cancelable=arguments.length>2?r:!1,this._defaultPrevented=!1,this._eventPhase=t.NONE,this._currentTarget=null,this._target=null,this._timeStamp=Date.now(),this._propagationStopped=!1,this._immediatePropagationStopped=!1};return t.prototype=Object.create({},{bubbles:{get:function(){return this._bubbles}},cancelable:{get:function(){return this._cancelable}},currentTarget:{get:function(){return this._currentTarget}},defaultPrevented:{get:function(){return this._defaultPrevented}},eventPhase:{get:function(){return this._eventPhase}},target:{get:function(){return this._target}},timeStamp:{get:function(){return this._timeStamp}},type:{get:function(){return this._type}},preventDefault:{value:function(){this._defaultPrevented=!0},writable:!0},stopImmediatePropagation:{value:function(){this._propagationStopped=!0,this._immediatePropagationStopped=!0},writable:!0},stopPropagation:{value:function(){this._propagationStopped=!0},writable:!0},_setEventPhase:{value:function(e){this._eventPhase=e},writable:!0},_setCurrentTarget:{value:function(e){this._currentTarget=e},writable:!0},_setTarget:{value:function(e){this._target=e},writable:!0},_getDefaultPrevented:{value:function(){return this._defaultPrevented},writable:!0},_isPropagationStopped:{value:function(){return this._propagationStopped},writable:!0},_isImmediatePropagationStopped:{value:function(){return this._immediatePropagationStopped},writable:!0},_onPropagate:{value:function(e,t){},writable:!0}}),t.NONE=1,t.CAPTURING_PHASE=1,t.AT_TARGET=2,t.BUBBLING_PHASE=3,t}),herlock.define("module/common/event/EventDispatcher",["lib/Class","./Event"],function(e,t){var n=e(Object,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments),this._dictionary={}},e.addEventListener=function(e,t,n){n=!!n,this._dictionary[e]||(this._dictionary[e]=[]),this._dictionary[e].push({func:t,useCapture:n})},e.removeEventListener=function(e,t,n){n=!!n;if(!this._dictionary[e])return;var r=this._dictionary[e];for(var i=r.length-1;i>=0;i--)if(r[i].func===t&&r[i].useCapture===n){r.splice(i,1);return}},e.dispatchEvent=function(e){e._setEventPhase(Event.AT_TARGET),this._setEventTarget(e),this._setEventCurrentTarget(e),this._callListeners(e)},e.removeAllEventListeners=function(){this._dictionary={}},e._hasEventListener=function(e){var t=this._dictionary[e];return t?t.length<=0?!1:!0:!1},e._propagateEvent=function(e,t){var n=t.length;e._setTarget(this),e._setEventPhase(Event.CAPTURING_PHASE);for(var r=0;r<n-1;r++){var i=t[r];i._setEventCurrentTarget(e),e._onPropagate(t,r),i._callListeners(e,!0,i);if(e._isPropagationStopped())return}e._setEventPhase(Event.AT_TARGET);var i=t[n-1];i._setEventCurrentTarget(e),e._onPropagate(t,n-1),i._callListeners(e,!1,i);if(e._isPropagationStopped())return;if(e.bubbles!=1)return;e._setEventPhase(Event.BUBBLING_PHASE);for(var r=n-2;r>=0;r--){var i=t[r];i._setEventCurrentTarget(e),e._onPropagate(t,r),i._callListeners(e,!1,i);if(e._isPropagationStopped())return}},e._callHandler=function(e,t){this[e]&&this[e](t)},e._dispatchEventAndCallHandler=function(e){this.dispatchEvent(e),this._callHandler("on"+e.type,e)},e._callListeners=function(e,t,n){var r=arguments.length;t=r>1?t:!1,n=r>2?n:this;var i=this._dictionary[e.type];if(!i)return;for(var s=0;s<i.length;s++){var o=i[s];if(!o)continue;if(e.eventPhase!=Event.AT_TARGET&&e.bubbles&&o.useCapture!=t)continue;o.func.call(n,e);if(e._isImmediatePropagationStopped())break}},e._setEventTarget=function(e){e._setTarget(this)},e._setEventCurrentTarget=function(e){e._setCurrentTarget(this)},e._numListeners=function(e){return this._dictionary[e]?this._dictionary[e].length:0}});return n}),herlock.define("module/common/NJCommon",["lib/Class","module/NJModule","module/common/event/Event","module/common/event/EventDispatcher"],function(e,t,n,r){var i=e(t,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments)},e.installTo=function(e){e.Event=n,e.EventDispatcher=r}});return i}),herlock.define("NativeJS",["lib/Class","module/common/NJCommon"],function(Class,NJCommon){window.__herlock_ctx=null;var NativeJS=Class(Object,function(cls,parent){var State={BUILD:{},READY:{},RUNNING:{},PAUSED:{},DESTROYED:{}};cls.constructor=function(){this._currentContext=null,this._state=State.BUILD,this._modules=[],this.registerModule(new NJCommon)},cls.getState=function(){return this._state},cls.executeScript=function(e){this.evaluateScript(e,null)},cls.evaluateScript=function(script,callback){var self=this;setTimeout(function(){(self._state==State.BUILD||self._state==State.READY)&&self._start();if(self._state!=State.RUNNING)return;window.__herlock_ctx=self;var result=eval("with( window.__herlock_ctx._currentContext ){"+script+"}");callback!=null&&callback(result)},0)},cls.loadURL=function(e){console.log("loadURL with NJScript"),this._rootPath=e.substr(0,e.lastIndexOf("/")+1),this.executeScript("(function(){\n	var script = new Script();\n	script.onerror=function(){ console.log('load error '+script); application.sendMessage('type=error'); }\n	script.onabort=function(){ console.log('load abort '+script); }\n	script.onload=function(){\n		console.log('load complete '+script); \n	}\n	script.src = '"+e.substr(e.lastIndexOf("/")+1)+"';"+"})();")},cls.reload=function(){getModuleByName("Location")!=null&&(DebugUtil.log("loadURL with NJLocation"),executeScript("location.reload();"))},cls.registerModule=function(e){if(this._state!=State.BUILD)return;this._modules.push(e),e.onRegisterTo(this)},cls.getModuleByName=function(e){var t=this._modules.length;for(var n=0;n<t;n++)if(this._modules[n].getName()===e)return this._modules[n];return null},cls._build=function(){if(this._state!=State.BUILD)return;this._state=State.READY},cls.reset=function(){var e=this;setTimeout(function(){e._reset()},0)},cls._reset=function(){if(this._state==State.BUILD)return;console.log("NativeJS::reset");var e=this._modules.length;for(var t=0;t<e;t++){var n=this._modules[t];n.reset()}this._currentContext=null,this._state=State.READY},cls.start=function(){var e=this;setTimeout(function(){e._start()},0)},cls._start=function(){if(this._state==State.RUNNING)return;if(this._state==State.PAUSED)return;console.log("NativeJS::start"),this._state==State.BUILD&&this._build(),console.log("NativeJS::build"),this._currentContext=new NativeJS.JSContext(0),console.log("NativeJS::CreateJSContext");var e=this._modules.length;for(var t=0;t<e;t++){var n=this._modules[t];n.installTo(window)}console.log("NativeJS::install modules"),console.log("NativeJS::BuildJSContext");for(var t=0;t<e;t++){var n=this._modules[t];n.initJs(window)}console.log("NativeJS::initJs modules");for(var t=0;t<e;t++){var n=this._modules[t];n.start()}console.log("NativeJS::start modules"),this._state=State.RUNNING},cls.pause=function(){var e=this;setTimeout(function(){e._pause()},0)},cls._pause=function(){if(this._state!=State.RUNNING)return;var e=this._modules.length;for(var t=0;t<e;t++){var n=this._modules[t];n.pause()}this._state=State.PAUSED},cls.resume=function(){var e=this;setTimeout(function(){this._resume()},0)},cls._resume=function(){if(this._state!=State.PAUSED)return;var e=this._modules.length;for(var t=0;t<e;t++){var n=this._modules[t];n.resume()}this._state=State.RUNNING},cls.destroy=function(){var e=this;setTimeout(function(){e._destroy()},0)},cls._destroy=function(){if(this._state==State.DESTROYED)return;var e=this._modules.length;for(var t=0;t<e;t++){var n=this._modules[t];n.destroy()}this._state=State.DESTROYED},cls._rootPath=""});return NativeJS.JSContext=Class(function(e){e.constructor=function(e){this._nativePtr=e},e.getNativePtr=function(){return this._nativePtr}}),NativeJS}),herlock.define("lib/URL",[],function(){var e=function(e){this._protocol=null,this._hostname=null,this._port=null,this._pathname=null,this._search=null,this._hash=null;var t;t=e.indexOf("#"),t!==-1&&(this._hash=e.substr(t+1),e=e.substr(0,t)),t=e.indexOf("?"),t!==-1&&(this._search=e.substr(t+1),e=e.substr(0,t)),t=e.indexOf("://");if(t===-1){this._pathname=e;return}this._protocol=e.substr(0,t),e=e.substr(t+3),t=e.indexOf("/");if(t===-1){this._hostname=e;return}var n=e.substr(0,t);this._pathname=e.substr(t),t=n.indexOf(":"),t!==-1&&(this._port=n.substr(t+1),n=n.substr(0,t)),this._hostname=n};return e.prototype=Object.create({},{hash:{get:function(){return this._hash?"#"+this._hash:""},set:function(e){e.indexOf("#")!==-1&&(e=e.split("#")[1]),this._hash=e}},host:{get:function(){return this._hostname?this._hostname+(this._port?":"+this._port:""):""},set:function(e){if(e.indexOf(":")!==-1){var t=e.split(":")[0];e=t[0],this._port=t[1]}this._hostname=e}},hostname:{get:function(){return this._hostname?this._hostname:""},set:function(e){this._hostname=e}},pathname:{get:function(){return this._pathname?this._pathname:""},set:function(e){this._pathname=e}},port:{get:function(){return this._port?this._port:""},set:function(e){this._port=e}},protocol:{get:function(){return this._protocol?this._protocol+":":""},set:function(e){this._protocol=e.split(":")[0]}},search:{get:function(){return this._search?this._search:""},set:function(e){this._search=e}},clone:{value:function(){return new e(this.toString())}},toString:{value:function(){var e="";return this._protocol&&(e+=this._protocol+"://"),this._hostname&&(e+=this._hostname),this._port&&(e+=":"+this._port),this._pathname&&(e+=this._pathname),this._search&&(e+="?"+this._search),this._hash&&(e+="#"+this._hash),e}}}),e}),herlock.define("module/script/object/ScriptObject",["lib/Class","module/common/event/EventDispatcher","lib/URL"],function(e,t,n){var r=e(t,function(e,t){e.constructor=function(e){t.constructor.apply(this,arguments),this._src="",e&&(this.src=e)},e.src={get:function(){return this._src},set:function(e){this._src=e;var t=new n(e);this._script&&document.head.removeChild(this._script),this._script=document.createElement("script"),document.head.appendChild(this._script);var r=window.__herlock_ctx,i=this;this._script.onload=function(){i.onload()},this._script.src=t.host===""?r._rootPath+t:t.toString()}}});return r}),herlock.define("module/script/NJScript",["lib/Class","module/NJModule","module/script/object/ScriptObject"],function(e,t,n){var r=e(t,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments)},e.getName=function(){return"Script"},e.installTo=function(e){},e.initJs=function(e){e.Script=n},e.start=function(){t.start.call(this)},e.reset=function(){}});return r}),herlock.define("module/app/NJApp",["lib/Class","module/NJModule","module/common/event/EventDispatcher"],function(e,t,n){var r=e(t,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments),this._messageReciever=null,this._statusBarEnabled=!0,this._sleepModeEnabled=!0},e.installTo=function(e){e.App=i},e.initJs=function(e){e.app=new i(this)},e.reset=function(){},e.pause=function(){},e.resume=function(){},e.notifyEnterForeground=function(){},e.notifyEnterBackground=function(){},e.finish_native=function(){},e.setMessageReciever=function(e){this._messageReciever=e},e.sendMessage=function(e){},e.sendMessage=function(e,t){},e.recieveMessage_native=function(e,t){},e.openURL_native=function(e){},e.notifyHandleOpenURL=function(e){},e.getLanguage_native=function(){},e.getStatusBarEnabled_native=function(){return this._statusBarEnabled},e.setStatusBarEnabled_native=function(e){if(this._statusBarEnabled==e)return;this._statusBarEnabled=e},e.getSleepModeEnabled_native=function(){return this._sleepModeEnabled},e.setSleepModeEnabled_native=function(e){if(this._sleepModeEnabled==e)return;this._sleepModeEnabled=e},e.getActiveNetworkName_native=function(){return null},e.getActiveNetwork_native=function(){return-1},e.getActiveNetworkIP_native=function(){},e.notifyHardwareButtonAction=function(e,t){},e.getMemoryInfo_native=function(){return[0,0,0]},e.getMemoryInfo_native_bk=function(){return[0,0,0]};var n=0;e.getTotalMemorySize=function(){return 0},e.setClipboardText_native=function(e){},e.getVersion_native=function(){},e.getBuildVersion_native=function(){},e.setScreenOrientation=function(e){console.log("deprecated. app.setScreenOrientation => window.setOrientationType"),window.setOrientationType&&window.setOrientationType(e)}}),i=e(n,function(e,t){e.constructor=function(e){t.constructor.apply(this,arguments),this._module=e},e.statusBarEnabled={get:function(){return this._module.getStatusBarEnabled_native()},set:function(e){this._module.setStatusBarEnabled_native(e)}},e.sleepModeEnabled={get:function(){return!0},set:function(){}},e.activeNetwork={get:function(){return null}},e.activeNetworkIP={get:function(){return null}},e.language={get:function(){return navigator.language}},e.isIOS={get:function(){return!1}},e.isANDROID={get:function(){return!1}},e.isWeb={get:function(){return!0}},e.version={get:function(){return 1}},e.buildVersion={get:function(){return 1}},e.memory=function(){},e.nativeLog=function(){},e.sendMessage=function(){},e.gc=function(){},e.openURL=function(e){var t=document.createElement("a");t.href=e,t.target="_blank",document.head.appendChild(t),t.click()},e.setClipboardText=function(){console.warn("not supported.")},e.getLatestSchemeURLOnce=function(){},e.getLatestNotificationDataOnce=function(){},e.setScreenOrientation=function(e){this._module.setScreenOrientation(e)}});return r}),herlock.define("module/location/NJLocation",["lib/Class","lib/URL","module/NJModule","module/common/event/EventDispatcher"],function(e,t,n,r){var i=e(n,function(e,n){e.constructor=function(){n.constructor.apply(this,arguments)},e.getName=function(){return"Location"},e.installTo=function(e){e.Location=s},e.initJs=function(e){var t=new s(this);e.location._assign=function(){t._assign()}},e.reset=function(){},e.assign_native=function(e){console.log("NJLocation::assign_native");var n=this;setTimeout(function(){console.log("NJLocation::Starter::run");var r=n._njs;r.reset(),r.start(),setTimeout(function(){var n=new t(e),i="";n.host!==""?i=n.protocol+"//"+n.host+n.pathname:i=location.protocol+"//"+location.host+location.pathname+n.pathname,r._rootPath=i.substr(0,i.lastIndexOf("/")+1),r.executeScript('(function(){\n	var bootstrap = new Script();\n	bootstrap.onerror = function(e){   app.nativeLog(""+e); app.sendMessage(""+e);   setTimeout( function(){ location._assign(); }, 2000 );}\n	bootstrap.onabort = function(){}\n	bootstrap.onload = function(){}\n	bootstrap.src = \''+i.substr(i.lastIndexOf("/"))+"';"+"})();")},0)},0)}}),s=e(r,function(e,n){e.constructor=function(e){n.constructor.call(this),this._module=e,this._url=new t("")},e._assign=function(e){this._module.assign_native(e)},e.assign=function(e){this._module.assign_native(e)},e.reload=function(){this.assign(this._url.toString())},e.replace=function(){},e.hash={get:function(){return this._url.hash},set:function(e){this._url.hash=e}},e.host={get:function(){return this._url.host},set:function(e){this._url.host=e,this.reload()}},e.hostname={get:function(){return this._url.hostname},set:function(e){this._url.hostname=e,this.reload()}},e.href={get:function(){return this._url.toString()},set:function(e){this._url=new t(e),this.reload()}},e.pathname={get:function(){return this._url.pathname},set:function(e){this._url.pathname=e,this.reload()}},e.port={get:function(){return this._url.port},set:function(e){this._url.port=e,this.reload()}},e.protocol={get:function(){return this._url.protocol},set:function(e){this._url.protocol=e,this.reload()}},e.search={get:function(){return this._url.search},set:function(e){this._url.search=e,this.reload()}}});return i}),herlock.define("module/view/window/window",[],function(){var e={installTo:function(e,t){e.addLayer=function(e){return t.addLayer(e)},e.addLayerAt=function(e,n){return t.addLayer(e,n)},e.getLayerAt=function(e){return t.getLayerAt(e)},e.getLayerIndex=function(e){return t.getLayerIndex(e)},e.removeLayer=function(e){return t.removeLayer(e)},e.removeLayerAt=function(e){return t.removeLayerAt(e)},e.innerWidth=t.getViewWidth();try{Object.defineProperties(e,{innerWidth:{get:function(){return t.getViewWidth()}},innerHeight:{get:function(){return t.getViewHeight()}}})}catch(n){console.log("SafariはinnerWidth,innerHeightが更新できません。"),e.innerWidth=t.getViewWidth(),e.innerHeight=t.getViewHeight()}e.setOrientationType=function(){}},initJs:function(e){}};return e}),herlock.define("module/view/gl/IRenderable",["lib/Class"],function(e){var t=e(Object,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments)},e.processData=function(){},e.renderOffscreen=function(){},e.render=function(){}});return t}),herlock.define("module/view/gl/Viewport",["lib/Class"],function(e){var t=e(Object,function(e,n){e.constructor=function(e,r,i,s,o){n.constructor.apply(this,arguments),this._x=e,this._y=r,this._w=i,this._h=s,o&&(t._current=this)},e.enable=function(){if(t._current==null||t._current.equals(this._x,this._y,this._w,this._h)!=1)gl.viewport(this._x,this._y,this._w,this._h),checkGlError("glViewport");t._current=this},e.equals=function(e,t,n,r){return this._x==e&&this._y==t&&this._w==n&&this._h==r}}),n=new function(){var e=[];this.push=function(t){e.push(t),t.enable()},this.pop=function(){e.pop(),e.length>0&&e[e.length-1].enable()}};t._current=null;var r={unbind:function(){n.pop()}};return t.BindScope=function(e){return n.push(e),r},t.getX=function(){return this._current==null?0:this._current._x},t.getY=function(){return this._current==null?0:this._current._y},t.getWidth=function(){return this._current==null?0:this._current._w},t.getHeight=function(){return this._current==null?0:this._current._h},t}),herlock.define("module/view/touch/TouchEventInfo",["lib/Class"],function(e){var t=e(Object,function(e,n){e.constructor=function(e){n.constructor.apply(this,arguments),this._action=e,this._pointers={}},e.getAction=function(){return this._action},e.addTouchPoint=function(e,n,r,i,s){this._pointers[e]=t.Pointer.create(e,n,r,i,s)},e.getChangedPointers=function(){var e=[];for(var t in this._pointers)this._pointers[t].isChanged&&e.push(this._pointers[t]);return e},e.getPointersOnScreen=function(){var e=[];for(var t in this._pointers)this._pointers[t].isOnScreen&&e.push(this._pointers[t]);return e}});return t.Pointer={create:function(e,t,n,r,i){return{id:e,x:t,y:n,isChanged:r,isOnScreen:i}}},t.NONE=0,t.DOWN=1,t.MOVE=2,t.UP=3,t.CANCEL=4,t}),herlock.define("module/view/layer/Layer",["lib/Class","module/view/gl/IRenderable","module/view/gl/Viewport","module/view/touch/TouchEventInfo"],function(e,t,n,r){var i=e(Object,function(e,t){e.constructor=function(e){t.constructor.apply(this,arguments),this._content=null,this._renderingObject=new s,this._calcRequested=!0,this._horizontalAlign=i.Align.CENTER,this._verticalAlign=i.Align.MIDDLE,this._scaleMode=i.ScaleMode.SHOW_ALL,this._colorTransform=new ColorTransform,this._backgroundColor=16777215,this._backgroundAlpha=0,this._offsetPercentX=0,this._offsetPercentY=0,this._module=null,this._matrix=new Matrix,this._contentMatrix=new Matrix,this._contentDisplayRect=new Rectangle,e&&(this.content=e)},e.content={get:function(){return this._content},set:function(e){this._content!=null&&this._content._onRemovedFrom(this),this._calcRequested=!0,this._content=e,e!=null&&this._content._onAddedTo(this)}},e.contentScaleX={get:function(){return this._getContentMatrix()._getScaleX()}},e.contentScaleY={get:function(){return this._getContentMatrix()._getScaleY()}},e.horizontalAlign={get:function(){return this._horizontalAlign},set:function(e){this._horizontalAlign=e,this._calcRequested=!0}},e.verticalAlign={get:function(){return this._verticalAlign},set:function(e){this._verticalAlign=e,this._calcRequested=!0}},e.scaleMode={get:function(){return this._scaleMode},set:function(e){this._scaleMode=e,this._calcRequested=!0}},e.offsetX={get:function(){return this._offsetPercentX},set:function(e){this._offsetPercentX=e,this._calcRequested=!0}},e.offsetY={get:function(){return this._offsetPercentY},set:function(e){this._offsetPercentY=e,this._calcRequested=!0}},e.alpha={get:function(){return this._colorTransform.getAlphaMultiplier()},set:function(e){this._colorTransform.getAlphaMultiplier(e)}},e.backgroundColor={get:function(){return this._backgroundColor},set:function(e){this._backgroundColor=e}},e.backgroundAlpha={get:function(){return this._backgroundAlpha},set:function(e){this._backgroundAlpha=e}},e._notifyDrawFrame=function(){this._content&&this._content._notifyDrawFrame()},e._addedTo=function(e){this._module=e,calcRequested=!0},e._removedFrom=function(e){this._module=null},e._notifyResizeView=function(e,t){this._content!=null&&this._content._notifyResizeView(e,t),this._calcRequested=!0},e._notifyResizeContent=function(){this._calcRequested=!0},e._notifyTouch=function(e){if(!this._content)return;this._content._dispatchTouchEvent(e)},e._calculate=function(){if(this._module==null)return;if(this._content==null)return;this._calcRequested=!1;var e=this._module.getViewWidth(),t=this._module.getViewHeight(),n=e/t,r=this._content._getContentWidth(),s=this._content._getContentHeight(),o=r/s;if(this._scaleMode==i.ScaleMode.EXACT_FIT)this._contentMatrix._setScaleX(e/r),this._contentMatrix._setScaleY(t/s);else if(this._scaleMode==i.ScaleMode.SHOW_ALL){var u;n<o?u=e/r:u=t/s,this._contentMatrix._setScaleX(u),this._contentMatrix._setScaleY(u)}else if(this._scaleMode==i.ScaleMode.NO_BORDER){var u;n>o?u=e/r:u=t/s,this._contentMatrix._setScaleX(u),this._contentMatrix._setScaleY(u)}else this._scaleMode==i.ScaleMode.NO_SCALE&&(this._contentMatrix._setScaleX(1),this._contentMatrix._setScaleY(1));this._matrix._setX(e*this._offsetPercentX),this._matrix._setY(t*this._offsetPercentY),this._contentDisplayRect.width=this._content._getContentWidth()*this._contentMatrix._getScaleX(),this._contentDisplayRect.height=this._content._getContentHeight()*this._contentMatrix._getScaleY(),this._contentDisplayRect.x=this._matrix._getX(),this._contentDisplayRect.y=this._matrix._getY();var a=0,f=0;this._horizontalAlign==i.Align.LEFT?a+=0:this._horizontalAlign==i.Align.CENTER?a+=.5*(e-this._contentDisplayRect.width):this._horizontalAlign==i.Align.RIGHT&&(a+=1*(e-this._contentDisplayRect.width)),this._verticalAlign==i.Align.TOP?f+=0:this._verticalAlign==i.Align.MIDDLE?f+=.5*(t-this._contentDisplayRect.height):this._verticalAlign==i.Align.BOTTOM&&(f+=1*(t-this._contentDisplayRect.height)),this._contentDisplayRect.x+=a,this._contentDisplayRect.y+=f,this._contentMatrix._setX(a),this._contentMatrix._setY(f)},e._getMatrix=function(){return this._calcRequested&&this._calculate(),this._matrix.clone()},e._getContentMatrix=function(){return this._calcRequested&&this._calculate(),this._contentMatrix.clone()},e._getContentDisplayRect=function(){return this._calcRequested&&this._calculate(),this._contentDisplayRect},e._glPrepare=function(){if(this._module==null)return null;if(this._content==null)return null;this._renderingObject.viewport=new n(0,0,this._module.getViewWidth(),this._module.getViewHeight());var e=n.BindScope(this._renderingObject.viewport),t=new Matrix;return this._renderingObject.contentRenderingObject=this._content._glPrepare(t,this._colorTransform),e.unbind(),this._renderingObject}});i.Align={TOP:"top",MIDDLE:"middle",BOTTOM:"bottom",LEFT:"left",CENTER:"center",RIGHT:"right",NONE:"none"},i.ScaleMode={EXACT_FIT:"exactFit",NO_BORDER:"noBorder",NO_SCALE:"noScale",SHOW_ALL:"showAll",MODE_NONE:"none"};var s=e(t,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments)},e.viewport=null,e.contentRenderingObject=null,e.processData=function(){if(!this.contentRenderingObject)return;var e=n.BindScope(this.viewport);this.contentRenderingObject.processData(),e.unbind()},e.renderOffscreen=function(){},e.render=function(){if(!this.contentRenderingObject)return;var e=n.BindScope(this.viewport);this.contentRenderingObject.render(),e.unbind()}});return i}),herlock.define("module/graphics/CanvasProxy",["lib/Class"],function(e){var t=e(Object,function(e,t){e.constructor=function(e){t.constructor.apply(this,arguments),this._bitmapProxy=e;if(this._bitmapProxy._imageElm){var n=this._bitmapProxy._imageElm;this._bitmapProxy._imageElm=null;var r=this._bitmapProxy._canvasElm=document.createElement("canvas");r.width=n.naturalWidth,r.height=n.naturalHeight,r.getContext("2d").drawImage(n,0,0)}this._ctx=this._bitmapProxy._canvasElm.getContext("2d"),this._fontSize=12,this._letterSpacing=0},e._updateFont=function(){this._ctx.font=""+this._fontSize+"px/18px sans-serif",this._metrics=null},e.fillStyle="#ffffff",e.strokeStyle="#000000",e.setFillColor=function(e){var t=[e>>>16&255,e>>>8&255,e>>>0&255,(e>>>24&255)/255];this._ctx.fillStyle="rgba("+t.join(",")+")"},e.setStrokeColor=function(e){var t=[e>>>16&255,e>>>8&255,e>>>0&255,(e>>>24&255)/255];this._ctx.strokeStyle="rgba("+t.join(",")+")"},e.fillRect=function(e,t,n,r){this._ctx.fillRect(e,t,n,r)},e.strokeRect=function(e,t,n,r){this._ctx.strokeRect(e,t,n,r)},e.getFontSize=function(){return this._fontSize},e.setFontSize=function(e){this._fontSize=e,this._updateFont()},e.getLetterSpacing=function(){return this._letterSpacing},e.setLetterSpacing=function(e){this._letterSpacing=e},e.getFontMetrics=function(){this._metrics||(this._metrics=this._ctx.getTextMetrics("Aあa　亜"));var e={};return e.ascent=this._metrics.ascent,e.descent=this._metrics.descent,e},e.fillText=function(e,t,n,r){this._ctx.textBaseline="top",r?this._ctx.fillText(n,e,t,r):this._ctx.fillText(n,e,t)},e.strokeText=function(e,t,n,r){},e.measureText=function(e){var t=this._ctx.measureText(e,e.length).width,n=e.length;return n>0&&(t+=this._letterSpacing*(n-1)),t},e.breakText=function(e,t){if(this._ctx.measureText(e).width<=t)return e.length;var n=0;while(n<e.length){var r=e.substring(0,n),i=this._ctx.measureText(r).width;if(i>t)break;n++}n--;var s=n;return s},e.clear=function(){this._ctx.clearRect(0,0,this._bitmapProxy.width(),this._bitmapProxy.height())}});return t}),function(){var e="FontMetrics Library",t="1-2011.0927.1431",n=!1;if(!document.defaultView.getComputedStyle)throw"ERROR: 'document.defaultView.getComputedStyle' not found. This library only works in browsers that can report computed CSS values.";CanvasRenderingContext2D.prototype.measureTextWidth=CanvasRenderingContext2D.prototype.measureText;var r=function(e,t){return document.defaultView.getComputedStyle(e,null).getPropertyValue(t)},i=function(e,t,n,r,i,s){document.body.appendChild(e),t.strokeStyle="rgba(0, 0, 0, 0.5)",t.beginPath(),t.moveTo(n,0),t.lineTo(n,i),t.closePath(),t.stroke(),t.beginPath(),t.moveTo(n+s.bounds.maxx,0),t.lineTo(n+s.bounds.maxx,i),t.closePath(),t.stroke(),t.beginPath(),t.moveTo(0,i/2-s.ascent),t.lineTo(r,i/2-s.ascent),t.closePath(),t.stroke(),t.beginPath(),t.moveTo(0,i/2+s.descent),t.lineTo(r,i/2+s.descent),t.closePath(),t.stroke()};CanvasRenderingContext2D.prototype.getTextMetrics=function(e){var t=this.measureTextWidth(e),s=document.createElement("canvas"),o=100;s.style.opacity=1,s.style.font=this.font;var u=s.style.fontFamily,a=s.style.fontSize.replace("px","");s.width=t.width+o,s.height=3*a,t.fontsize=a;var f=s.getContext("2d");f.font=a+"px "+u;var l=document.createElement("div");l.style.position="absolute",l.style.opacity=0,l.style.font=a+"px "+u,l.innerHTML=e+"<br/>"+e,document.body.appendChild(l);var c=s.width,h=s.height,p=h/2;f.fillStyle="white",f.fillRect(-1,-1,c+2,h+2),f.fillStyle="black",f.fillText(e,o/2,p);var d=f.getImageData(0,0,c,h).data,v=0,m=c*4,g=d.length;while(++v<g&&d[v]===255);var y=v/m|0;v=g-1;while(--v>0&&d[v]===255);var b=v/m|0;for(v=0;v<g&&d[v]===255;)v+=m,v>=g&&(v=v-g+4);var w=v%m/4|0,E=1;for(v=g-3;v>=0&&d[v]===255;)v-=m,v<0&&(v=g-3-E++*4);var S=v%m/4+1|0;t.ascent=y-p,t.descent=b-p,t.bounds={minx:w-o/2,maxx:S-o/2,miny:0,maxy:b-y},t.height=1+(b-y),t.leading=1.2*a;var x=r(l,"height");return x=x.replace("px",""),x>=a*2&&(t.leading=x/2|0),document.body.removeChild(l),n&&i(s,f,50,c,h,t),t}}(),herlock.define("module/graphics/BitmapProxy",["lib/Class","./CanvasProxy"],function(e,t){var n=e(Object,function(e,n){e.constructor=function(){n.constructor.apply(this,arguments);var e=arguments,t=arguments.length;if(t==1&&e[0]instanceof HTMLImageElement){this._imageElm=e[0];return}this._canvasElm=document.createElement("canvas"),this._canvasElm.width=t>0?e[0]:100,this._canvasElm.height=t>1?e[1]:100},e.getCanvas=function(){return this._canvas==null&&(this._canvas=new t(this)),this._canvas},e.getPixels=function(){return this._imageElm?this._imageElm:this._canvasElm},e.getData=function(){var e=this.getCanvas()._ctx,t=e.getImageData(0,0,this.width(),this.height()).data,n=new Uint8Array(this.width()*this.height()*4);for(var r=this.width()*this.height()*4-1;r>=0;r--)n[r]=t[r];return n},e.width=function(){return this._imageElm?this._imageElm.naturalWidth:this._canvasElm.width},e.height=function(){return this._imageElm?this._imageElm.naturalHeight:this._canvasElm.height},e.clone=function(){}});return n.create=function(e,t){return new n(e,t)},n}),herlock.define("module/view/image/Image",["lib/Class","module/common/event/EventDispatcher","lib/URL","module/graphics/BitmapProxy"],function(e,t,n,r){var i=e(t,function(e,t){e.constructor=function(e){t.constructor.apply(this,arguments),this._src="",this._bitmapProxy=null,e&&(this.src=e)},e.src={get:function(){this._src},set:function(e){this._src=e;var t=new n(e);this._image=null;var i=document.createElement("img"),s=window.__herlock_ctx,o=this;i.onload=function(){o._image=i,o._bitmapProxy=new r(o._image),o._dispatchEventAndCallHandler(new Event("load"))},i.src=t.host===""?s._rootPath+t:t.toString()}},e.complete={get:function(){}},e.width={get:function(){return this._image?this._image.width:0}},e.height={get:function(){return this._image?this._image.height:0}},e.naturalWidth={get:function(){return this._image?this._image.width:0}},e.naturalHeight={get:function(){return this._image?this._image.height:0}},e.onload=function(){},e.onerror=function(){},e._getBitmap=function(){return this._bitmapProxy}});return i}),herlock.define("module/view/flash/display/BlendMode",[],function(){var e={NORMAL:"normal",ADD:"add"};return e}),herlock.define("module/view/geom/Point",["lib/Class"],function(e){var t=function(e,t){this.x=0,this.y=0,arguments.length>=1&&(this.x=e),arguments.length>=2&&(this.y=t)};return t.prototype=Object.create({},{add:{value:function(e){return new t(this.x+e.x,this.y+e.y)},writable:!0},subtract:{value:function(e){return new t(this.x-e.x,this.y-e.y)},writable:!0},clone:{value:function(){return new t(this.x,this.y)},writable:!0},equals:{value:function(e){return this.x===e.x&&this.y===e.y},writable:!0},normalize:{value:function(e){var t=Math.sqrt(this.x*this.x+this.y*this.y);this.x=this.x/t*e,this.y=this.y/t*e},writable:!0},offset:{value:function(e){this.x+=e.x,this.y+=e.y},writable:!0},toString:{value:function(){return'[object Point x="'+this.x+'" y="'+this.y+'"]'},writable:!0}}),t}),herlock.define("module/view/geom/Rectangle",["lib/Class","./Point"],function(e,t){var n=function(e,t,n,r){this.x=0,this.y=0,this.width=0,this.height=0;var i=arguments.length;i>0&&(this.x=arguments[0]),i>1&&(this.y=arguments[1]),i>2&&(this.width=arguments[2]),i>3&&(this.height=arguments[3])};return n.prototype=Object.create({},{top:{get:function(){return this.y},set:function(e){this.height+=this.y-e,this.y=e}},right:{get:function(){return this.x+this.width},set:function(e){this.width+=e-this.right}},bottom:{get:function(){return this.y+this.height},set:function(e){this.height+=e-this.bottom}},left:{get:function(){return this.x},set:function(e){this.width+=this.x-e,this.x=e}},topLeft:{get:function(){return new t(this.left,this.top)},set:function(e){this.left=e.x,this.top=e.y}},bottomRight:{get:function(){return new t(this.right,this.bottom)},set:function(e){this.right=e.x,this.bottom=e.y}},size:{get:function(){return new t(this.width,this.height)},set:function(e){this.width=e.x,this.height=e.y}},clone:{value:function(){return new n(this.x,this.y,this.width,this.height)},writable:!0},contains:{value:function(e,t){return this.left<=e&&e<=this.right&&this.top<=t&&t<=this.bottom},writable:!0},containsPoint:{value:function(e){return this.contains(e.x,e.y)},writable:!0},containsRect:{value:function(e){return this.top<=e.top&&e.bottom<=this.bottom&&this.left<=e.left&&e.right<=this.right},writable:!0},equals:{value:function(e){return this.x==e.x&&this.y==e.y&&this.width==e.width&&this.height==e.height},writable:!0},inflate:{value:function(e,t){this.x-=e,this.width+=2*e,this.y-=t,this.height+=2*t},writable:!0},inflatePoint:{value:function(e){this.inflate(e.x,e.y)},writable:!0},intersects:{value:function(e){return this.top>e.bottom||this.left>e.right||this.right<e.left||this.bottom<e.top?!1:!0},writable:!0},intersection:{value:function(e){if(this.intersects(e)!=1)return new n;var t,r,i,s;return t=this.top>e.top?this.top:e.top,r=this.right<e.right?this.right:e.right,i=this.bottom<e.bottom?this.bottom:e.bottom,s=this.left>e.left?this.left:e.left,new n(s,t,r-s,i-t)},writable:!0},isEmpty:{value:function(){return this.width<=0||this.height<=0},writable:!0},offset:{value:function(e,t){this.x+=e,this.y+=t},writable:!0},offsetPoint:{value:function(e){this.offset(e.x,e.y)},writable:!0},setEmpty:{value:function(){this.x=0,this.y=0,this.width=0,this.height=0},writable:!0},union:{value:function(e){if(this.isEmpty()&&e.isEmpty())return new n;if(e.isEmpty())return this.clone();if(this.isEmpty())return e.clone();var t,r,i,s;return t=this.top<e.top?this.top:e.top,r=this.right>e.right?this.right:e.right,i=this.bottom>e.bottom?this.bottom:e.bottom,s=this.left<e.left?this.left:e.left,new n(s,t,r-s,i-t)},writable:!0},_set:{value:function(e,t,n,r){this.x=e,this.y=t,this.width=n,this.height=r},writable:!0},toString:{value:function(){return'[object Rectangle x="'+this.x+'" y="'+this.y+'" width="'+this.width+'" height="'+this.height+'"]'},writable:!0}}),n}),herlock.define("module/view/geom/Matrix",["lib/Class","./Point","./Rectangle"],function(e,t,n){var r=Math.PI,i=0,s=1,o=2,u=3,a=4,f=5,l=[1,0,0,1,0,0],c=function(e,t,n,r,i,s){var o=arguments.length,u;o===0?(u=this._values=[1,0,0,1,0,0],this._isInitialValue=!0):(u=this._values=[o>0?e:1,o>1?t:0,o>2?n:0,o>3?r:1,o>4?i:0,o>5?s:0],this._isInitialValue=u[0]===1&&u[1]===0&&u[2]===0&&u[3]===1&&u[4]===0&&u[5]===0),this._version=Math.random()*1e7<<0};return c.prototype=Object.create({},{a:{get:function(){return this._values[0]},set:function(e){this._values[0]=e,this._increment()}},b:{get:function(){return this._values[1]},set:function(e){this._values[1]=e,this._increment()}},c:{get:function(){return this._values[2]},set:function(e){this._values[2]=e,this._increment()}},d:{get:function(){return this._values[3]},set:function(e){this._values[3]=e,this._increment()}},tx:{get:function(){return this._values[4]},set:function(e){this._values[4]=e,this._increment()}},ty:{get:function(){return this._values[5]},set:function(e){this._values[5]=e,this._increment()}},_increment:{value:function(){this._version++,this._isInitialValue=!1},writable:!0},_getVersion:{value:function(){return this._version},writable:!0},isInitialValue:{value:function(){return this._isInitialValue},writable:!0},clone:{value:function(){var e=new c;return e._values=this._values.slice(),e._version=this._version,e._isInitialValue=this._isInitialValue,e},writable:!0},concat:{value:function(e){if(e.isInitialValue())return;this._concat(e._values)},writable:!0},_concat:{value:function(e){if(this.isInitialValue())this._values=e;else{var t=this._values,n=e;this._values=[t[0]*n[0]+t[1]*n[2],t[0]*n[1]+t[1]*n[3],t[2]*n[0]+t[3]*n[2],t[2]*n[1]+t[3]*n[3],t[4]*n[0]+t[5]*n[2]+n[4],t[4]*n[1]+t[5]*n[3]+n[5]]}this._increment()},writable:!0},createBox:{value:function(){},writable:!0},createGradientBox:{value:function(){},writable:!0},deltaTransformPoint:{value:function(){},writable:!0},identity:{value:function(){this._values=[1,0,0,1,0,0],this._increment(),this._isInitialValue=!0},writable:!0},invert:{value:function(){var e=this.a*this.d-this.c*this.b;if(e===0)return;var t=1/e,n=this.tx;this.tx=(this.c*this.ty-n*this.d)*t,this.ty=(n*this.b-this.a*this.ty)*t,this.c=-this.c*t,this.b=-this.b*t,n=this.a,this.a=this.d*t,this.d=n*t,this._increment()},writable:!0},rotate:{value:function(e){var t=Math.cos(e),n=Math.sin(e);this._concat([t,n,-n,t,0,0])},writable:!0},scale:{value:function(e,t){this._concat([e,0,0,t,0,0])},writable:!0},transformPoint:{value:function(e){var n=this._values;return new t(e.x*n[0]+e.y*n[2]+1*n[4],e.x*n[1]+e.y*n[3]+1*n[5])},writable:!0},translate:{value:function(e,t){this._concat([1,0,0,1,e,t])},writable:!0},_getScaleX:{value:function(){return Math.sqrt(this.a*this.a+this.b*this.b)},writable:!0},_setScaleX:{value:function(e){this._increment();var t=this._getScaleX();if(t!==0){var n=e/t;this.a*=n,this.b*=n}else{var r=this._getSkewY_();this.a=Math.cos(r)*e,this.b=Math.sin(r)*e}},writable:!0},_getScaleY:{value:function(){return Math.sqrt(this.c*this.c+this.d*this.d)},writable:!0},_setScaleY:{value:function(e){this._increment();var t=this._getScaleY();if(t!==0){var n=e/t;this.c*=n,this.d*=n}else{var r=this._getSkewX_();this.c=-Math.sin(r)*e,this.d=Math.cos(r)*e}},writable:!0},_getSkewX:{value:function(){return this._getSkewX_()*(180/r)},writable:!0},_setSkewX:{value:function(e){this._setSkewX_(e*(r/180))},writable:!0},_getSkewY:{value:function(){return this._getSkewY_()*(180/r)},writable:!0},_setSkewY:{value:function(e){this._setSkewY_(e*(r/180))},writable:!0},_getRotation:{value:function(){return this._getSkewY_()*(180/r)},writable:!0},_setRotation:{value:function(e){this._setRotation_(e*(r/180))},writable:!0},_getX:{value:function(){return this.tx},writable:!0},_setX:{value:function(e){this.tx=e,this._increment()},writable:!0},_getY:{value:function(){return this.ty},writable:!0},_setY:{value:function(e){this.ty=e,this._increment()},writable:!0},_setRotation_:{value:function(e){var t=this._getSkewY_(),n=this._getSkewX_();this._setSkewX_(n+e-t),this._setSkewY_(e)},writable:!0},_getSkewX_:{value:function(){return Math.atan2(-this.c,this.d)},writable:!0},_setSkewX_:{value:function(e){var t=this._getScaleY();this.c=-t*Math.sin(e),this.d=t*Math.cos(e),this._increment()},writable:!0},_getSkewY_:{value:function(){return Math.atan2(this.b,this.a)},writable:!0},_setSkewY_:{value:function(e){var t=this._getScaleX();this.a=t*Math.cos(e),this.b=t*Math.sin(e),this._increment()},writable:!0},_calculateBoundsRect:{value:function(e){var r=[this.transformPoint(e.topLeft),this.transformPoint(new t(e.right,e.top)),this.transformPoint(new t(e.left,e.bottom)),this.transformPoint(e.bottomRight)],i=r[0].y,s=r[0].y,o=r[0].x,u=r[0].x;for(var a=1;a<4;a++){var f=r[a];i>f.y&&(i=f.y),s<f.y&&(s=f.y),o>f.x&&(o=f.x),u<f.x&&(u=f.x)}return new n(o,i,u-o,s-i)},writable:!0},_equal:{value:function(e){for(var t=0;t<6;t++)if(this._values[t]!=e._values[t])return!1;return!0},writable:!0}}),c}),herlock.define("module/view/geom/ColorTransform",["lib/Class"],function(e){function s(e,t,n){return e<<16|t<<8|n<<0}function o(e,t){return Math.round(t*255)<<24|e}function u(e){return e>>24&255}function a(e){return e>>16&255}function f(e){return e>>8&255}function l(e){return e>>0&255}var t=0,n=1,r=2,i=3,c=function(e,t,n,r,i,s,o,u){var a=arguments.length;if(a===0){this._version=Math.floor(Math.random()*1e7),this.__isInitialValue=!0,this._multiplier=[1,1,1,1],this._offset=[0,0,0,0];return}e=a>0?e:1,t=a>1?t:1,n=a>2?n:1,r=a>3?r:1,i=a>4?i:0,s=a>5?s:0,o=a>6?o:0,u=a>7?u:0,this._version=Math.floor(Math.random()*1e7),this.__isInitialValue=e==1&&t==1&&n==1&&r==1&&i==0&&s==0&&o==0&&u==0,this._multiplier=[e,t,n,r],this._offset=[i,s,o,u]};return c.prototype=Object.create({},{_increment:{writable:!0,value:function(){this._version++,this.__isInitialValue=!1}},_getVersion:{writable:!0,value:function(){return this._version}},_isInitialValue:{writable:!0,value:function(){return this.__isInitialValue}},color:{get:function(){return s(this._offset[t],this._offset[n],this._offset[r])},set:function(e){this._multiplier[t]=1,this._multiplier[n]=1,this._multiplier[r]=1,this._offset[t]=a(e),this._offset[n]=f(e),this._offset[r]=l(e),this._increment()}},alphaMultiplier:{get:function(){return this._multiplier[i]},set:function(e){this._multiplier[i]=e,this._increment()}},redMultiplier:{get:function(){return this._multiplier[t]},set:function(e){this._multiplier[t]=e,this._increment()}},greenMultiplier:{get:function(){return this._multiplier[n]},set:function(e){this._multiplier[n]=e,this._increment()}},blueMultiplier:{get:function(){return this._multiplier[r]},set:function(e){this._multiplier[r]=e,this._increment()}},alphaOffset:{get:function(){return this._offset[i]},set:function(e){this._offset[i]=e,this._increment()}},redOffset:{get:function(){return this._offset[t]},set:function(e){this._offset[t]=e,this._increment()}},greenOffset:{get:function(){return this._offset[n]},set:function(e){this._offset[n]=e,this._increment()}},blueOffset:{get:function(){return this._offset[r]},set:function(e){this._offset[r]=e,this._increment()}},clone:{writable:!0,value:function(){var e=new c(this._multiplier[t],this._multiplier[n],this._multiplier[r],this._multiplier[i],this._offset[t],this._offset[n],this._offset[r],this._offset[i]);return e._version=this._version,e}},concat:{writable:!0,value:function(e){if(e._isInitialValue())return;if(e._isInitialValue()){var s=e._multiplier,o=e._offset;this._multiplier[t]=s[t],this._multiplier[n]=s[n],this._multiplier[r]=s[r],this._multiplier[i]=s[i],this._offset[t]=o[t],this._offset[n]=o[n],this._offset[r]=o[r],this._offset[i]=o[i],this._increment()}else this._concat(e._multiplier,e._offset)}},_concat:{writable:!0,value:function(e,s){this._multiplier[t]*=e[t],this._multiplier[n]*=e[n],this._multiplier[r]*=e[r],this._multiplier[i]*=e[i],this._offset[t]=this._offset[t]*e[t]+s[t],this._offset[n]=this._offset[n]*e[n]+s[n],this._offset[r]=this._offset[r]*e[r]+s[r],this._offset[i]=this._offset[i]*e[i]+s[i],this._increment()}},_isAlphaTransform:{writable:!0,value:function(){return this._multiplier[i]!=1&&this._multiplier[t]==1&&this._multiplier[n]==1&&this._multiplier[r]==1&&this._offset[t]==0&&this._offset[n]==0&&this._offset[r]==0&&this._offset[i]==0}},_isColorTransform:{writable:!0,value:function(){return!this._isInitialValue()&&!this._isAlphaTransform()}},_getValueArray:{writable:!0,value:function(){var e=[];return e[0]=this._multiplier[t],e[1]=this._multiplier[n],e[2]=this._multiplier[r],e[3]=this._multiplier[i],e[4]=this._offset[t]/255,e[5]=this._offset[n]/255,e[6]=this._offset[r]/255,e[7]=this._offset[i]/255,e}}}),c}),herlock.define("module/view/flash/internal/renderer/RenderingNode",["lib/Class","module/view/flash/display/BlendMode","module/view/geom/Matrix","module/view/geom/ColorTransform"],function(e,t,n,r){var i=e(Object,function(e,i){e._blendMode="normal",e.concatenatedBlendMode="normal",e._mask=null,e.concatenatedMask=null,e._visible=!0,e.concatenatedVisible=!0,e._matrix=null,e.concatenatedMatrix=null,e._colorTransform=null,e.concatenatedColorTransform=null,e.needUpdateRequests=!1,e.needUpdateRequestsFromChildren=!1,e.childrenIsUpdated=!1,e.matrixIsUpdated=!1,e.concatenatedMatrixIsUpdated=!1,e.colorTransformIsUpdated=!1,e.concatenatedColorTransformIsUpdated=!1,e.constructor=function(){i.constructor.apply(this,arguments),this.children=[],this._matrix=new n,this.concatenatedMatrix=new n,this._colorTransform=new r,this.concatenatedColorTransform=new r,this._requestObjectsCache=[]},e.setMatrix=function(e){if(this._matrix._getVersion()==e._getVersion())return;this._matrix=e.clone(),this.matrixIsUpdated=!0},e.getMatrix=function(){return this._matrix.clone()},e.setColorTransform=function(e){if(this._colorTransform._getVersion()==e._getVersion())return;this._colorTransform=e.clone(),this.colorTransformIsUpdated=!0},e.getColorTransform=function(){return this._colorTransform},e.reflectProps=function(e,t,n,r,i,s){var o=e.parent;this.setMatrix(i),this.setColorTransform(s);if(this._visible!==t||this._blendMode!==n||this._mask!==r||this.childrenIsUpdated||this.matrixIsUpdated||this.colorTransformIsUpdated)this.needUpdateRequests=!0;this._visible=t,this._blendMode=n,this._mask=r},e.visit=function(e){var n=e.parent;if(!this.needUpdateRequests&&!this.needUpdateRequestsFromChildren)return this._requestObjectsCache;this.childrenIsUpdated=!1,n.concatenatedMatrixIsUpdated||this.matrixIsUpdated?(this.matrixIsUpdated=!1,this.concatenatedMatrix=this.getMatrix(),this.concatenatedMatrix.concat(n.concatenatedMatrix),this.concatenatedMatrixIsUpdated=!0):this.concatenatedMatrixIsUpdated=!1,n.concatenatedColorTransformIsUpdated||this.colorTransformIsUpdated?(this.colorTransformIsUpdated=!1,this.concatenatedColorTransform=this._colorTransform,this.concatenatedColorTransform.concat(n.concatenatedColorTransform),this.concatenatedColorTransformIsUpdated=!0):this.concatenatedColorTransformIsUpdated=!1,this.concatenatedVisible=this._visible&&n.concatenatedVisible,this.concatenatedMask=n.concatenatedMask?n.concatenatedMask:this._mask,this.concatenatedBlendMode=this._blendMode==t.NORMAL?n.concatenatedBlendMode:this._blendMode,e.parent=this,this._requestObjectsCache.length=0;var r=this.children.length;for(var i=0;i<r;++i){var s=this.children[i];s.needUpdateRequests=s.needUpdateRequests||this.needUpdateRequests,Array.prototype.push.apply(this._requestObjectsCache,s.visit(e.clone()))}return this.needUpdateRequests=!1,this.needUpdateRequestsFromChildren=!1,this._requestObjectsCache},e.getBoundingBox=function(e){if(!this.visible)return;var t=this.children.length;for(var n=0;n<t;++n)this.children[n].getBoundingBox(e)}});return i}),herlock.define("module/view/flash/geom/Transform",["lib/Class"],function(e){var t=e(Object,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments)},e.colorTransform={get:function(){return this._owner?this._owner._colorTransform.clone():new ColorTransform},set:function(e){if(!this._owner)return;!this._owner._setColorTransform(e)}},e.concatenatedColorTransform={get:function(){return}},e.concatenatedMatrix={get:function(){return}},e.matrix={get:function(){return this._owner?this._owner._matrix.clone():new Matrix},set:function(e){if(!this._owner)return;!this._owner._setMatrix(e)}},e._initwithOwner=function(e){this._owner=e},e._getOwner=function(){return this._owner}});return t}),herlock.define("module/view/flash/display/DisplayObject",["lib/Class","module/common/event/EventDispatcher","../internal/renderer/RenderingNode","./BlendMode","../geom/Transform","module/view/geom/Point","module/view/geom/Rectangle","module/view/geom/Matrix","module/view/geom/ColorTransform"],function(e,t,n,r,i,s,o,u,a){var f=Math.PI,l=e(t,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments),this._colorTransform=new a,this._naturalRect=new o,this._boundsRect=new o,this._matrix=new u,this._transformationPoint=null,this._scale9Grid=new o},e._blendMode=r.NORMAL,e._cacheAsBitmap=!1,e._cacheHandle=null,e._visible=!0,e._parent=null,e._mask=null,e._containable=!1,e._interactive=!1,e._xValue=0,e._yValue=0,e._scaleXValue=1,e._scaleYValue=1,e._rotationValue=0,e._skewXValue=0,e._skewYValue=0,e._calcNaturalRectRequested=!0,e._calcBoundsRectRequested=!0,e._calcMatrixRequested=!0,e._enabledTransformationPoint=!1,e.alpha={get:function(){return this._colorTransform.alphaMultiplier},set:function(e){this._colorTransform.alphaMultiplier=e}},e.blendMode={get:function(){return this._blendMode},set:function(e){this._blendMode=e}},e.cacheAsBitmap={get:function(){return this._cacheAsBitmap},set:function(e){this._cacheAsBitmap=e}},e.height={get:function(){return this._getBoundsRect().height},set:function(e){this.scaleY=this.scaleY*e/this.height}},e.mask={get:function(){this._mask},set:function(e){this._mask=e}},e.name="",e.parent={get:function(){return this._parent}},e.root={get:function(){return this._parent?this._parent.root:this}},e.scale9Grid={get:function(){return this._scale9Grid.clone()},set:function(e){e===null?this._scale9Grid.setEmpty():this._scale9Grid=e}},e.rotation={get:function(){return this._rotationValue},set:function(e){if(this._enabledTransformationPoint){this._setRotationWithTransformPoint(e,this.transformationPoint);return}while(e>180)e-=360;while(e<-180)e+=360;this._rotationValue=e;var t=new u;t._setSkewX(this._skewXValue),t._setSkewY(this._skewYValue),t.rotate((this._rotationValue-t._getRotation())/180*f),this._skewXValue=t._getSkewX(),this._skewYValue=t._getSkewY(),this._requestCalcNaturalRect()}},e._setRotationWithTransformPoint=function(e,t){var n=this._getMatrix(),r=n.transformPoint(t);while(e>180)e-=360;while(e<-180)e+=360;this._rotationValue=e;var i=new u;i._setSkewX(this._skewXValue),i._setSkewY(this._skewYValue),i.rotate((this._rotationValue-i._getRotation())/180*f),this._skewXValue=i._getSkewX(),this._skewYValue=i._getSkewY(),this._requestCalcNaturalRect(),n=this._getMatrix();var i=n.transformPoint(t);this._xValue+=r.x-i.x,this._yValue+=r.y-i.y,this._requestCalcNaturalRect()},e.scaleX={get:function(){return this._scaleXValue},set:function(e){if(this._scaleXValue===e)return;if(this._enabledTransformationPoint){this._setScaleXWithTransformPoint(e,this._transformationPoint);return}isNaN(e)&&console.error("debug scaleX",this,e),this._scaleXValue=e,this._requestCalcNaturalRect()}},e._setScaleXWithTransformPoint=function(e,t){var n=this._getMatrix(),r=n.transformPoint(t);this._scaleXValue=e,this._requestCalcNaturalRect(),n=this._getMatrix();var i=n.transformPoint(t);this._xValue+=r.x-i.x,this._yValue+=r.y-i.y,this._requestCalcNaturalRect()},e.scaleY={get:function(){return this._scaleYValue},set:function(e){if(this._scaleYValue===e)return;if(this._enabledTransformationPoint){this._setScaleYWithTransformPoint(e,this._transformationPoint);return}this._scaleYValue=e,this._requestCalcNaturalRect()}},e._setScaleYWithTransformPoint=function(e,t){var n=this._getMatrix(),r=n.transformPoint(t);this._scaleYValue=e,this._requestCalcNaturalRect(),n=this._getMatrix();var i=n.transformPoint(t);this._xValue+=r.x-i.x,this._yValue+=r.y-i.y,this._requestCalcNaturalRect()},e.stage={get:function(){return this._parent?this._parent.stage:null}},e.transform={get:function(){var e=new i;return e._initwithOwner(this),e},set:function(e){this._setColorTransform(e.getColorTransform()),this._setMatrix(e.getMatrix()),requestCalcNaturalRect()}},e.visible={get:function(){return this._visible},set:function(e){if(this._visible==e)return;this._visible=e,this._requestCalcNaturalRect()}},e.width={get:function(){return this._getBoundsRect().width},set:function(e){this.scaleX=this.scaleX*e/this.width}},e.x={get:function(){return this._xValue},set:function(e){if(this._xValue===e)return;this._xValue=e,this._requestCalcNaturalRect()}},e.y={get:function(){return this._yValue},set:function(e){if(this._yValue===e)return;this._yValue=e,this._requestCalcNaturalRect()}},e.getBounds=function(e){e||(e=this);var t=this._getConcatenatedMatrix(),n=e._getConcatenatedMatrix();n.invert(),t.concat(n);var r=this._getNaturalRect(),i=t._calculateBoundsRect(r);return i},e.getRect=function(e){return getBounds(e)},e.globalToLocal=function(e){var t=this._getConcatenatedMatrix();return t.invert(),t.transformPoint(e)},e.hitTestObject=function(e){var t=this._getNaturalRect(),n=this._getConcatenatedMatrix()._calculateBoundsRect(t);t=e._getNaturalRect();var r=e._getConcatenatedMatrix()._calculateBoundsRect(t),i=n.containsRect(r)||n.intersects(r);return i},e.hitTestPoint=function(e,t,n){var r=this.stage;if(!r)return!1;if(n){var i=this.getBounds(r);return i.containsPoint(new s(e,t))}var i=this.getBounds(r);return i.containsPoint(new s(e,t))},e.localToGlobal=function(e){return this._getConcatenatedMatrix().transformPoint(e)},e.transformationPoint={get:function(){return this._transformationPoint?this._transformationPoint.clone():new s(0,0)},set:function(e){this._transformationPoint=e.clone(),this._enabledTransformationPoint=!0,e.x==0&&e.y==0&&(this._enabledTransformationPoint=!1)}},e._getMatrix=function(){return this._getMatrixRef().clone()},e._getMatrixRef=function(){if(this._calcMatrixRequested){this._calcMatrixRequested=!1;var e=new u;e.scale(this._scaleXValue,this._scaleYValue),this._skewXValue!=this._skewYValue?(e._setSkewX(this._skewXValue),e._setSkewY(this._skewYValue)):e.rotate(this._rotationValue/180*f),e.translate(this._xValue,this._yValue),this._matrix._equal(e)||(this._matrix=e)}return this._matrix},e._setMatrix=function(e){this._xValue=e._getX(),this._yValue=e._getY(),this._rotationValue=e._getRotation(),this._scaleXValue=e._getScaleX(),this._scaleYValue=e._getScaleY(),this._skewXValue=e._getSkewX(),this._skewYValue=e._getSkewY(),this._requestCalcNaturalRect()},e._getColorTransform=function(){return this._colorTransform.clone()},e._getColorTransformRef=function(){return this._colorTransform},e._setColorTransform=function(e){this._colorTransform=e},e._getConcatenatedMatrix=function(){var e=this._getMatrix(),t=this.parent;while(t){var n=t._getMatrix();e.concat(n),t=t.parent}return e},e._getConcatenatedColorTransform=function(){},e._setParent=function(e){this._parent!=null&&(this._parent=null);if(e==null)return;this._parent=e},e._notifyOnAddedToStage=function(){this._hasEventListener("addedToStage")&&this.dispatchEvent(new Event("addedToStage"))},e._notifyOnRemovedFromStage=function(){this._hasEventListener("removedFromStage")&&this.dispatchEvent(new Event("removedFromStage"))},e._notifyOnEnterFrame=function(){this._hasEventListener("enterFrame")&&this.dispatchEvent(new Event("enterFrame"))},e._notifyOnFrameConstructed=function(){},e._notifyOnExecuteFrameScript=function(){},e._notifyOnExitFrame=function(){this._hasEventListener("exitFrame")&&this.dispatchEvent(new Event("exitFrame"))},e._drawVectorGraphics=function(){},e._glPrepare=function(e){var t=this._getRenderingNode(),n=null;return this._mask!=null?n=this._mask._getRenderingNode():this._mask==null&&!!t.mask&&(n=null),t.reflectProps(e,this._visible,this._blendMode,n,this._getMatrixRef(),this._getColorTransform()),t},e._getNaturalRect=function(){return this._calcNaturalRectRequested&&(this._calcNaturalRectRequested=!1,this._calculateNaturalRect()),this._naturalRect},e._calculateNaturalRect=function(){this._naturalRect.setEmpty()},e._requestCalcNaturalRect=function(e){if(e==1)return;if(this._calcMatrixRequested)return;this._calcMatrixRequested=!0,this._calcNaturalRectRequested=!0,this._calcBoundsRectRequested=!0,this._parent!==null&&this._parent._requestCalcNaturalRect()},e._getBoundsRect=function(){if(this._calcBoundsRectRequested){this._calcBoundsRectRequested=!1;var e=this._getNaturalRect();this._boundsRect=this._getMatrix()._calculateBoundsRect(e),isNaN(this._boundsRect.width)&&console.error("debug",this,this._boundsRect)}return this._boundsRect},e._getNodesToRoot=function(){var e=[];if(this._parent==null)return e;var t=this;while(t!=null)e.push(t),t=t.parent;return e},e._hitTestStrictInternal=function(e){var t=this._getMatrix();t.invert();var n=t.transformPoint(e),r=this._getNaturalRect().containsPoint(n);if(r&&this.mask){var i=this.mask,s=i._getConcatenatedMatrix();s.invert(),n=this._getConcatenatedMatrix().transformPoint(n),n=s.transformPoint(n),r=i._getNaturalRect().containsPoint(n)}return r?this:null},e._renderingNode=null,e._getRenderingNode=function(){return this._renderingNode||(this._renderingNode=this._createRenderingNode()),this._renderingNode},e._createRenderingNode=function(){return new n},e.toString=function(){return'[object DisplayObject name="'+this.name+'"]'}});return l}),herlock.define("module/view/flash/display/InteractiveObject",["lib/Class","./DisplayObject"],function(e,t){var n=e(t,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments)},e.mouseEnabled=!0});return n}),herlock.define("module/view/flash/display/DisplayObjectContainer",["lib/Class","./InteractiveObject"],function(e,t){var n=e(t,function(e,n){e.constructor=function(){n.constructor.apply(this,arguments),this._children=[],this._updatedChildrenForWorkChildren=!0,this._updatedChildrenForRenderingNode=!0},e.numChildren={get:function(){return this._children.length}},e.mouseChildren=!0,e.addChild=function(e){return this.addChildAt(e,this._children.length)},e.addChildAt=function(e,t){if(!e)return console.log("warning: "+this+".addChild child="+e);if(t<0)return console.log("warning: out of range.");if(this._children.length<t)return console.log("warning: out of range.");e._parent&&e._parent.removeChild(e),this._children.splice(t,0,e),e._setParent(this),this._requestCalcNaturalRect(),this._childrenUpdated();var n=[],r=e._getNodesToRoot();for(var i=r.length-1;i>=0;i--)n.push(r[i]);return e._propagateEvent(new Event("added"),n),e.stage&&e._notifyOnAddedToStage(),e},e.getChildIndex=function(e){return this._children.indexOf(e)},e.getChildAt=function(e){return this._children.length<=e?null:this._children[e]},e.getChildByName=function(e){for(var t=this._children.length-1;t>=0;t--)if(this._children[t].name===e)return this._children[t];return null},e.removeChild=function(e){var t=this._children.indexOf(e);return t===-1?console.log("warning: "+this+".removeChild("+e+")"):this.removeChildAt(t)},e.removeChildAt=function(e){if(e<0)return console.log("warning: out of range.");if(this._children.length<=e)return console.log("warning: out of range.");var t=this._children[e],n=[],r=t._getNodesToRoot();for(var i=r.length-1;i>=0;i--)n.push(r[i]);return this._children.splice(e,1)[0],t._setParent(null),this._requestCalcNaturalRect(),this._childrenUpdated(),t._propagateEvent(new Event("removed"),n),t.stage||t._notifyOnRemovedFromStage(),t},e.contains=function(e){if(this===e)return!0;if(this._children.indexOf(e)!==-1)return!0;var t=this._children,n=t.length;for(var r=0;r<n;r++)if(t[r].contains&&t[r].contains(e))return!0;return!1},e.setChildIndex=function(e,t){this.addChildAt(e,t)},e.swapChildren=function(e,t){var n=this.getChildIndex(e),r=this.getChildIndex(t);if(n==-1||r==-1)return;this.addChildAt(e,r),this.addChildAt(t,n),this._childrenUpdated()},e.swapChildrenAt=function(e,t){var n=this.numChildren();if(e>=n||t>=n||e<0||t<0)return;this.swapChildren(this.getChildAt(e),this.getChildAt(t))},e._childrenUpdated=function(){this._updatedChildrenForWorkChildren=!0,this._updatedChildrenForRenderingNode=!0},e._notifyOnAddedToStage=function(){DisplayObject.prototype._notifyOnAddedToStage.call(this);var e=this._children.slice(),t=e.length;for(var n=0;n<t;n++)e[n]._notifyOnAddedToStage()},e._notifyOnRemovedFromStage=function(){DisplayObject.prototype._notifyOnRemovedFromStage.call(this);var e=this._children.slice(),t=e.length;for(var n=0;n<t;n++)e[n]._notifyOnRemovedFromStage()},e._notifyOnEnterFrame=function(){DisplayObject.prototype._notifyOnEnterFrame.call(this);var e=this._children.slice(),t=e.length;for(var n=0;n<t;n++)e[n]._notifyOnEnterFrame()},e._notifyOnFrameConstructed=function(){DisplayObject.prototype._notifyOnFrameConstructed.call(this);var e=this._children.slice(),t=e.length;for(var n=0;n<t;n++)e[n]._notifyOnFrameConstructed()},e._notifyOnExecuteFrameScript=function(){DisplayObject.prototype._notifyOnExecuteFrameScript.call(this);var e=this._children.slice(),t=e.length;for(var n=0;n<t;n++)e[n]._notifyOnExecuteFrameScript()},e._notifyOnExitFrame=function(){DisplayObject.prototype._notifyOnExitFrame.call(this);var e=this._children.slice(),t=e.length;for(var n=0;n<t;n++)e[n]._notifyOnExitFrame()},e._drawVectorGraphics=function(){var e=this._children,t=e.length;for(var n=0;n<t;n++)e[n]._drawVectorGraphics()},e._glPrepare=function(e){DisplayObject.prototype._glPrepare.call(this,e);var t=this._getRenderingNode(),n=this._children,r=n.length;if(this._updatedChildrenForRenderingNode){this._updatedChildrenForRenderingNode=!1,t.childrenIsUpdated=!0,t.needUpdateRequestsFromChildren=!0;var i=t.children;i.length=0;for(var s=0;s<r;s++){var o=n[s]._glPrepare(e);if(o==null)continue;i.push(o)}}else for(var s=0;s<r;s++){var o=n[s]._glPrepare(e);t.needUpdateRequestsFromChildren=t.needUpdateRequestsFromChildren||o.needUpdateRequests||o.needUpdateRequestsFromChildren}return t},e._calculateNaturalRect=function(){this._naturalRect.setEmpty();var e=this._children.slice(),t=e.length;for(var n=0;n<t;n++)e[n].visible&&(this._naturalRect=this._naturalRect.union(e[n]._getBoundsRect()))},e._hitTestStrictInternal=function(e){if(n._hitTestStrictInternal.call(this,e)==null)return null;var r=null,i=this._getMatrix();i.invert(),e=i.transformPoint(e);var s=!1;for(var o=this.numChildren-1;o>=0;o--){if(this.getChildAt(o).visible!=1)continue;r=this.getChildAt(o)._hitTestStrictInternal(e);if(r==null)continue;if(this.mouseChildren!=1)return this;if(r.isInstanceOf(t)!=1||r.mouseEnabled!=1){s=!0;continue}return r}return s?this:null},e.toString=function(){return'[object DisplayObjectContainer name="'+this.name+'"]'}});return n}),herlock.define("module/view/flash/display/Sprite",["lib/Class","./DisplayObjectContainer"],function(e,t){var n=e(t,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments)},e.toString=function(){return'[object Sprite name="'+this.name+'"]'}});return n}),herlock.define("module/view/flash/internal/renderer/Renderer",["lib/Class"],function(e){var t=e(Object,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments)},e.accept=function(e){return!1},e.render=function(){},e._getShader=function(){return null}});return t}),herlock.define("module/view/gl/Scissor",["lib/Class"],function(e){var t=e(Object,function(e,n){e.constructor=function(e,r,i,s,o){n.constructor.apply(this,arguments),this._x=e,this._y=r,this._w=i,this._h=s,o&&(t._current=this)},e.enable=function(){this.isEmpty()||(gl.enable(gl.SCISSOR_TEST),gl.scissor(this._x,this._y,this._w,this._h),checkGlError("glScissor")),t._current=this},e.disable=function(){gl.disable(gl.SCISSOR_TEST),checkGlError("glDisable"),t._current=null},e.isEmpty=function(){return this._x==0&&this._y==0&&this._w==0&&this._h==0},e.equals=function(e,t,n,r){return this._x==e&&this._y==t&&this._w==n&&this._h==r}}),n=new function(){var e=[];this.push=function(t){e.push(t),t.enable()},this.pop=function(){e.pop(),e.length>0?e[e.length-1].enable():gl.disable(gl.SCISSOR_TEST)}};t._current=null;var r={unbind:function(){n.pop()}};return t.BindScope=function(e){return n.push(e),r},t.getX=function(){return this._current==null?0:this._current._x},t.getY=function(){return this._current==null?0:this._current._y},t.getWidth=function(){return this._current==null?0:this._current._w},t.getHeight=function(){return this._current==null?0:this._current._h},t.getCancelScissor=function(){return this._cancelScissor||(this._cancelScissor=new t(0,0,0,0)),this._cancelScissor},t}),herlock.define("module/view/gl/TextureObject",["lib/Class"],function(e){var t=e(Object,function(e,r){e.constructor=function(e,n){r.constructor.apply(this,arguments),this._id,this._width=e,this._height=n,gl.activeTexture(gl.TEXTURE0),this._id=gl.createTexture(),checkGlError("gl.createTexture");var i=s(this);gl.texParameterf(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.LINEAR),checkGlError("gl.texParameterf"),gl.texParameterf(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.LINEAR),checkGlError("gl.texParameterf"),gl.texParameterf(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE),checkGlError("gl.texParameterf"),gl.texParameterf(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE),checkGlError("gl.texParameterf"),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,e,n,0,gl.RGBA,gl.UNSIGNED_BYTE,null),checkGlError("gl.texImage2D"),i.unbind(),t.put(this)},e.getId=function(){return this._id},e.getWidth=function(){return this._width},e.getHeight=function(){return this._height},e.bind=function(){if(n==this._id)return;gl.bindTexture(gl.TEXTURE_2D,this._id),checkGlError("glBindTexture"),n=this._id},e.unbind=function(){},e.subImage2D=function(e,t,n,r,i){var o=arguments.length,u=s(this);o>3?gl.texSubImage2D(gl.TEXTURE_2D,0,e,t,n,r,gl.RGBA,gl.UNSIGNED_BYTE,i):gl.texSubImage2D(gl.TEXTURE_2D,0,e,t,gl.RGBA,gl.UNSIGNED_BYTE,n),checkGlError("glTexSubImage2D"),u.unbind()}}),n,r=new function(){var e=[];this.push=function(t){e.push(t),t.bind()},this.pop=function(){e.pop(),e.length>0&&e[e.length-1].bind()}},i={unbind:function(){r.pop()}},s=t.BindScope=function(e){return r.push(e),i};return t._list=[],t.getById=function(e){var t=this._list.length;for(var n=0;n<t;n++)if(this._list[n].getId()==e)return this._list[n];return null},t.put=function(e){this._list.push(e)},t.release=function(e){var t=this._list.length;for(var n=0;n<t;n++)if(this._list[n]==e){this._list.splice(n,1);return}},t}),herlock.define("module/view/gl/Shader",["lib/Class"],function(e){function i(e,t){var n=gl.createShader(t);checkGlError("glCreateShader"),gl.shaderSource(n,e),checkGlError("glShaderSource"),gl.compileShader(n),checkGlError("glCompileShader");if(!gl.getShaderParameter(n,gl.COMPILE_STATUS)){var r=gl.getShaderInfoLog(n);return console.error(r),-1}return n}function s(e,t){var n=i(e,gl.VERTEX_SHADER),r=i(t,gl.FRAGMENT_SHADER);n==-1&&console.error("gl Create Vertex Shaders Failed"),r==-1&&console.error("gl Create Fragment Shaders Failed");var s=gl.createProgram();checkGlError("glCreateProgram"),gl.attachShader(s,n),checkGlError("glAttachShader"),gl.attachShader(s,r),checkGlError("glAttachShader"),gl.linkProgram(s),checkGlError("glLinkProgram");var o=gl.getProgramInfoLog(s,gl.LINK_STATUS);return checkGlError("glGetProgramiv"),o?(console.error(o),-1):(gl.deleteShader(n),checkGlError("glDeleteShader"),gl.deleteShader(r),checkGlError("glDeleteShader"),s)}var t=e(Object,function(e,n){e.constructor=function(){n.constructor.apply(this,arguments),this._built=!1,this._programId=null,this._vertexShaderCode,this._fragmentShaderCode},e.setVertexShaderCode=function(e){if(this.isBuilt())return;this._vertexShaderCode=e},e.setFragmentShaderCode=function(e){if(this.isBuilt())return;this._fragmentShaderCode=e},e.build=function(){if(this.isBuilt())return;this._programId=s(this._vertexShaderCode,this._fragmentShaderCode);if(this._programId==-1)return;this._built=!0,this._onBuilt()},e.getProgramId=function(){return this._programId},e.getAttributeLocation=function(e){if(this.isBuilt()!=1)return-1;var t=-1;return t=gl.getAttribLocation(this._programId,e),checkGlError("glGetAttribLocation"),t},e.getUniformLocation=function(e){if(this.isBuilt()!=1)return-1;var t=-1;return t=gl.getUniformLocation(this._programId,e),checkGlError("glGetUniformLocation"),t},e.isBuilt=function(){return this._built},e.isActive=function(){return t._current==this},e.activate=function(){if(this.isActive())return;this.isBuilt()!=1&&this.build();if(this.isBuilt()!=1)return;t._current!=null&&t._current.deactivate(),t._current=this,gl.useProgram(this._programId),checkGlError("glUseProgram"),this._onActivate()},e.deactivate=function(){if(this.isActive()!=1)return;this._onDeactivate()},e.draw=function(e,t){},e._onBuilt=function(){},e._onActivate=function(){},e._onDeactivate=function(){}}),n=new function(){var e=[];this.push=function(t){e.push(t),t.activate()},this.pop=function(){e.pop(),e.length>0&&e[e.length-1].activate()}};t._current=null;var r={unbind:function(){n.pop()}};return t.BindScope=function(e){return n.push(e),r},t}),herlock.define("module/view/flash/internal/renderer/SubImageRenderer",["lib/Class","./Renderer","module/view/gl/Viewport","module/view/gl/Scissor","module/view/gl/TextureObject","module/view/gl/Shader","module/view/flash/display/BlendMode"],function(e,t,n,r,i,s,o){var u="#ifdef GL_ES\nprecision highp float;\n#endif\nattribute vec4 a_positionAndTexPoint;\nvarying vec2 v_texCoords;\nvoid main() {\n   v_texCoords = a_positionAndTexPoint.zw;\n   gl_Position = vec4( a_positionAndTexPoint.xy, 0.0, 1.0 );\n}",a="#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_texUnitId;\nvarying vec2 v_texCoords;\nvoid main() {\n	vec4 color = texture2D( u_texUnitId, v_texCoords );\n	gl_FragColor = vec4(color.rgb * color.a , color.a);\n}",f=e(t,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments),this._textureId=-1,this._blendMode=o.NONE,this._maskNode=null,this._objects=[]},e._getShader=function(){if(this._shader!=null)return this._shader;this._shader=new s,this._shader.setVertexShaderCode(u),this._shader.setFragmentShaderCode(a),this._shader.build();var e=s.BindScope(this._shader);return this._a_positionAndTexPoint=this._shader.getAttributeLocation("a_positionAndTexPoint"),gl.enableVertexAttribArray(this._a_positionAndTexPoint),this._u_texUnitId=this._shader.getUniformLocation("u_texUnitId"),gl.uniform1i(this._u_texUnitId,0),gl.enable(gl.BLEND),e.unbind(),this._shader},e._getVBO=function(){return this._vbo!=null?this._vbo:(this._vbo=gl.createBuffer(),this._vbo)},e.accept=function(e){return this._textureId==-1&&this._blendMode==o.NONE?(this._textureId=e.getTextureId(),this._blendMode=e.blendMode,this._maskNode=e.maskNode,this._objects.push(e),!0):e.getTextureId()!=this._textureId?!1:e.blendMode!=this._blendMode?!1:e.maskNode!=this._maskNode?!1:(this._objects.push(e),!0)},e.render=function(){var e=this._objects.length;if(e<=0)return;var t=[];for(var u=0;u<e;u++){var a=this._objects[u];Array.prototype.push.apply(t,a.vertexes)}var f=s.BindScope(this._getShader());switch(this._blendMode){case o.ADD:gl.blendFunc(gl.ONE,gl.ONE),checkGlError("glBlendFunc");break;case o.NORMAL:default:gl.blendFunc(gl.ONE,gl.ONE_MINUS_SRC_ALPHA),checkGlError("glBlendFunc")}var l=null;if(this._maskNode){var c=new Rectangle;this._maskNode.getBoundingBox(c);var h=new Matrix;h.translate(1,1),h.scale(n.getWidth()/2,n.getHeight()/2),c=h._calculateBoundsRect(c),l=new r(Math.round(c.x),Math.round(c.y),Math.round(c.width),Math.round(c.height)),l.enable()}var p=i.BindScope(i.getById(this._textureId));gl.bindBuffer(gl.ARRAY_BUFFER,this._getVBO()),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(t),gl.STATIC_DRAW),gl.vertexAttribPointer(this._a_positionAndTexPoint,4,gl.FLOAT,!1,16,0),checkGlError("glVertexAttribPointer"),gl.drawArrays(gl.TRIANGLES,0,e*6),checkGlError("glDrawArrays"),l!=null&&l.disable(),this._objects=[],this._textureId=-1,this._blendMode=o.NONE,this._maskNode=null,f.unbind()}});return f}),herlock.define("module/view/flash/internal/renderer/SubImageRendererAlpha",["lib/Class","./Renderer","module/view/gl/Viewport","module/view/gl/Scissor","module/view/gl/TextureObject","module/view/gl/Shader","module/view/flash/display/BlendMode"],function(e,t,n,r,i,s,o){var u="#ifdef GL_ES\nprecision highp float;\n#endif\nattribute vec4 a_positionAndTexPoint;\nattribute lowp float a_alpha;\nvarying vec2 v_texCoords;\nvarying lowp float v_alpha;\nvoid main() {\n   v_texCoords = a_positionAndTexPoint.zw;\n   v_alpha = a_alpha;\n   gl_Position = vec4( a_positionAndTexPoint.xy, 0, 1 );\n}\n",a="#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_texUnitId;\nvarying vec2 v_texCoords;\nvarying lowp float v_alpha;\nvoid main() {\n   vec4 color = texture2D( u_texUnitId, v_texCoords );\n   color.a = v_alpha * color.a;\n   color = vec4(color.rgb * color.a , color.a);\n	 gl_FragColor = color;\n}",f=e(t,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments),this._textureId=-1,this._blendMode=o.NONE,this._maskNode=null,this._objects=[]},e._getShader=function(){if(this._shader!=null)return this._shader;this._shader=new s,this._shader.setVertexShaderCode(u),this._shader.setFragmentShaderCode(a),this._shader.build();var e=s.BindScope(this._shader);return this._a_positionAndTexPoint=this._shader.getAttributeLocation("a_positionAndTexPoint"),gl.enableVertexAttribArray(this._a_positionAndTexPoint),this._a_alpha=this._shader.getAttributeLocation("a_alpha"),gl.enableVertexAttribArray(this._a_alpha),this._u_texUnitId=this._shader.getUniformLocation("u_texUnitId"),gl.uniform1i(this._u_texUnitId,0),gl.enable(gl.BLEND),e.unbind(),this._shader},e._getVBO=function(){return this._vbo!=null?this._vbo:(this._vbo=gl.createBuffer(),this._vbo)},e.accept=function(e){return this._textureId==-1&&this._blendMode==o.NONE?(this._textureId=e.getTextureId(),this._blendMode=e.blendMode,this._maskNode=e.maskNode,this._objects.push(e),!0):e.getTextureId()!=this._textureId?!1:e.blendMode!=this._blendMode?!1:e.maskNode!=this._maskNode?!1:(this._objects.push(e),!0)},e.render=function(){var e=this._objects.length;if(e<=0)return;var t=[],u=[];for(var a=0;a<e;a++){var f=this._objects[a],l=f.colorTransform.alphaMultiplier;Array.prototype.push.apply(t,f.vertexes),Array.prototype.push.apply(u,[l,l,l,l,l,l])}var c=s.BindScope(this._getShader());switch(this._blendMode){case o.ADD:gl.blendFunc(gl.ONE,gl.ONE),checkGlError("glBlendFunc");break;case o.NORMAL:default:gl.blendFunc(gl.ONE,gl.ONE_MINUS_SRC_ALPHA),checkGlError("glBlendFunc")}var h=null;if(this._maskNode){var p=new Rectangle;this._maskNode.getBoundingBox(p);var d=new Matrix;d.translate(1,1),d.scale(n.getWidth()/2,n.getHeight()/2),p=d._calculateBoundsRect(p),h=new r(Math.round(p.x),Math.round(p.y),Math.round(p.width),Math.round(p.height)),h.enable()}var v=i.BindScope(i.getById(this._textureId));gl.bindBuffer(gl.ARRAY_BUFFER,this._getVBO()),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(t),gl.STATIC_DRAW),gl.vertexAttribPointer(this._a_positionAndTexPoint,4,gl.FLOAT,!1,16,0),checkGlError("glVertexAttribPointer"),this._alphaVBO||(this._alphaVBO=gl.createBuffer()),gl.bindBuffer(gl.ARRAY_BUFFER,this._alphaVBO),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(u),gl.STATIC_DRAW),gl.vertexAttribPointer(this._a_alpha,1,gl.FLOAT,!1,4,0),checkGlError("glVertexAttribPointer"),gl.drawArrays(gl.TRIANGLES,0,e*6),checkGlError("glDrawArrays"),h!=null&&(h.disable(),delete h),this._objects=[],this._textureId=-1,this._blendMode=o.NONE,this._maskNode=null,c.unbind()}});return f}),herlock.define("module/view/flash/internal/renderer/SubImageRendererColorTransform",["lib/Class","./Renderer","module/view/gl/Viewport","module/view/gl/Scissor","module/view/gl/TextureObject","module/view/gl/Shader","module/view/flash/display/BlendMode"],function(e,t,n,r,i,s,o){var u="#ifdef GL_ES\nprecision highp float;\n#endif\nattribute vec4 a_positionAndTexPoint;\nattribute lowp vec4 a_colorMulti;\nattribute lowp vec4 a_colorOffset;\nvarying vec2 v_texCoords;\nvarying lowp vec4 v_colorMulti;\nvarying lowp vec4 v_colorOffset;\nvoid main() {\n   v_texCoords = a_positionAndTexPoint.zw;\n   v_colorMulti = a_colorMulti;\n   v_colorOffset = a_colorOffset;\n   gl_Position = vec4( a_positionAndTexPoint.xy, 0, 1 );\n}",a="#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_texUnitId;\nvarying vec2 v_texCoords;\nvarying lowp vec4 v_colorMulti;\nvarying lowp vec4 v_colorOffset;\nvoid main() {\n   vec4 color = texture2D( u_texUnitId, v_texCoords );\n   color = color * v_colorMulti + v_colorOffset;\n   gl_FragColor = vec4( color.rgb * color.a, color.a );\n}",f=e(t,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments),this._textureId=-1,this._blendMode=o.NONE,this._maskNode=null,this._objects=[]},e._getShader=function(){if(this._shader!=null)return this._shader;this._shader=new s,this._shader.setVertexShaderCode(u),this._shader.setFragmentShaderCode(a),this._shader.build();var e=s.BindScope(this._shader);return this._a_positionAndTexPoint=this._shader.getAttributeLocation("a_positionAndTexPoint"),gl.enableVertexAttribArray(this._a_positionAndTexPoint),this._a_colorMulti=this._shader.getAttributeLocation("a_colorMulti"),gl.enableVertexAttribArray(this._a_colorMulti),this._a_colorOffset=this._shader.getAttributeLocation("a_colorOffset"),gl.enableVertexAttribArray(this._a_colorOffset),this._u_texUnitId=this._shader.getUniformLocation("u_texUnitId"),gl.uniform1i(this._u_texUnitId,0),gl.enable(gl.BLEND),e.unbind(),this._shader},e._getVBO=function(){return this._vbo!=null?this._vbo:(this._vbo=gl.createBuffer(),this._vbo)},e.accept=function(e){return this._textureId==-1&&this._blendMode==o.NONE?(this._textureId=e.getTextureId(),this._blendMode=e.blendMode,this._maskNode=e.maskNode,this._objects.push(e),!0):e.getTextureId()!=this._textureId?!1:e.blendMode!=this._blendMode?!1:e.maskNode!=this._maskNode?!1:(this._objects.push(e),!0)},e.render=function(){var e=this._objects.length;if(e<=0)return;var t=[],u=[],a=[];for(var f=0;f<e;f++){var l=this._objects[f];Array.prototype.push.apply(t,l.vertexes);var c=l.colorTransform._getValueArray(),h=f*6*4;u[h+0+0]=u[h+0+4]=u[h+0+8]=u[h+0+12]=u[h+0+16]=u[h+0+20]=c[0],u[h+1+0]=u[h+1+4]=u[h+1+8]=u[h+1+12]=u[h+1+16]=u[h+1+20]=c[1],u[h+2+0]=u[h+2+4]=u[h+2+8]=u[h+2+12]=u[h+2+16]=u[h+2+20]=c[2],u[h+3+0]=u[h+3+4]=u[h+3+8]=u[h+3+12]=u[h+3+16]=u[h+3+20]=c[3],a[h+0+0]=a[h+0+4]=a[h+0+8]=a[h+0+12]=a[h+0+16]=a[h+0+20]=c[4],a[h+1+0]=a[h+1+4]=a[h+1+8]=a[h+1+12]=a[h+1+16]=a[h+1+20]=c[5],a[h+2+0]=a[h+2+4]=a[h+2+8]=a[h+2+12]=a[h+2+16]=a[h+2+20]=c[6],a[h+3+0]=a[h+3+4]=a[h+3+8]=a[h+3+12]=a[h+3+16]=a[h+3+20]=c[7]}var p=s.BindScope(this._getShader());switch(this._blendMode){case o.ADD:gl.blendFunc(gl.ONE,gl.ONE),checkGlError("glBlendFunc");break;case o.NORMAL:default:gl.blendFunc(gl.ONE,gl.ONE_MINUS_SRC_ALPHA),checkGlError("glBlendFunc")}var d=null;if(this._maskNode){var v=new Rectangle;this._maskNode.getBoundingBox(v);var m=new Matrix;m.translate(1,1),m.scale(n.getWidth()/2,n.getHeight()/2),v=m._calculateBoundsRect(v),d=new r(Math.round(v.x),Math.round(v.y),Math.round(v.width),Math.round(v.height)),d.enable()}var g=i.BindScope(i.getById(this._textureId));gl.bindBuffer(gl.ARRAY_BUFFER,this._getVBO()),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(t),gl.STATIC_DRAW),gl.vertexAttribPointer(this._a_positionAndTexPoint,4,gl.FLOAT,!1,16,0),checkGlError("glVertexAttribPointer"),this._cmVBO||(this._cmVBO=gl.createBuffer()),gl.bindBuffer(gl.ARRAY_BUFFER,this._cmVBO),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(u),gl.STATIC_DRAW),gl.vertexAttribPointer(this._a_colorMulti,4,gl.FLOAT,!1,16,0),checkGlError("glVertexAttribPointer"),this._coVBO||(this._coVBO=gl.createBuffer()),gl.bindBuffer(gl.ARRAY_BUFFER,this._coVBO),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(a),gl.STATIC_DRAW),gl.vertexAttribPointer(this._a_colorOffset,4,gl.FLOAT,!1,16,0),checkGlError("glVertexAttribPointer"),gl.drawArrays(gl.TRIANGLES,0,e*6),checkGlError("glDrawArrays"),d!=null&&(d.disable(),delete d),this._objects=[],this._textureId=-1,this._blendMode=o.NONE,this._maskNode=null,p.unbind()}});return f}),herlock.define("module/view/flash/internal/renderer/RenderingSystem",["lib/Class","./SubImageRenderer","./SubImageRendererAlpha","./SubImageRendererColorTransform"],function(e,t,n,r){var i=e(Object,function(e,i){e.constructor=function(){i.constructor.apply(this,arguments),this._subImage=new t,this._subImageAlpha=new n,this._subImageColorTransform=new r,this._currentRenderer=this._subImage},e.begin=function(){},e.render=function(e){var t,n=e.colorTransform;n._isColorTransform()?t=this._subImageColorTransform:n._isAlphaTransform()?t=this._subImageAlpha:this._currentRenderer==this._subImageColorTransform?t=this._subImage:t=this._currentRenderer,this._currentRenderer!=t&&(this._currentRenderer.render(),this._currentRenderer=t);var r=this._currentRenderer.accept(e);if(r)return;this._currentRenderer.render(),this._currentRenderer.accept(e)},e.end=function(){this._currentRenderer!=null&&this._currentRenderer.render()}});return i.getInstance=function(){return this._instance||(this._instance=new i),this._instance},i}),herlock.define("module/view/flash/events/InteractiveObjectTouchEvent",["lib/Class","module/common/event/Event"],function(e,t){var n=e(t,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments);var e=arguments.length,n=arguments;this._touchPointID=e>3?n[3]:0,this._isPrimaryTouchPoint=e>4?n[4]:!1,this._localX=e>5?n[5]:0,this._localY=e>6?n[6]:0},e.isPrimaryTouchPoint={get:function(){return this._isPrimaryTouchPoint},set:function(e){this._isPrimaryTouchPoint=e}},e.localX={get:function(){return this._localX},set:function(e){this._localX=e}},e.localY={get:function(){return this._localY},set:function(e){this._localY=e}},e.touchPointID={get:function(){return this._touchPointID},set:function(e){this._touchPointID=e}},e.stageX={get:function(){if(this._hasStagePoint)return this._stagePoint.x;var e=this.target;return e.localToGlobal(new Point(this.localX,this.localY)).x}},e.stageY={get:function(){if(this._hasStagePoint)return this._stagePoint.y;var e=this.target;return e.localToGlobal(new Point(this.localX,this.localY)).y}},e._setStagePoint=function(e){return this._stagePoint=e,this._hasStagePoint=!0,this}});return n}),herlock.define("module/view/flash/display/Stage",["lib/Class","module/view/gl/IRenderable","module/view/gl/Viewport","./Sprite","../internal/renderer/RenderingNode","../internal/renderer/RenderingSystem","module/view/touch/TouchEventInfo","../events/InteractiveObjectTouchEvent"],function(e,t,n,r,i,s,o,u){var a=e(r,function(e,t){e.constructor=function(e,n){t.constructor.apply(this,arguments),this._stageWidth=e||100,this._stageHeight=n||100,this._layer=null,this._frameRate=60,this._quality=null,this._offscreenHandle=null,this._primaryTouchId=-1,this._touchPointerStateDictionary={},this._layerContentRenderObject=null},e.frameRate={get:function(){return this._frameRate},set:function(e){}},e.stageWidth={get:function(){return this._stageWidth},set:function(e){this._stageWidth=e,this._layer!=null&&this._layer._notifyResizeContent()}},e.stageHeight={get:function(){return this._stageHeight},set:function(e){this._stageHeight=e,this._layer!=null&&this._layer._notifyResizeContent()}},e.stage={get:function(){return this}},e.height={get:function(){}},e.width={get:function(){}},e.layer={get:function(){return this._layer}},e._getContentWidth=function(){return this.stageWidth},e._getContentHeight=function(){return this.stageHeight},e.getLayer=function(){return this._layer},e._onAddedTo=function(e){this._layer=e},e._onRemovedFrom=function(e){this._layer=NULL},e._glPrepare=function(e,t){this._layerContentRenderObject||(this._layerContentRenderObject=new l);var n={};this._layerContentRenderObject.root=DisplayObjectContainer.prototype._glPrepare.call(this,n);var r=new Matrix;return r.concat(this.getLayer()._getContentMatrix()),r.concat(this.getLayer()._getMatrix()),this._layerContentRenderObject.matrix._equal(r)||(this._layerContentRenderObject.matrix=r),this._layerContentRenderObject.colorTransform=t,this._layerContentRenderObject},e._notifyDrawFrame=function(){this._notifyOnEnterFrame(),this._drawVectorGraphics()},e._notifyResizeView=function(e,t){},e._dispatchTouchEvent=function(e){var t=e,n=t.getChangedPointers(),r=n.length;for(var i=0;i<r;i++)this._dispatchTouchEventWithChangedTouchPointer(t,n[i])},e._dispatchTouchEventWithChangedTouchPointer=function(e,t){var n=this._layer._getMatrix(),r=this._layer._getContentMatrix();r.concat(n),r.invert();var i=r.transformPoint(new Point(t.x,t.y)),s=this,a=s._hitTestStrictInternal(i);a||(a=this);var f=a,l=f.globalToLocal(i),h=[];h.push(f);var p=f.parent;while(p)h.unshift(p),p=p.parent;var d="";switch(e.getAction()){case o.DOWN:d="touchBegin";break;case o.MOVE:d="touchMove";break;case o.UP:d="touchEnd";break;case o.CANCEL:default:d="touchEnd"}Object.keys(this._touchPointerStateDictionary).length<=0&&(this._primaryTouchId=t.id);var v=this._primaryTouchId==t.id,m=(new u(d,!0,!0,t.id,v,l.x,l.y))._setStagePoint(i);m._setTarget(h[h.length-1]),h[h.length-1]._propagateEvent(m,h);var g=null,a=this._touchPointerStateDictionary[t.id];a&&(g=a,delete this._touchPointerStateDictionary[t.id]);switch(e.getAction()){case o.DOWN:var y=c.create(t.id,f,f);this._touchPointerStateDictionary[t.id]=y;var m=(new u("touchOver",!0,!0,t.id,v,l.x,l.y))._setStagePoint(i);m._setTarget(h[h.length-1]),h[h.length-1]._propagateEvent(m,h);var b=h.length;for(var w=0;w<b;w++){var m=(new u("touchRollOver",!0,!0,t.id,v,l.x,l.y))._setStagePoint(i);h[w].dispatchEvent(m)}break;case o.MOVE:var y=c.create(t.id,g&&g.beganFrom?g.beganFrom:null,f);this._touchPointerStateDictionary[t.id]=y;if(g&&g.overNow==f)break;var m=(new u("touchOut",!0,!0,t.id,v,l.x,l.y))._setStagePoint(i);m._setTarget(h[h.length-1]),h[h.length-1]._propagateEvent(m,h);var m=(new u("touchOver",!0,!0,t.id,v,l.x,l.y))._setStagePoint(i);m._setTarget(h[h.length-1]),h[h.length-1]._propagateEvent(m,h);var E=-1,s=f,S=[],x=[];if(g&&g.overNow){x=g.overNow._getNodesToRoot();var T=x.length;while(E==-1){S.push(s);for(var w=0;w<T;w++)if(x[w]==s){E=w;break}s=s.parent;if(!s)break}}if(E==-1)break;for(var w=E-1;w>=0;w--){var m=(new u("touchRollOut",!0,!0,t.id,v,l.x,l.y))._setStagePoint(i);x[w].dispatchEvent(m)}var N=S.length;for(var w=0;w<N;w++){var m=(new u("touchRollOver",!0,!0,t.id,v,l.x,l.y))._setStagePoint(i);S[w].dispatchEvent(m)}break;case o.UP:case o.CANCEL:default:var m=(new u("touchOut",!0,!0,t.id,v,l.x,l.y))._setStagePoint(i),C=[];if(g&&g.overNow){C.push(g.overNow);var p=g.overNow.parent;while(p)C.unshift(p),p=p.parent;m._setTarget(g.overNow)}var b=C.length;for(var w=0;w<b;w++){var m=(new u("touchRollOut",!0,!0,t.id,v,l.x,l.y))._setStagePoint(i);C[w].dispatchEvent(m)}if(e.getAction()!=o.CANCEL&&g&&g.beganFrom&&g.beganFrom===f){var m=(new u("touchTap",!0,!0,t.id,v,l.x,l.y))._setStagePoint(i);m._setTarget(h[h.length-1]),h[h.length-1]._propagateEvent(m,h)}this._primaryTouchId==t.id&&(this._primaryTouchId=-1)}},e.toString=function(){return'[object Stage stageWidth="'+this.stageWidth+'" stageHeight="'+this.stageHeight+'"]'}}),f=function(e){e=e||{},this.parent=e.parent||new i,this.offScreenRenderingRequests=e.offScreenRenderingRequests||[],this.renderingRequests=e.renderingRequests||[]};f.prototype={clone:function(){return new f(this)}};var l=e(t,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments),this.visitor=this.visitor=new f,this.visitor.parent=new i,this.visitor.offScreenRenderingRequests=[],this.visitor.renderingRequests=[],this.matrix=new Matrix,this.colorTransform=new ColorTransform,this.root=null},e.processData=function(){var e=new Matrix(1/n.getWidth(),0,0,1/n.getHeight(),0,0);e.scale(2,-2),e.translate(-1,1);var t=this.matrix.clone();t.concat(e),this.visitor.parent._matrix._getVersion()!==t._getVersion()?(this.visitor.parent.setMatrix(t),this.visitor.parent.concatenatedMatrix=this.visitor.parent.getMatrix(),this.visitor.parent.concatenatedMatrixIsUpdated=!0):(this.visitor.parent.setMatrix(t),this.visitor.parent.matrixIsUpdated=!1,this.visitor.parent.concatenatedMatrixIsUpdated=!1),this.visitor.offScreenRenderingRequests=[],this.visitor.renderingRequests=this.root.visit(this.visitor.clone())},e.renderOffscreen=function(){},e.render=function(){var e=s.getInstance();e.begin();var t=this.visitor.renderingRequests,n=t.length;for(var r=0;r<n;r++)e.render(t[r]);e.end()}}),c={create:function(e,t,n){return{pointerId:e,beganFrom:t,overNow:n}}};return a}),herlock.define("module/view/gl/tile/TextureImageInfo",["lib/Class"],function(e){var t=e(Object,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments),this.area=new Rectangle,this.reset()},e.textureObject=null,e.area=null,e.tiles=null,e.numOfTiles=null,e.resetTiles=function(e){this.numOfTiles=e,this.tiles!=null&&delete this.tiles,this.tiles=new Array(e)},e.clearTiles=function(){this.tiles!=null&&delete this.tiles,this.tiles=null,this.numOfTiles=0},e.reset=function(){for(var e=this.numOfTiles-1;e>=0;e--)this.tiles[e].client==this&&this.tiles[e].reset();this.textureObject=null,this.area.setEmpty(),this.clearTiles()},e.checkTileClients=function(){if(this.textureObject==null)return!1;var e=this.numOfTiles;while(--e>-1)if(this.tiles[e].client!=this)return!1;return!0},e.isEmpty=function(){return this.textureObject==null},e.getTextureObject=function(){return this.textureObject},e.onUse=function(){for(var e=this.numOfTiles-1;e>-1;--e)this.tiles[e].setDemand(1e4)}});return t}),herlock.define("module/view/gl/GLUtil",[],function(){function t(){checkGlError("- before"),this._maxTextureSize=gl.getParameter(gl.MAX_TEXTURE_SIZE),checkGlError("a getParameter"),this._maxVertexAttribs=gl.getParameter(gl.MAX_VERTEX_ATTRIBS),checkGlError("b getParameter"),this._maxVertexUniformVectors=gl.getParameter(gl.MAX_VERTEX_UNIFORM_VECTORS),checkGlError("c getParameter"),this._maxFragmentUniformVectors=gl.getParameter(gl.MAX_FRAGMENT_UNIFORM_VECTORS),checkGlError("d getParameter"),this._maxVaryingVectors=gl.getParameter(gl.MAX_VARYING_VECTORS),checkGlError("e getParameter"),this._maxVertexTextureImageUnits=gl.getParameter(gl.MAX_VARYING_VECTORS),checkGlError("f getParameter"),this._maxTextureImageUnits=gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS),checkGlError("g getParameter"),this._maxRenderBufferSize=gl.getParameter(gl.MAX_RENDERBUFFER_SIZE),checkGlError("h getParameter"),this._shaderVersion=gl.getParameter(gl.SHADING_LANGUAGE_VERSION),checkGlError("i getParameter"),this._vendor=gl.getParameter(gl.VENDOR),checkGlError("j getParameter"),this._renderer=gl.getParameter(gl.RENDERER),checkGlError("k getParameter"),this._version=gl.getParameter(gl.VERSION),checkGlError("l getParameter")}var e={getInfo:function(){return this._info||(this._info=new t),this._info},checkGlError:function(e){for(var t=gl.getError();t;t=gl.getError())console.error("ndk_gl after "+e+"() glError"),console.error("ndk_gl       error:"+t)}};return t.prototype=Object.create({},{maxTextureSize:{get:function(){return this._maxTextureSize}},maxVertexAttribs:{get:function(){return this._maxVertexAttribs}},maxVertexUniformVectors:{get:function(){return this._maxVertexUniformVectors}},maxFragmentUniformVectors:{get:function(){return this._maxFragmentUniformVectors}},maxVaryingVectors:{get:function(){return this._maxVaryingVectors}},maxVertexTextureImageUnits:{get:function(){return this._maxVertexTextureImageUnits}},maxTextureImageUnits:{get:function(){return this._maxTextureImageUnits}},maxRenderBufferSize:{get:function(){return this._maxRenderBufferSize}},shaderVersion:{get:function(){return this._shaderVersion}},vendor:{get:function(){return this._vendor}},renderer:{get:function(){return this._renderer}},version:{get:function(){return this._version}},getOptimumTextureSize:{value:function(){return this.maxTextureSize>=4096?2048:this.maxTextureSize}}}),e}),herlock.define("module/view/gl/tile/Tile",["lib/Class"],function(e){function n(e){this.texture._setTileDemand(this.offsetX,this.offsetY,e)}function r(){this.setDemand(0),this.client=null}var t={create:function(e){return{texture:e,index:-1,offsetX:0,offsetY:0,setDemand:n,client:null,reset:r}}};return t}),herlock.define("module/view/gl/tile/TileTextureObject",["lib/Class","../TextureObject","./Tile"],function(e,t,n){var r=64,i=1,s=e(t,function(e,t){e.constructor=function(e,i){t.constructor.apply(this,arguments),this._tiles=new Array(r*r),this._demands=new Array(r*r);var s=r*r;for(var o=0;o<s;o++)this._demands[o]=0;for(var o=0;o<s;o++){var u=this._tiles[o]=n.create(this);u.index=o,u.offsetX=o%r,u.offsetY=Math.floor(o/r)}this._workspace=new Uint8Array(4*Math.max(this.getWidth(),this.getHeight()))},e._search=function(e,t,n){var i=e*t;for(var s=0;s<r-(t-1);s++)for(var o=0;o<r-(e-1);o++){if(this._getTileDemand(o,s)>=n)continue;var u=!0;for(var a=0;a<i;a++){var f=a%e,l=Math.floor(a/e);u=u&&this._getTileDemand(o+f,s+l)<n;if(u!=1)break}if(u)return o+s*r}return-1},e.allocate=function(e,t,n){var s=this._coordToOffsetTileX(e.width+i*2),o=this._coordToOffsetTileY(e.height+i*2),u=this._search(s,o,n);if(u<0)return!1;t.textureObject=this,t.area.x=this._tileIndexToCoordX(u)+i,t.area.y=this._tileIndexToCoordY(u)+i,t.area.width=e.width,t.area.height=e.height;var a=u%r,f=Math.floor(u/r),l=s*o;t.resetTiles(l);for(var c=0;c<l;c++){var h=c%s,p=Math.floor(c/s),d=this._getTileByOffset(a+h,f+p);d.client=t,this._setTileDemand(a+h,f+p,1),t.tiles[c]=d}return!0},e.putImage=function(e,t,n,r,i){this.subImage2D(e,t-1,n,1,i.subarray(0,n*4)),this.subImage2D(e,t+r,n,1,i.subarray(n*4*(r-1)));var s=this._workspace,o=i,u=0;s[0]=o[0+u],s[1]=o[1+u],s[2]=o[2+u],s[3]=o[3+u];for(var a=r-1;a>=0;a--){var f=(a+1)*4,l=a*4;s[f+0]=o[0+n*l+u],s[f+1]=o[1+n*l+u],s[f+2]=o[2+n*l+u],s[f+3]=o[3+n*l+u]}s[(r+1)*4+0]=o[0+n*(r-1)*4+u],s[(r+1)*4+1]=o[1+n*(r-1)*4+u],s[(r+1)*4+2]=o[2+n*(r-1)*4+u],s[(r+1)*4+3]=o[3+n*(r-1)*4+u],this.subImage2D(e-1,t-1,1,r+2,s.subarray(0,(r+2)*4)),u=(n-1)*4,s[0]=o[0+u],s[1]=o[1+u],s[2]=o[2+u],s[3]=o[3+u];for(var a=r-1;a>=0;a--){var f=(a+1)*4,l=a*4;s[f+0]=o[0+n*l+u],s[f+1]=o[1+n*l+u],s[f+2]=o[2+n*l+u],s[f+3]=o[3+n*l+u]}s[(r+1)*4+0]=o[0+n*(r-1)*4+u],s[(r+1)*4+1]=o[1+n*(r-1)*4+u],s[(r+1)*4+2]=o[2+n*(r-1)*4+u],s[(r+1)*4+3]=o[3+n*(r-1)*4+u],this.subImage2D(e+n,t-1,1,r+2,s.subarray(0,(r+2)*4)),this.subImage2D(e,t,n,r,i)},e.onNextFrame=function(){var e=r*r;for(var t=0;t<e;t++)this._demands[t]-=25},e._tileIndexToCoordX=function(e){return e%r/r*this.getWidth()},e._tileIndexToCoordY=function(e){return Math.floor(e/r)/r*this.getHeight()},e._coordToOffsetTileX=function(e){return Math.ceil(e/this.getWidth()*r)},e._coordToOffsetTileY=function(e){return Math.ceil(e/this.getWidth()*r)},e._getTileByCoords=function(e,t){return this._tiles[this._coordToOffsetTileX(e)+this._coordToOffsetTileY(t)*r]},e._getTileByOffset=function(e,t){return this._tiles[e+t*r]},e._getTileDemand=function(e,t){return this._demands[e+t*r]},e._setTileDemand=function(e,t,n){this._demands[e+t*r]=n}});return s}),herlock.define("module/view/gl/tile/TileTextureManager",["lib/Class","../GLUtil","./TileTextureObject"],function(e,t,n){var r=e(Object,function(e,r){e.constructor=function(){r.constructor.apply(this,arguments),this._textureSize=t.getInfo().getOptimumTextureSize(),this._textures=[],this._imageTextures=[]},e.getTextureObjectById=function(e){for(var t=0;t<this._textures.length;t++)if(this._textures[t].getId()==e)return this._textures[t];return null},e.getTextureObjectByIndex=function(e){return this._textures.length<=e?null:this._textures[e]},e.getNumOfTixtures=function(){return this._textures.length},e.onNextFrame=function(){var e=this._textures.length;for(var t=0;t<e;t++)this._textures[t].onNextFrame()},e.allocateImageArea=function(e,t){if(e.width>this._textureSize||e.height>this._textureSize)return console.error("max image size: "+textureSize);var r=1e3,i=1e3,s=7e3,o=r,u=!1;while(t.area.isEmpty()){var a=this._imageTextures.length;for(var f=a-1;f>=0;f--){var l=this._imageTextures[f];u=l.allocate(e,t,o);if(u)break}if(u)break;o+=i;if(o>=s){console.log("nj alloc texture.");var l=new n(this._textureSize,this._textureSize);this._textures.push(l),this._imageTextures.push(l),o=r}}},e.reset=function(){var e=this._textures.size();for(var t=0;t<e;t++){var n=this._textures[t];delete n}this._textures.clear(),this._imageTextures.clear()}});return r.getInstance=function(){return this._singleton||(this._singleton=new r),this._singleton},r}),herlock.define("module/view/gl/tile/SubImageHandle",["lib/Class","module/view/geom/Rectangle","./TextureImageInfo","./TileTextureManager"],function(e,t,n,r){var i=e(Object,function(e,i){e.constructor=function(){i.constructor.apply(this,arguments),this._client=null,this._renderingInfo=new n,this._rect=new t},e.set=function(e){this._free(),this._client=e,this._client&&(this._rect.width=this._client.width(),this._rect.height=this._client.height())},e.getTextureImageInfo=function(){return this._check()!=1&&(this._allocate(),this._renderingInfo.isEmpty()&&console.error("getTextureImageInfo.allocate texture failed")),this._renderingInfo.onUse(),this._renderingInfo},e.refTextureImageInfo=function(){return this._renderingInfo},e.isEmpty=function(){return this._rect.isEmpty()},e.isNotEmpty=function(){return this._rect.isEmpty()!=1},e.reset=function(){this._rect.setEmpty(),this._renderingInfo.reset()},e._check=function(){return this._renderingInfo.checkTileClients()},e._free=function(){this._renderingInfo.reset()},e._allocate=function(){this._free(),r.getInstance().allocateImageArea(this._rect,this._renderingInfo),this._renderingInfo.getTextureObject()==null&&console.error("ImageTextureHandle::allocate texture failed");if(this._client){var e=this._renderingInfo.area;this._renderingInfo.textureObject.putImage(e.x,e.y,e.width,e.height,this._client.getData())}}});return i}),herlock.define("module/view/flash/display/BitmapData",["lib/Class","module/graphics/BitmapProxy","module/view/gl/tile/SubImageHandle"],function(e,t,n){function r(e){return typeof e=="number"}function i(e){return typeof e=="boolean"}var s=e(Object,function(e,s){e.constructor=function(){s.constructor.apply(this,arguments);var e=arguments,o=arguments.length,u=null;if(o>=2&&r(e[0])&&r(e[1])){var a=e[0],f=e[1],l=2046;if(a>=l||f>=l)throw new Error("Argument Error. over limit size!! please 2046 > size.");u=t.create(a,f);var c=!0,h=4294967295;o>=3&&i(e[2])&&(c=e[2]),o>=4&&r(e[3])&&(h=e[3]);var p=u.getCanvas();p.setFillColor(h),p.fillRect(0,0,a,f)}else{if(!(o>=1&&e[0].isInstanceOf&&e[0].isInstanceOf(Image)))throw new Error("Argument Error");u=e[0]._getBitmap()}this._bitmapProxy=u,this._textureImageHandle=new n,this._textureImageHandle.set(u)},e.width={get:function(){return this._bitmapProxy?this._bitmapProxy.width():0}},e.height={get:function(){return this._bitmapProxy?this._bitmapProxy.height():0}},e.transparent={get:function(){return!0}},e.rect={get:function(){return new Rectangle(0,0,this.width,this.height)}},e.dispose=function(){this._bitmapProxy=null,this._textureImageHandle.reset()},e._notifyEnterFrame=function(){},e._notifyFrameConstructed=function(){},e._notifyExecuteFrameScript=function(){},e._notifyExitFrame=function(){},e._notifyDrawVectorGraphics=function(){},e._glPrepare=function(){if(this._textureImageHandle.isEmpty()||this._textureImageHandle.isEmpty())return;this._textureImageHandle.getTextureImageInfo()},e._notifyUpdateForBitmap=function(){},e._getTextureImageInfo=function(){return this._textureImageHandle.getTextureImageInfo()},e._getTextureImageHandle=function(){return this._textureImageHandle},e.toString=function(){return'[object BitmapData width="'+this.width+'" height="'+this.height+'"]'}});return s}),herlock.define("module/view/flash/internal/renderer/SubImageRenderingObject",["lib/Class"],function(e){var t=e(Object,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments),this.vertexes=new Array(24)},e.textureId=-1,e.textureHandle=null,e.colorTransform=null,e.blendMode=null,e.maskNode=null,e.vertexes=null,e.getTextureId=function(){return this.textureId}});return t}),herlock.define("module/view/flash/display/Bitmap",["lib/Class","./DisplayObject","module/view/flash/internal/renderer/RenderingNode","module/view/flash/internal/renderer/SubImageRenderingObject","module/view/gl/TextureObject"],function(e,t,n,r,i){var s=e(t,function(e,n){e.constructor=function(e,t,r,i){n.constructor.apply(this,arguments);var s=arguments.length;this._bitmapData=e,this._pixelSnapping=s>1?t:!1,this._smoothing=s>2?r:!1,this._clippingRect=s>3?i:new Rectangle},e.bitmapData={get:function(){return this._bitmapData},set:function(e){this._bitmapData!=null&&(this._bitmapData=null),e!=null&&(this._bitmapData=e),this._requestCalcNaturalRect()}},e.setClippingRect=function(e){this._clippingRect=e,this._requestCalcNaturalRect()},e._calculateNaturalRect=function(){if(this.bitmapData==null){this._naturalRect.setEmpty();return}if(this._clippingRect.isEmpty()){this._naturalRect.width=this.bitmapData.width,this._naturalRect.height=this.bitmapData.height;return}this._naturalRect.width=this._clippingRect.width,this._naturalRect.height=this._clippingRect.height},e._glPrepare=function(e){var n=this._getRenderingNode();n.children=[];if(this.bitmapData==null)return t.prototype._glPrepare.call(this,e);this.bitmapData._glPrepare(),n.scale9Grid=this.scale9Grid,n.clippingRect=this._clippingRect,n.textureImageHandle=this.bitmapData._getTextureImageHandle();var r=n.textureImageHandle.getTextureImageInfo();return n.textureId=r.getTextureObject().getId(),t.prototype._glPrepare.call(this,e)},e._createRenderingNode=function(){return new o},e.toString=function(){return'[object Bitmap name="'+this.name+'"]'}}),o=e(n,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments),this._renderingObjects=[new r,new r,new r,new r,new r,new r,new r,new r,new r]},e.clippingRect=null,e.textureImageHandle=null,e.textureId=null,e.scale9Grid=null,e.setMatrix=function(e){t.setMatrix.call(this,e)},e.visit=function(e){if(!this.textureImageHandle||this.textureImageHandle.isEmpty())return;if(!this._visible||!e.parent.concatenatedVisible){n.prototype.visit.call(this,e);return}this.scale9Grid.isEmpty()&&n.prototype.visit.call(this,e);var t=this.textureImageHandle.getTextureImageInfo(),r=i.getById(this.textureId),s=this.concatenatedMatrix.clone(),o=r.getWidth(),u=r.getHeight();if(this.scale9Grid.isEmpty()){var a=this._renderingObjects[0],f=t.area.clone();a.textureHandle=this.textureImageHandle,a.textureId=this.textureId,a.blendMode=this.concatenatedBlendMode,a.maskNode=this.concatenatedMask,a.colorTransform=this.concatenatedColorTransform,this.clippingRect.isEmpty()!==!0&&(f.x+=this.clippingRect.x,f.y+=this.clippingRect.y,f.width=this.clippingRect.width,f.height=this.clippingRect.height);var l=[s.transformPoint(new Point(0,0)),s.transformPoint(new Point(0,f.height)),s.transformPoint(new Point(f.width,0)),s.transformPoint(new Point(f.width,f.height))];return a.vertexes[0]=l[0].x,a.vertexes[1]=l[0].y,a.vertexes[2]=f.left/o,a.vertexes[3]=f.top/u,a.vertexes[4]=l[1].x,a.vertexes[5]=l[1].y,a.vertexes[6]=f.left/o,a.vertexes[7]=f.bottom/u,a.vertexes[8]=l[2].x,a.vertexes[9]=l[2].y,a.vertexes[10]=f.right/o,a.vertexes[11]=f.top/u,a.vertexes[12]=l[1].x,a.vertexes[13]=l[1].y,a.vertexes[14]=f.left/o,a.vertexes[15]=f.bottom/u,a.vertexes[16]=l[3].x,a.vertexes[17]=l[3].y,a.vertexes[18]=f.right/o,a.vertexes[19]=f.bottom/u,a.vertexes[20]=l[2].x,a.vertexes[21]=l[2].y,a.vertexes[22]=f.right/o,a.vertexes[23]=f.top/u,[a]}var c=0,h=t.area.width,p=t.area.height,d=0;this.clippingRect.isEmpty()!=1&&(c=0,h=this.clippingRect.width,p=this.clippingRect.height,d=0);var v=this.scale9Grid.top,m=this.scale9Grid.right,g=this.scale9Grid.bottom,y=this.scale9Grid.left,b=(h-d)*this.getMatrix()._getScaleX()-(y-d)-(h-m),w=(p-c)*this.getMatrix()._getScaleY()-(v-c)-(p-g),E=new Matrix,S=new Matrix;E.scale(b/this.scale9Grid.width,1),S.scale(1,w/this.scale9Grid.height);var x=[new Rectangle,new Rectangle,new Rectangle,new Rectangle,new Rectangle,new Rectangle,new Rectangle,new Rectangle,new Rectangle],T=[new Matrix,new Matrix,new Matrix,new Matrix,new Matrix,new Matrix,new Matrix,new Matrix,new Matrix],N=x[0],C=x[1],k=x[2],L=x[3],A=x[4],O=x[5],M=x[6],_=x[7],D=x[8];N._set(d,c,y-d,v-c),C._set(y,c,m-y,v-c),k._set(m,c,h-m,v-c),L._set(d,v,y-d,g-v),A._set(y,v,m-y,g-v),O._set(m,v,h-m,g-v),M._set(d,g,y-d,p-g),_._set(y,g,m-y,p-g),D._set(m,g,h-m,p-g);var P=this.getMatrix().clone();P._setScaleX(1),P._setScaleY(1),P.concat(e.parent.concatenatedMatrix);var H=P,B=T[0];B.concat(H);var j=T[1];j.concat(E),j.translate(C.x,C.y),j.concat(H);var F=T[2];F.translate(C.x+b,k.y),F.concat(H);var I=T[3];I.concat(S),I.translate(L.x,L.y),I.concat(H);var q=T[4];q.concat(E),q.concat(S),q.translate(A.x,A.y),q.concat(H);var R=T[5];R.concat(S),R.translate(A.x+b,O.y),R.concat(H);var U=T[6];U.translate(L.x,L.y+w),U.concat(H);var z=T[7];z.concat(E),z.translate(_.x,A.y+w),z.concat(H);var W=T[8];W.translate(_.x+b,O.y+w),W.concat(H);if(!this.clippingRect.isEmpty()){var X=new Point(this.clippingRect.x,this.clippingRect.y);N.offsetPoint(X),C.offsetPoint(X),k.offsetPoint(X),L.offsetPoint(X),A.offsetPoint(X),O.offsetPoint(X),M.offsetPoint(X),_.offsetPoint(X),D.offsetPoint(X)}n.prototype.visit.call(this,e);var V=[];for(var $=0;$<9;$++){var a=this._renderingObjects[$],s=T[$],J=x[$];if(J.isEmpty())continue;var f=t.area.clone();a.textureHandle=this.textureImageHandle,a.textureId=this.textureId,a.blendMode=this.blendMode,a.maskNode=this.mask,a.colorTransform=this.concatenatedColorTransform,J.isEmpty()!=1&&(f.x+=J.x,f.y+=J.y,f.width=J.width,f.height=J.height);var l=[s.transformPoint(new Point(0,0)),s.transformPoint(new Point(0,f.height)),s.transformPoint(new Point(f.width,0)),s.transformPoint(new Point(f.width,f.height))];a.vertexes[0]=l[0].x,a.vertexes[1]=l[0].y,a.vertexes[2]=f.left/o,a.vertexes[3]=f.top/u,a.vertexes[4]=l[1].x,a.vertexes[5]=l[1].y,a.vertexes[6]=f.left/o,a.vertexes[7]=f.bottom/u,a.vertexes[8]=l[2].x,a.vertexes[9]=l[2].y,a.vertexes[10]=f.right/o,a.vertexes[11]=f.top/u,a.vertexes[12]=l[1].x,a.vertexes[13]=l[1].y,a.vertexes[14]=f.left/o,a.vertexes[15]=f.bottom/u,a.vertexes[16]=l[3].x,a.vertexes[17]=l[3].y,a.vertexes[18]=f.right/o,a.vertexes[19]=f.bottom/u,a.vertexes[20]=l[2].x,a.vertexes[21]=l[2].y,a.vertexes[22]=f.right/o,a.vertexes[23]=f.top/u,V.push(a)}return V},e.getBoundingBox=function(e){var t=this.textureImageHandle.getTextureImageInfo(),n=this.concatenatedMatrix,r=t.area.clone();this.clippingRect.isEmpty()!==!0&&(r.width=this.clippingRect.width,r.height=this.clippingRect.height),r.x=0,r.y=0;var i=n._calculateBoundsRect(r),s=e.union(i);e._set(s.x,s.y,s.width,s.height)}});return s}),herlock.define("module/view/flash/text/TextFormat",["lib/Class"],function(e){var t=e(Object,function(e,t){e.constructor=function(e,n,r,i,s,o,u,a,f,l,c,h,p){t.constructor.apply(this,arguments);var d=arguments.length;d>=1&&(this.font=e),d>=2&&(this.size=n),d>=3&&(this.color=r),d>=4&&(this.bold=i),d>=5&&(this.italic=s),d>=6&&(this.underline=o),d>=7&&(this.url=u),d>=8&&(this.target=a),d>=9&&(this.align=f),d>=10&&(this.leftMargin=l),d>=11&&(this.rightMargin=c),d>=12&&(this.indent=h),d>=13&&(this.leading=p)},e.align="left",e.blockIndent=0,e.bold=!1,e.color=0,e.font="",e.indent=0,e.italic=!1,e.kerning=!1,e.leading=0,e.leftMargin=0,e.letterSpacing=0,e.rightMargin=0,e.size=12,e.underline=!1,e.toString=function(){return"[object TextFormat]"}});return t}),herlock.define("module/view/flash/text/TextFieldAutoSize",[],function(){var e={NONE:"none",CENTER:"center",LEFT:"left",RIGHT:"right"};return e}),herlock.define("module/view/flash/text/TextFormatAlign",[],function(){var e={LEFT:"left",CENTER:"center",RIGHT:"right",JUSTIFY:"justify"};return e}),herlock.define("module/view/flash/text/TextField",["lib/Class","../display/InteractiveObject","./TextFormat","./TextFieldAutoSize","./TextFormatAlign","module/graphics/BitmapProxy","module/view/flash/internal/renderer/RenderingNode","module/view/flash/internal/renderer/SubImageRenderingObject","module/view/gl/TextureObject","module/view/gl/tile/SubImageHandle"],function(e,t,n,r,i,s,o,u,a,f){function c(e,t){return parseInt(t*255)*16777216+e}var l=2,h=e(t,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments),this._text="",this._drawTextRequested=!0,this._calcTextRequested=!0,this._bitmapProxy=null,this._textureImageHandle=null,this._autoSize=r.NONE,this._background=!1,this._backgroundColor=16777215,this._border=!1,this._borderColor=0,this._defaultTextFormat=null,this._multiline=!1,this._wordWrap=!1,this._scrollH=0,this._scrollV=0,this._maxScrollH=0,this._maxScrollV=0,this._maxChars=0,this._bottomScrollV=0,this._naturalRect.height=100,this._naturalRect.width=100,this._defaultTextFormat=new n,this._bitmapProxy=s.create(10,10),this._textureImageHandle=new f},e.autoSize={get:function(){return this._autoSize},set:function(e){if(this._autoSize==e)return;this._autoSize=e,this._requestCalcNaturalRect()}},e.background={get:function(){return this._background},set:function(e){if(this._background==e)return;this._background=e,this._requestCalcAndDrawText()}},e.backgroundColor={get:function(){return this._backgroundColor},set:function(e){if(this._backgroundColor==e)return;this._backgroundColor=e,this._requestCalcAndDrawText()}},e.border={get:function(){return this._border},set:function(e){if(this._border==e)return;this._border=e,this._requestCalcAndDrawText()}},e.borderColor={get:function(){return this._borderColor},set:function(e){if(this._borderColor==e)return;this._borderColor=e,this._requestCalcAndDrawText()}},e.bottomScrollV={get:function(){return this._bottomScrollV}},e.defaultTextFormat={get:function(){return this._defaultTextFormat},set:function(e){this._defaultTextFormat!=null&&(delete this._defaultTextFormat,this._defaultTextFormat=null),this._defaultTextFormat=e,this._requestCalcAndDrawText()}},e.length={get:function(){return this._text.length}},e.maxChars={get:function(){return this._maxChars},set:function(e){this._=e}},e.maxScrollH={get:function(){return this._maxScrollH}},e.maxScrollV={get:function(){return this._maxScrollV}},e.multiline={get:function(){return this._multiline},set:function(e){if(this._multiline==e)return;this._multiline=e,this._requestCalcAndDrawText()}},e.numLines={get:function(){return this._calcTextRequested&&this._calcText(),this._numOfLines}},e.scrollH={get:function(){return this._scrollH},set:function(e){this._scrollH=e,this._requestCalcAndDrawText()}},e.scrollV={get:function(){return this._scrollV},set:function(e){this._scrollV=e,this._requestCalcAndDrawText()}},e.text={get:function(){return this._text},set:function(e){if(this._text===e)return;this._text=e,this._requestCalcAndDrawText(),this._requestCalcNaturalRect()}},e.textColor={get:function(){return this._defaultTextFormat.color},set:function(e){this._defaultTextFormat.color=e,this._requestCalcAndDrawText()}},e.textHeight={get:function(){return this._calcTextRequested&&this._calcText(),this._textRect.h}},e.textWidth={get:function(){return this._calcTextRequested&&this._calcText(),this._textRect.w}},e.type={get:function(){return this._type},set:function(e){this._type=e}},e.wordWrap={get:function(){return this._wordWrap},set:function(e){this._wordWrap=e,this._requestCalcAndDrawText()}},e.appendText=function(e){this._text+=e,this._requestCalcAndDrawText()},e.getTextFormat=function(){return this._defaultTextFormat},e.setTextFormat=function(e){this._defaultTextFormat&&(this._defaultTextFormat=null),this._defaultTextFormat=e,this._requestCalcAndDrawText()},e.height={get:function(){return this._getBoundsRect().height},set:function(e){if(this._naturalRect.height==e)return;this._naturalRect.height=e,this._requestCalcNaturalRect()}},e.width={get:function(){return this._getBoundsRect().width},set:function(e){if(this._naturalRect.width==e)return;this._naturalRect.width=e,this._requestCalcNaturalRect()}},e._requestCalcAndDrawText=function(){this._drawTextRequested=!0,this._calcTextRequested=!0},e._drawVectorGraphics=function(){},e._glPrepare=function(e){this._drawTextRequested&&(this._drawText(),this._textureImageHandle.set(this._bitmapProxy));if(this._textureImageHandle.isEmpty())return null;var n=this._getRenderingNode(),r=this._textureImageHandle.getTextureImageInfo();return n.textureImageHandle=this._textureImageHandle,n.textureId=r.getTextureObject().getId(),t._glPrepare.call(this,e)},e._calculateNaturalRect=function(){this._calcTextRequested&&this._calcText();var e=this._defaultTextFormat;switch(this._autoSize){case r.NONE:break;case r.LEFT:var t=new Rectangle;t.width=this._textRect.width+l*2+this._defaultTextFormat.leftMargin+this._defaultTextFormat.blockIndent+this._defaultTextFormat.rightMargin,t.height=this._textRect.height+l*2,this._naturalRect=t;break;case r.CENTER:var n=this._naturalRect.width,t=new Rectangle;t.width=this._textRect.width+l*2+this._defaultTextFormat.leftMargin+this._defaultTextFormat.blockIndent+this._defaultTextFormat.rightMargin,t.height=this._textRect.height+l*2,this._naturalRect=t,this.x=this.x+(n-t.width)/2;break;case r.RIGHT:var n=this._naturalRect.width,t=new Rectangle;t.width=this._textRect.width+l*2+this._defaultTextFormat.leftMargin+this._defaultTextFormat.blockIndent+this._defaultTextFormat.rightMargin,t.height=this._textRect.height+l*2,this._naturalRect=t,this.x=this.x+(n-t.width)}},e._requestCalcNaturalRect=function(e){if(e)return;this._requestCalcAndDrawText(),t._requestCalcNaturalRect.call(this,e)},e._drawText=function(){var e=this._getMatrix();if(e._getScaleX()==0||e._getScaleY()==0)return;var t=this._getNaturalRect(),n=new Rectangle(0,0,e._getScaleX()*t.width,e._getScaleY()*t.height);this._drawTextRequested=!1;if(!this._bitmapProxy||n.width!=this._bitmapProxy.width()||n.height!=this._bitmapProxy.height())this._bitmapProxy=s.create(n.width,n.height);var r=this._bitmapProxy.getCanvas();this._background?(r.setFillColor(c(this._backgroundColor,1)),r.fillRect(0,0,this._bitmapProxy.width(),this._bitmapProxy.height())):r.clear(),this._border&&(r.setStrokeColor(c(this._borderColor,1)),r.strokeRect(0,0,this._bitmapProxy.width(),this._bitmapProxy.height())),r.setFillColor(c(this._defaultTextFormat.color,1)),r.setFontSize(this._defaultTextFormat.size*e._getScaleY()),r.setLetterSpacing(this._defaultTextFormat.letterSpacing);var o=this._calcTextLinePositions(),u=r.getFontMetrics(),a=u.ascent,f=u.descent,h=this._defaultTextFormat.leading,p=l+this._defaultTextFormat.leftMargin+this._defaultTextFormat.blockIndent,d=l,v=o.length;for(var m=0;m<v;m+=2){var g=o[m],y=o[m+1];if(g<0)continue;var b=this.text.substring(g,y+1);p=l+this._defaultTextFormat.leftMargin+this._defaultTextFormat.blockIndent;if(m==0||o[m-1]+1!=g)p+=this._defaultTextFormat.indent;switch(this._defaultTextFormat.align){case i.LEFT:break;case i.CENTER:var w=r.measureText(b);p+=(n.width-p-this._defaultTextFormat.rightMargin-w)/2;break;case i.RIGHT:var w=r.measureText(b);p+=n.width-p-this._defaultTextFormat.rightMargin-w;break;case i.JUSTIFY:}d=m/2*(-a+f+h),r.fillText(p,d,b)}},e._calcText=function(){calcTextRequested=!1;var e=this._getMatrix(),t=this._calcTextLinePositions(),n=this._bitmapProxy.getCanvas();n.setFontSize(this._defaultTextFormat.size*e._getScaleY()),n.setLetterSpacing(this._defaultTextFormat.letterSpacing),this._textRect=new Rectangle;if(this._wordWrap)this._textRect.width=this._naturalRect.width-(l*2+this._defaultTextFormat.leftMargin+this._defaultTextFormat.blockIndent+this._defaultTextFormat.rightMargin);else{var r=t.length;for(var i=0;i<r;i+=2){var s=t[i],o=t[i+1];if(s<0)continue;var u=this._text.substring(s,o+1),a=n.measureText(u);this._textRect.width<a&&(this._textRect.width=a)}}var f=n.getFontMetrics(),c=f.ascent,h=f.descent,p=this._defaultTextFormat.leading,d=t.length/2;this._textRect.height=(-c+h)*d+p*(d-1)},e._calcTextLinePositions=function(){var e=this._text,t=[];t.push(0);var n;n=0;for(;;){var r=e.indexOf("\r",n);if(r==-1)break;var i=r;i+1<e.length&&e.charAt(i+1)=="\n"?(t.push(i-1),t.push(i+2)):(t.push(i-1),t.push(i+1)),n=r+1}n=0;for(;;){var r=e.indexOf("\n",n);if(r==-1)break;var i=r;i-1>=0&&e.charAt(i-1)!="\r"&&(t.push(i-1),t.push(i+1)),n=r+1}t.push(e.length-1),t.sort(function(e,t){return e-t});if(this._wordWrap!=1)return t;var s=this._getConcatenatedMatrix(),o=new Rectangle(l,l,-l*2+s._getScaleX()*this._naturalRect.width-this._defaultTextFormat.leftMargin-this._defaultTextFormat.blockIndent-this._defaultTextFormat.rightMargin,-l*2+s._getScaleY()*this._naturalRect.height),u=this._bitmapProxy.getCanvas();u.setFontSize(this._defaultTextFormat.size*s._getScaleY()),u.setLetterSpacing(this._defaultTextFormat.letterSpacing);var a=t.slice(),f=0;while(f<a.length){var c=a[f];f++,c==-1&&(c=0);var h=a[f];f<a.length&&f++;var p=h-c+1,d=e.substring(c,h+1),v=u.breakText(d,o.width-this._defaultTextFormat.indent);while(v<p){t.push(c+v-1),t.push(c+v),c+=v,p=h-c+1;var d=e.substring(c,h+1);v=u.breakText(d,o.width);if(v==p)break}}return t.sort(function(e,t){return e-t}),t},e._createRenderingNode=function(){return new p},e.toString=function(){return'[object TextField name="'+this.name+'"]'}}),p=e(o,function(e,t){e.textureImageHandle,e.textureId,e.object,e.constructor=function(){t.constructor.call(this),this.object=new u},e.visit=function(e){if(this.textureImageHandle.isEmpty())return;o.prototype.visit.call(this,e);if(!this.concatenatedVisible)return;var t=this.object;t.textureHandle=this.textureImageHandle,t.textureId=this.textureId,t.blendMode=this.concatenatedBlendMode,t.colorTransform=this.concatenatedColorTransform,t.maskNode=this.concatenatedMask;var n=this.textureImageHandle.getTextureImageInfo(),r=a.getById(this.textureId),i=this.concatenatedMatrix,s=r.getWidth(),u=r.getHeight(),f=n.area;return points=[i.transformPoint(new Point(0,0)),i.transformPoint(new Point(0,f.height)),i.transformPoint(new Point(f.width,0)),i.transformPoint(new Point(f.width,f.height))],t.vertexes[0]=points[0].x,t.vertexes[1]=points[0].y,t.vertexes[2]=f.left/s,t.vertexes[3]=f.top/u,t.vertexes[4]=points[1].x,t.vertexes[5]=points[1].y,t.vertexes[6]=f.left/s,t.vertexes[7]=f.bottom/u,t.vertexes[8]=points[2].x,t.vertexes[9]=points[2].y,t.vertexes[10]=f.right/s,t.vertexes[11]=f.top/u,t.vertexes[12]=points[1].x,t.vertexes[13]=points[1].y,t.vertexes[14]=f.left/s,t.vertexes[15]=f.bottom/u,t.vertexes[16]=points[2].x,t.vertexes[17]=points[2].y,t.vertexes[18]=f.right/s,t.vertexes[19]=f.top/u,t.vertexes[20]=points[3].x,t.vertexes[21]=points[3].y,t.vertexes[22]=f.right/s,t.vertexes[23]=f.bottom/u,[t]}});return h}),herlock.define("module/view/flash/flash",["./display/DisplayObject","./display/InteractiveObject","./display/DisplayObjectContainer","./display/Sprite","./display/Stage","./display/BitmapData","./display/Bitmap","./text/TextField","./text/TextFieldAutoSize","./text/TextFormat","./geom/Transform","./events/InteractiveObjectTouchEvent"],function(e,t,n,r,i,s,o,u,a,f,l,c){var h={installTo:function(h){h.DisplayObject=e,h.InteractiveObject=t,h.DisplayObjectContainer=n,h.Sprite=r,h.Stage=i,h.BitmapData=s,h.Bitmap=o,h.TextField=u,h.TextFieldAutoSize=a,h.TextFormat=f,h.Transform=l,h.InteractiveObjectTouchEvent=c},initJs:function(e){e.Event.ENTER_FRAME="enterFrame",e.Event.EXIT_FRAME="exitFrame"}};return h}),herlock.define("module/view/geom/geom",["./Point","./Rectangle","./Matrix","./ColorTransform"],function(e,t,n,r){var i={installTo:function(i){i.Point=e,i.Rectangle=t,i.Matrix=n,i.ColorTransform=r},initJs:function(e){}};return i});var gl;window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame,function(){var e=document.createElement("div").style,t={transform:"webkitTransform"in e?"webkitTransform":"MozTransform"in e?"MozTransform":"transform",transformOrigin:"webkitTransformOrigin"in e?"webkitTransformOrigin":"MozTransformOrigin"in e?"MozTransformOrigin":"transformOrigin"};if("transformOrigin"in e)return;var n={};for(var r in t)(function(e,t){n[e]={get:function(){return this[t]},set:function(e){this[t]=e}}})(r,t[r]);Object.defineProperties(CSSStyleDeclaration.prototype,n)}(),herlock.define("module/view/NJView",["lib/Class","module/NJModule","./window/window","./layer/Layer","./image/Image","./flash/flash","./geom/geom","module/view/gl/Viewport","./geom/Rectangle","module/view/gl/Shader","module/view/touch/TouchEventInfo"],function(e,t,n,r,i,s,o,u,a,f,l){function w(e){y=new a(e.getViewLeft(),e.getViewTop(),e.getViewWidth(),e.getViewHeight()),b=Math.min(e.getViewWidth(),e.getViewHeight())}function E(e){p==null&&(p=new f,p.setVertexShaderCode("attribute highp vec4 a_pos;attribute vec4 a_col;varying vec4 v_col;void main(void) {  gl_Position = a_pos;  v_col = a_col;  gl_PointSize = 50.0;}"),p.setFragmentShaderCode("varying mediump vec4 v_col;void main (void) {  gl_FragColor = v_col;}"),p.build(),d=p.getAttributeLocation("a_pos"),v=p.getAttributeLocation("a_col"),p.activate(),gl.enableVertexAttribArray(d),checkGlError("glEnableVertexAttribArray"),gl.enableVertexAttribArray(v),checkGlError("glEnableVertexAttribArray")),gl.disable(gl.SCISSOR_TEST),checkGlError("glDisable"),gl.clear(gl.COLOR_BUFFER_BIT);var t=new u(y.x+(y.width-b)/2,y.y+(y.height-b)/2,b,b),n=u.BindScope(t),r=12,i=new Array(7*r);for(var s=0;s<r;s++){i[s*7+0]=.5*Math.cos((s-m)*h*2/r),i[s*7+1]=.5*Math.sin((s-m)*h*2/r),i[s*7+2]=0;var o=(r-s)/r*((r-s)/r);i[s*7+3]=o,i[s*7+4]=o,i[s*7+5]=o,i[s*7+6]=1}g||(g=gl.createBuffer()),gl.bindBuffer(gl.ARRAY_BUFFER,g),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(i),gl.STATIC_DRAW),p.activate(),gl.vertexAttribPointer(d,3,gl.FLOAT,!1,28,0),checkGlError("glVertexAttribPointer"),gl.vertexAttribPointer(v,4,gl.FLOAT,!1,28,12),checkGlError("glVertexAttribPointer"),gl.drawArrays(gl.POINTS,0,r),m++,n.unbind()}var c=e(t,function(e,t){e.constructor=function(e,n,r){t.constructor.apply(this,arguments),this._container=e,this._width=n,this._height=r,this._layers=[],this._canvas=document.createElement("canvas"),this._container.appendChild(this._canvas),this._canvas.width=n,this._canvas.height=r,gl=this._canvas.getContext("experimental-webgl",{alpha:!1}),gl.clearColor(0,0,0,1);var i=this;requestAnimationFrame(function(){i._onDrawFrame(),requestAnimationFrame(arguments.callee)});var s=!1,o=function(e){var t,n=!0;switch(e.type){case"mousedown":s=!0,t=l.DOWN;break;case"mousemove":if(!s)return;t=l.MOVE;break;case"mouseup":s=!1,t=l.UP,n=!1;break;case"mouseleave":if(!s)return;s=!1,t=l.CANCEL,n=!1}var r=new l(t);if(e.type.indexOf("mouse")!==-1){var o=e.offsetX,u=e.offsetY;if("offsetX"in e!=1){o=e.layerX-e.currentTarget.offsetLeft,u=e.layerY-e.currentTarget.offsetTop;if(this.style.transform!==""){var a={x:o,y:u},f=this.style.transform,c=[];f.split(",").forEach(function(e){c.push(parseFloat(e))}),o=a.x*c[0]+a.y*c[2]+1*c[4],u=a.x*c[1]+a.y*c[3]+1*c[5]}}r.addTouchPoint("mouse",o,u,!0,n)}i._notifyTouch(r)};this._canvas.addEventListener("mousemove",o),this._canvas.addEventListener("mouseup",o),this._canvas.addEventListener("mousedown",o),this._canvas.addEventListener("mouseleave",o)},e.getName=function(){return"View"},e.installTo=function(e){n.installTo(e,this),e.Layer=r,e.Image=i,s.installTo(e),o.installTo(e)},e.initJs=function(e){n.initJs(e),s.initJs(e),o.initJs(e)},e.start=function(){},e.reset=function(){},e.addLayer=function(e){return this.addLayerAt(e,this._layers.length)},e.addLayerAt=function(e,t){var n=e.isInstanceOf(r)?e:new r(e);return this.getLayerIndex(n)!=-1&&this.removeLayer(n),this._layers.splice(t,0,n),n._addedTo(this),n},e.getLayerAt=function(e){return this._layers[e]},e.getLayerIndex=function(e){return this._layers.indexOf(e)},e.removeLayer=function(e){return this.removeLayerAt(this._layers.indexOf(e))},e.removeLayerAt=function(e){var t=this.getLayerAt(e);return this._layers.splice(e,1),t},e.getViewWidth=function(){return this._width},e.getViewHeight=function(){return this._height},e.getViewTop=function(){return 0},e.getViewLeft=function(){return 0},e._onDrawFrame=function(){var e=this._glPrepare();gl.clear(gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT),checkGlError("glClear"),this._glRender(e),this._notifyDrawFrame()},e._glPrepare=function(){if(this._layers.length<=0)return w(this);var e=this._layers.length,t=[];for(var n=0;n<e;n++){var r=this._layers[n]._glPrepare();r&&t.push(r)}return t},e._glRender=function(e){if(this._layers.length<=0)return E(this);var t=e.length;for(var n=0;n<t;n++)e[n].processData();for(var n=0;n<t;n++){var r=e[n];r.render()}},e._notifyDrawFrame=function(){for(var e in this._layers)this._layers[e]._notifyDrawFrame()},e._notifyTouch=function(e){var t=this._layers.slice(),n=t.length;for(var r=0;r<n;r++)t[r]._notifyTouch(e)}}),h=Math.PI,p=null,d=-1,v=-1,m=0,g=null,y,b;return c}),herlock.define("module/view_css/window/window",[],function(){var e={installTo:function(e,t){e.addLayer=function(e){return t.addLayer(e)},e.addLayerAt=function(e,n){return t.addLayer(e,n)},e.getLayerAt=function(e){return t.getLayerAt(e)},e.getLayerIndex=function(e){return t.getLayerIndex(e)},e.removeLayer=function(e){return t.removeLayer(e)},e.removeLayerAt=function(e){return t.removeLayerAt(e)},e.innerWidth=t.getViewWidth();try{Object.defineProperties(e,{innerWidth:{get:function(){return t.getViewWidth()}},innerHeight:{get:function(){return t.getViewHeight()}}})}catch(n){console.log("SafariはinnerWidth,innerHeightが更新できません。"),e.innerWidth=t.getViewWidth(),e.innerHeight=t.getViewHeight()}e.setOrientationType=function(){}},initJs:function(e){}};return e}),herlock.define("module/view_css/layer/Layer",["lib/Class","module/view/touch/TouchEventInfo"],function(e,t){var n=e(Object,function(e,t){e.constructor=function(e){t.constructor.apply(this,arguments),this._content=null,this._renderingObject=new r,this._calcRequested=!0,this._horizontalAlign=n.Align.CENTER,this._verticalAlign=n.Align.MIDDLE,this._scaleMode=n.ScaleMode.SHOW_ALL,this._colorTransform=new ColorTransform,this._backgroundColor=16777215,this._backgroundAlpha=0,this._offsetPercentX=0,this._offsetPercentY=0,this._module=null,this._matrix=new Matrix,this._contentMatrix=new Matrix,this._contentDisplayRect=new Rectangle,e&&(this.content=e)},e.content={get:function(){return this._content},set:function(e){this._content!=null&&this._content._onRemovedFrom(this),this._calcRequested=!0,this._content=e,e!=null&&this._content._onAddedTo(this)}},e.contentScaleX={get:function(){return this._getContentMatrix()._getScaleX()}},e.contentScaleY={get:function(){return this._getContentMatrix()._getScaleY()}},e.horizontalAlign={get:function(){return this._horizontalAlign},set:function(e){this._horizontalAlign=e,this._calcRequested=!0}},e.verticalAlign={get:function(){return this._verticalAlign},set:function(e){this._verticalAlign=e,this._calcRequested=!0}},e.scaleMode={get:function(){return this._scaleMode},set:function(e){this._scaleMode=e,this._calcRequested=!0}},e.offsetX={get:function(){return this._offsetPercentX},set:function(e){this._offsetPercentX=e,this._calcRequested=!0}},e.offsetY={get:function(){return this._offsetPercentY},set:function(e){this._offsetPercentY=e,this._calcRequested=!0}},e.alpha={get:function(){return this._colorTransform.getAlphaMultiplier()},set:function(e){this._colorTransform.getAlphaMultiplier(e)}},e.backgroundColor={get:function(){return this._backgroundColor},set:function(e){this._backgroundColor=e}},e.backgroundAlpha={get:function(){return this._backgroundAlpha},set:function(e){this._backgroundAlpha=e}},e._notifyDrawFrame=function(){this._content&&this._content._notifyDrawFrame()},e._addedTo=function(e){this._module=e,calcRequested=!0},e._removedFrom=function(e){this._module=null},e._notifyResizeView=function(e,t){this._content!=null&&this._content._notifyResizeView(e,t),this._calcRequested=!0},e._notifyResizeContent=function(){this._calcRequested=!0},e._notifyTouch=function(e){if(!this._content)return;this._content._dispatchTouchEvent(e)},e._calculate=function(){if(this._module==null)return;if(this._content==null)return;this._calcRequested=!1;var e=this._module.getViewWidth(),t=this._module.getViewHeight(),r=e/t,i=this._content._getContentWidth(),s=this._content._getContentHeight(),o=i/s;if(this._scaleMode==n.ScaleMode.EXACT_FIT)this._contentMatrix._setScaleX(e/i),this._contentMatrix._setScaleY(t/s);else if(this._scaleMode==n.ScaleMode.SHOW_ALL){var u;r<o?u=e/i:u=t/s,this._contentMatrix._setScaleX(u),this._contentMatrix._setScaleY(u)}else if(this._scaleMode==n.ScaleMode.NO_BORDER){var u;r>o?u=e/i:u=t/s,this._contentMatrix._setScaleX(u),this._contentMatrix._setScaleY(u)}else this._scaleMode==n.ScaleMode.NO_SCALE&&(this._contentMatrix._setScaleX(1),this._contentMatrix._setScaleY(1));this._matrix._setX(e*this._offsetPercentX),this._matrix._setY(t*this._offsetPercentY),this._contentDisplayRect.width=this._content._getContentWidth()*this._contentMatrix._getScaleX(),this._contentDisplayRect.height=this._content._getContentHeight()*this._contentMatrix._getScaleY(),this._contentDisplayRect.x=this._matrix._getX(),this._contentDisplayRect.y=this._matrix._getY();var a=0,f=0;this._horizontalAlign==n.Align.LEFT?a+=0:this._horizontalAlign==n.Align.CENTER?a+=.5*(e-this._contentDisplayRect.width):this._horizontalAlign==n.Align.RIGHT&&(a+=1*(e-this._contentDisplayRect.width)),this._verticalAlign==n.Align.TOP?f+=0:this._verticalAlign==n.Align.MIDDLE?f+=.5*(t-this._contentDisplayRect.height):this._verticalAlign==n.Align.BOTTOM&&(f+=1*(t-this._contentDisplayRect.height)),this._contentDisplayRect.x+=a,this._contentDisplayRect.y+=f,this._contentMatrix._setX(a),this._contentMatrix._setY(f)},e._getMatrix=function(){return this._calcRequested&&this._calculate(),this._matrix.clone()},e._getContentMatrix=function(){return this._calcRequested&&this._calculate(),this._contentMatrix.clone()},e._getContentDisplayRect=function(){return this._calcRequested&&this._calculate(),this._contentDisplayRect},e._glPrepare=function(){if(this._module==null)return null;if(this._content==null)return null;var e=new Matrix;return this._renderingObject.contentRenderingObject=this._content._glPrepare(e,this._colorTransform),this._renderingObject}});n.Align={TOP:"top",MIDDLE:"middle",BOTTOM:"bottom",LEFT:"left",CENTER:"center",RIGHT:"right",NONE:"none"},n.ScaleMode={EXACT_FIT:"exactFit",NO_BORDER:"noBorder",NO_SCALE:"noScale",SHOW_ALL:"showAll",MODE_NONE:"none"};var r=e(Object,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments)},e.viewport=null,e.contentRenderingObject=null,e.processData=function(){if(!this.contentRenderingObject)return;this.contentRenderingObject.processData()},e.renderOffscreen=function(){},e.render=function(){if(!this.contentRenderingObject)return;this.contentRenderingObject.render()}});return n}),herlock.define("module/view_css/image/Image",["lib/Class","module/common/event/EventDispatcher","lib/URL","module/graphics/BitmapProxy"],function(e,t,n,r){var i=e(t,function(e,t){e.constructor=function(e){t.constructor.apply(this,arguments),this._src="",this._bitmapProxy=null,e&&(this.src=e)},e.src={get:function(){this._src},set:function(e){this._src=e;var t=new n(e);this._image=null;var i=document.createElement("img"),s=window.__herlock_ctx,o=this;i.onload=function(){o._image=i,o._bitmapProxy=new r(o._image),o._dispatchEventAndCallHandler(new Event("load"))},i.src=t.host===""?s._rootPath+t:t.toString()}},e.complete={get:function(){}},e.width={get:function(){return this._image?this._image.width:0}},e.height={get:function(){return this._image?this._image.height:0}},e.naturalWidth={get:function(){return this._image?this._image.width:0}},e.naturalHeight={get:function(){return this._image?this._image.height:0}},e.onload=function(){},e.onerror=function(){},e._getBitmap=function(){return this._bitmapProxy}});return i}),herlock.define("module/view_css/flash/internal/renderer/RenderingNode",["lib/Class","module/view/flash/display/BlendMode","module/view/geom/Matrix","module/view/geom/ColorTransform"],function(e,t,n,r){var i=e(Object,function(e,i){e.constructor=function(){i.constructor.apply(this,arguments),this._matrix=new n,this._colorTransform=new r,this.children=[],this.concatenatedMatrix=new n,this.concatenatedColorTransform=new r,this.concatenatedBlendMode="normal"},e.mask=null,e.visible=!0,e.cacheAsBitmap=!1,e.matrixIsUpdated=!1,e.concatenatedMatrixIsUpdated=!1,e.colorTransformIsUpdated=!1,e.concatenatedColorTransformIsUpdated=!1,e.blendMode="normal",e.setMatrix=function(e){if(this._matrix._getVersion()==e._getVersion()){this.matrixIsUpdated=!1;return}this._matrix=e.clone(),this.matrixIsUpdated=!0},e.getMatrix=function(){return this._matrix.clone()},e.setColorTransform=function(e){if(this._colorTransform._getVersion()==e._getVersion()){this.colorTransformIsUpdated=!1;return}this._colorTransform=e.clone(),this.colorTransformIsUpdated=!0},e.getColorTransform=function(){return this._colorTransform},e.visit=function(e){var n=e.parent;n.concatenatedMatrixIsUpdated||this.matrixIsUpdated?(this.concatenatedMatrix=this.getMatrix(),this.concatenatedMatrix.concat(n.concatenatedMatrix),this.concatenatedMatrixIsUpdated=!0):this.concatenatedMatrixIsUpdated=!1,n.concatenatedColorTransformIsUpdated||this.colorTransformIsUpdated?(this.concatenatedColorTransform=this._colorTransform,this.concatenatedColorTransform.concat(n.concatenatedColorTransform),this.concatenatedColorTransformIsUpdated=!0):this.concatenatedColorTransformIsUpdated=!1,this.visible=this.visible&&n.visible,this.mask=n.mask?n.mask:this.mask,this.blendMode=this.blendMode==t.NORMAL?n.blendMode:this.blendMode,e.parent=this;var r=this.children.length;for(var i=0;i<r;++i)this.children[i].visit(e.clone())},e.getBoundingBox=function(e){if(!this.visible)return;var t=this.children.length;for(var n=0;n<t;++n)this.children[n].getBoundingBox(e)}});return i}),herlock.define("module/view_css/flash/display/BlendMode",[],function(){var e={NORMAL:"normal",ADD:"add"};return e}),herlock.define("module/view_css/flash/geom/Transform",["lib/Class"],function(e){var t=e(Object,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments)},e.colorTransform={get:function(){return this._owner?this._owner._colorTransform.clone():new ColorTransform},set:function(e){if(!this._owner)return;!this._owner._setColorTransform(e)}},e.concatenatedColorTransform={get:function(){return}},e.concatenatedMatrix={get:function(){return}},e.matrix={get:function(){return this._owner?this._owner._matrix.clone():new Matrix},set:function(e){if(!this._owner)return;!this._owner._setMatrix(e)}},e._initwithOwner=function(e){this._owner=e},e._getOwner=function(){return this._owner}});return t}),herlock.define("module/view_css/flash/display/DisplayObject",["lib/Class","module/common/event/EventDispatcher","../internal/renderer/RenderingNode","./BlendMode","../geom/Transform","module/view/geom/Point","module/view/geom/Rectangle","module/view/geom/Matrix","module/view/geom/ColorTransform"],function(e,t,n,r,i,s,o,u,a){var f=Math.PI,l=e(t,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments),this._colorTransform=new a,this._naturalRect=new o,this._boundsRect=new o,this._matrix=new u,this._transformationPoint=null,this._scale9Grid=new o},e._blendMode=r.NORMAL,e._cacheAsBitmap=!1,e._cacheHandle=null,e._visible=!0,e._parent=null,e._mask=null,e._containable=!1,e._interactive=!1,e._xValue=0,e._yValue=0,e._scaleXValue=1,e._scaleYValue=1,e._rotationValue=0,e._skewXValue=0,e._skewYValue=0,e._calcNaturalRectRequested=!0,e._calcBoundsRectRequested=!0,e._calcMatrixRequested=!0,e._enabledTransformationPoint=!1,e.alpha={get:function(){return this._colorTransform.alphaMultiplier},set:function(e){this._colorTransform.alphaMultiplier=e}},e.blendMode={get:function(){return this._blendMode},set:function(e){this._blendMode=e}},e.cacheAsBitmap={get:function(){return this._cacheAsBitmap},set:function(e){this._cacheAsBitmap=e}},e.height={get:function(){return this._getBoundsRect().height},set:function(e){this.scaleY=this.scaleY*e/this.height}},e.mask={get:function(){this._mask},set:function(e){this._mask=e}},e.name="",e.parent={get:function(){return this._parent}},e.root={get:function(){return this._parent?this._parent.root:this}},e.scale9Grid={get:function(){return this._scale9Grid.clone()},set:function(e){e===null?this._scale9Grid.setEmpty():this._scale9Grid=e}},e.rotation={get:function(){return this._rotationValue},set:function(e){if(this._enabledTransformationPoint){this._setRotationWithTransformPoint(e,this.transformationPoint);return}while(e>180)e-=360;while(e<-180)e+=360;this._rotationValue=e;var t=new u;t._setSkewX(this._skewXValue),t._setSkewY(this._skewYValue),t.rotate((this._rotationValue-t._getRotation())/180*f),this._skewXValue=t._getSkewX(),this._skewYValue=t._getSkewY(),this._requestCalcNaturalRect()}},e.scaleX={get:function(){return this._scaleXValue},set:function(e){if(this._scaleXValue===e)return;if(this._enabledTransformationPoint){this._setScaleXWithTransformPoint(e,this._transformationPoint);return}isNaN(e)&&console.error("debug scaleX",this,e),this._scaleXValue=e,this._requestCalcNaturalRect()}},e.scaleY={get:function(){return this._scaleYValue},set:function(e){if(this._scaleYValue===e)return;if(this._enabledTransformationPoint){this._setScaleYWithTransformPoint(e,this._transformationPoint);return}this._scaleYValue=e,this._requestCalcNaturalRect()}},e.stage={get:function(){return this._parent?this._parent.stage:null}},e.transform={get:function(){var e=new i;return e._initwithOwner(this),e},set:function(e){this._setColorTransform(e.getColorTransform()),this._setMatrix(e.getMatrix()),requestCalcNaturalRect()}},e.visible={get:function(){return this._visible},set:function(e){if(this._visible==e)return;this._visible=e,this._requestCalcNaturalRect()}},e.width={get:function(){return this._getBoundsRect().width},set:function(e){this.scaleX=this.scaleX*e/this.width}},e.x={get:function(){return this._xValue},set:function(e){if(this._xValue===e)return;this._xValue=e,this._requestCalcNaturalRect()}},e.y={get:function(){return this._yValue},set:function(e){if(this._yValue===e)return;this._yValue=e,this._requestCalcNaturalRect()}},e.getBounds=function(e){e||(e=this);var t=this._getConcatenatedMatrix(),n=e._getConcatenatedMatrix();n.invert(),t.concat(n);var r=this._getNaturalRect(),i=t._calculateBoundsRect(r);return i},e.getRect=function(e){return getBounds(e)},e.globalToLocal=function(e){var t=this._getConcatenatedMatrix();return t.invert(),t.transformPoint(e)},e.hitTestObject=function(e){var t=this._getNaturalRect(),n=this._getConcatenatedMatrix()._calculateBoundsRect(t);t=e._getNaturalRect();var r=e._getConcatenatedMatrix()._calculateBoundsRect(t),i=n.containsRect(r)||n.intersects(r);return i},e.hitTestPoint=function(e,t,n){var r=this.stage;if(!r)return!1;if(n){var i=this.getBounds(r);return i.containsPoint(new s(e,t))}var i=this.getBounds(r);return i.containsPoint(new s(e,t))},e.localToGlobal=function(e){return this._getConcatenatedMatrix().transformPoint(e)},e.transformationPoint={get:function(){},set:function(){}},e._getMatrix=function(){return this._getMatrixRef().clone()},e._getMatrixRef=function(){return this._calcMatrixRequested&&(this._calcMatrixRequested=!1,this._matrix.identity(),this._matrix.scale(this._scaleXValue,this._scaleYValue),this._skewXValue!=this._skewYValue?(this._matrix._setSkewX(this._skewXValue),this._matrix._setSkewY(this._skewYValue)):this._matrix.rotate(this._rotationValue/180*f),this._matrix.translate(this._xValue,this._yValue)),this._matrix},e._setMatrix=function(e){this._xValue=e._getX(),this._yValue=e._getY(),this._rotationValue=e._getRotation(),this._scaleXValue=e._getScaleX(),this._scaleYValue=e._getScaleY(),this._skewXValue=e._getSkewX(),this._skewYValue=e._getSkewY(),this._requestCalcNaturalRect()},e._getColorTransform=function(){return this._colorTransform.clone()},e._getColorTransformRef=function(){return this._colorTransform},e._setColorTransform=function(e){this._colorTransform=e},e._getConcatenatedMatrix=function(){var e=this._getMatrix(),t=this.parent;while(t){var n=t._getMatrix();e.concat(n),t=t.parent}return e},e._getConcatenatedColorTransform=function(){},e._setParent=function(e){this._parent!=null&&(this._parent=null);if(e==null)return;this._parent=e},e._notifyOnAddedToStage=function(){this._hasEventListener("addedToStage")&&this.dispatchEvent(new Event("addedToStage"))},e._notifyOnRemovedFromStage=function(){this._hasEventListener("removedFromStage")&&this.dispatchEvent(new Event("removedFromStage"))},e._notifyOnEnterFrame=function(){this._hasEventListener("enterFrame")&&this.dispatchEvent(new Event("enterFrame"))},e._notifyOnFrameConstructed=function(){},e._notifyOnExecuteFrameScript=function(){},e._notifyOnExitFrame=function(){this._hasEventListener("exitFrame")&&this.dispatchEvent(new Event("exitFrame"))},e._drawVectorGraphics=function(){},e._glPrepare=function(e){var t=this._getRenderingNode();return t.visible=this.visible,t.setMatrix(this._getMatrixRef()),t.setColorTransform(this._getColorTransform()),t.blendMode=this._blendMode,this._mask!=null?t.mask=this._mask._getRenderingNode():this._mask==null&&!!t.mask&&(t.mask=null),t},e._getNaturalRect=function(){return this._calcNaturalRectRequested&&(this._calcNaturalRectRequested=!1,this._calculateNaturalRect()),this._naturalRect},e._calculateNaturalRect=function(){this._naturalRect.setEmpty()},e._requestCalcNaturalRect=function(e){if(e==1)return;if(this._calcMatrixRequested)return;this._calcMatrixRequested=!0,this._calcNaturalRectRequested=!0,this._calcBoundsRectRequested=!0,this._parent!==null&&this._parent._requestCalcNaturalRect()},e._getBoundsRect=function(){if(this._calcBoundsRectRequested){this._calcBoundsRectRequested=!1;var e=this._getNaturalRect();this._boundsRect=this._getMatrix()._calculateBoundsRect(e),isNaN(this._boundsRect.width)&&console.error("debug",this,this._boundsRect)}return this._boundsRect},e._getNodesToRoot=function(){var e=[];if(this._parent==null)return e;var t=this;while(t!=null)e.push(t),t=t.parent;return e},e._hitTestStrictInternal=function(e){var t=this._getMatrix();t.invert();var n=t.transformPoint(e),r=this._getNaturalRect().containsPoint(n);if(r&&this.mask){var i=this.mask,s=i._getConcatenatedMatrix();s.invert(),n=this._getConcatenatedMatrix().transformPoint(n),n=s.transformPoint(n),r=i._getNaturalRect().containsPoint(n)}return r?this:null},e._renderingNode=null,e._getRenderingNode=function(){return this._renderingNode||(this._renderingNode=this._createRenderingNode()),this._renderingNode},e._createRenderingNode=function(){return new n},e.toString=function(){return'[object DisplayObject name="'+this.name+'"]'}});return l}),herlock.define("module/view_css/flash/display/InteractiveObject",["lib/Class","./DisplayObject"],function(e,t){var n=e(t,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments)},e.mouseEnabled=!0});return n}),herlock.define("module/view_css/flash/display/DisplayObjectContainer",["lib/Class","./InteractiveObject"],function(e,t){var n=e(t,function(e,n){e.constructor=function(){n.constructor.apply(this,arguments),this._children=[],this._updatedChildrenForWorkChildren=!0,this._updatedChildrenForRenderingNode=!0},e.numChildren={get:function(){return this._children.length}},e.mouseChildren=!0,e.addChild=function(e){return this.addChildAt(e,this._children.length)},e.addChildAt=function(e,t){if(!e)return console.log("warning: "+this+".addChild child="+e);if(t<0)return console.log("warning: out of range.");if(this._children.length<t)return console.log("warning: out of range.");e._parent&&e._parent.removeChild(e),this._children.splice(t,0,e),e._setParent(this),this._requestCalcNaturalRect(),this._childrenUpdated();var n=[],r=e._getNodesToRoot();for(var i=r.length-1;i>=0;i--)n.push(r[i]);return e._propagateEvent(new Event("added"),n),e.stage&&e._notifyOnAddedToStage(),e},e.getChildIndex=function(e){return this._children.indexOf(e)},e.getChildAt=function(e){return this._children.length<=e?null:this._children[e]},e.getChildByName=function(e){for(var t=this._children.length-1;t>=0;t--)if(this._children[t].name===e)return this._children[t];return null},e.removeChild=function(e){var t=this._children.indexOf(e);return t===-1?console.log("warning: "+this+".removeChild("+e+")"):this.removeChildAt(t)},e.removeChildAt=function(e){if(e<0)return console.log("warning: out of range.");if(this._children.length<=e)return console.log("warning: out of range.");var t=this._children[e],n=[],r=t._getNodesToRoot();for(var i=r.length-1;i>=0;i--)n.push(r[i]);return this._children.splice(e,1)[0],t._setParent(null),this._requestCalcNaturalRect(),this._childrenUpdated(),t._propagateEvent(new Event("removed"),n),t.stage||t._notifyOnRemovedFromStage(),t},e.contains=function(e){if(this===e)return!0;if(this._children.indexOf(e)!==-1)return!0;var t=this._children,n=t.length;for(var r=0;r<n;r++)if(t[r].contains(e))return!0;return!1},e.setChildIndex=function(e,t){this.addChildAt(e,t)},e.swapChildren=function(e,t){var n=this.getChildIndex(e),r=this.getChildIndex(t);if(n==-1||r==-1)return;this.addChildAt(e,r),this.addChildAt(t,n),this._childrenUpdated()},e.swapChildrenAt=function(e,t){var n=this.numChildren();if(e>=n||t>=n||e<0||t<0)return;this.swapChildren(this.getChildAt(e),this.getChildAt(t))},e._childrenUpdated=function(){this._updatedChildrenForWorkChildren=!0,this._updatedChildrenForRenderingNode=!0},e._notifyOnAddedToStage=function(){DisplayObject.prototype._notifyOnAddedToStage.call(this);var e=this._children.slice(),t=e.length;for(var n=0;n<t;n++)e[n]._notifyOnAddedToStage()},e._notifyOnRemovedFromStage=function(){DisplayObject.prototype._notifyOnRemovedFromStage.call(this);var e=this._children.slice(),t=e.length;for(var n=0;n<t;n++)e[n]._notifyOnRemovedFromStage()},e._notifyOnEnterFrame=function(){DisplayObject.prototype._notifyOnEnterFrame.call(this);var e=this._children.slice(),t=e.length;for(var n=0;n<t;n++)e[n]._notifyOnEnterFrame()},e._notifyOnFrameConstructed=function(){DisplayObject.prototype._notifyOnFrameConstructed.call(this);var e=this._children.slice(),t=e.length;for(var n=0;n<t;n++)e[n]._notifyOnFrameConstructed()},e._notifyOnExecuteFrameScript=function(){DisplayObject.prototype._notifyOnExecuteFrameScript.call(this);var e=this._children.slice(),t=e.length;for(var n=0;n<t;n++)e[n]._notifyOnExecuteFrameScript()},e._notifyOnExitFrame=function(){DisplayObject.prototype._notifyOnExitFrame.call(this);var e=this._children.slice(),t=e.length;for(var n=0;n<t;n++)e[n]._notifyOnExitFrame()},e._drawVectorGraphics=function(){DisplayObject.prototype._drawVectorGraphics.call(this);var e=this._children.slice(),t=e.length;for(var n=0;n<t;n++)e[n]._drawVectorGraphics()},e._glPrepare=function(e){var t=this._getRenderingNode(),n=this._children,r=n.length;if(this._updatedChildrenForRenderingNode){this._updatedChildrenForRenderingNode=!1;var i=t.children;i.length=0;for(var s=0;s<r;s++){var o=n[s]._glPrepare(e);if(o==null)continue;i.push(o)}}else for(var s=0;s<r;s++)n[s]._glPrepare(e);return DisplayObject.prototype._glPrepare.call(this,e)},e._calculateNaturalRect=function(){this._naturalRect.setEmpty();var e=this._children.slice(),t=e.length;for(var n=0;n<t;n++)e[n].visible&&(this._naturalRect=this._naturalRect.union(e[n]._getBoundsRect()))},e._hitTestStrictInternal=function(e){if(n._hitTestStrictInternal.call(this,e)==null)return null;var r=null,i=this._getMatrix();i.invert(),e=i.transformPoint(e);var s=!1;for(var o=this.numChildren-1;o>=0;o--){if(this.getChildAt(o).visible!=1)continue;r=this.getChildAt(o)._hitTestStrictInternal(e);if(r==null)continue;if(this.mouseChildren!=1)return this;if(r.isInstanceOf(t)!=1||r.mouseEnabled!=1){s=!0;continue}return r}return s?this:null},e.toString=function(){return'[object DisplayObjectContainer name="'+this.name+'"]'}});return n}),herlock.define("module/view_css/flash/display/Sprite",["lib/Class","./DisplayObjectContainer"],function(e,t){var n=e(t,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments)},e.toString=function(){return'[object Sprite name="'+this.name+'"]'}});return n}),herlock.define("module/view_css/geom/Point",["lib/Class"],function(e){var t=function(e,t){this.x=0,this.y=0,arguments.length>=1&&(this.x=e),arguments.length>=2&&(this.y=t)};return t.prototype=Object.create({},{add:{value:function(e){return new t(this.x+e.x,this.y+e.y)},writable:!0},subtract:{value:function(e){return new t(this.x-e.x,this.y-e.y)},writable:!0},clone:{value:function(e){return new t(e.x,e.y)},writable:!0},equals:{value:function(e){return this.x===e.x&&this.y===e.y},writable:!0},normalize:{value:function(e){var t=Math.sqrt(this.x*this.x+this.y*this.y);this.x=this.x/t*e,this.y=this.y/t*e},writable:!0},offset:{value:function(e){this.x+=e.x,this.y+=e.y},writable:!0},toString:{value:function(){return'[object Point x="'+this.x+'" y="'+this.y+'"]'},writable:!0}}),t}),herlock.define("module/view_css/geom/Rectangle",["lib/Class","./Point"],function(e,t){var n=function(e,t,n,r){this.x=0,this.y=0,this.width=0,this.height=0;var i=arguments.length;i>0&&(this.x=arguments[0]),i>1&&(this.y=arguments[1]),i>2&&(this.width=arguments[2]),i>3&&(this.height=arguments[3])};return n.prototype=Object.create({},{top:{get:function(){return this.y},set:function(e){this.height+=this.y-e,this.y=e}},right:{get:function(){return this.x+this.width},set:function(e){this.width+=e-this.right}},bottom:{get:function(){return this.y+this.height},set:function(e){this.height+=e-this.bottom}},left:{get:function(){return this.x},set:function(e){this.width+=this.x-e,this.x=e}},topLeft:{get:function(){return new t(this.left,this.top)},set:function(e){this.left=e.x,this.top=e.y}},bottomRight:{get:function(){return new t(this.right,this.bottom)},set:function(e){this.right=e.x,this.bottom=e.y}},size:{get:function(){return new t(this.width,this.height)},set:function(e){this.width=e.x,this.height=e.y}},clone:{value:function(){return new n(this.x,this.y,this.width,this.height)},writable:!0},contains:{value:function(e,t){return this.left<=e&&e<=this.right&&this.top<=t&&t<=this.bottom},writable:!0},containsPoint:{value:function(e){return this.contains(e.x,e.y)},writable:!0},containsRect:{value:function(e){return this.top<=e.top&&e.bottom<=this.bottom&&this.left<=e.left&&e.right<=this.right},writable:!0},equals:{value:function(e){return this.x==e.x&&this.y==e.y&&this.width==e.width&&this.height==e.height},writable:!0},inflate:{value:function(e,t){this.x-=e,this.width+=2*e,this.y-=t,this.height+=2*t},writable:!0},inflatePoint:{value:function(e){this.inflate(e.x,e.y)},writable:!0},intersects:{value:function(e){return this.top>e.bottom||this.left>e.right||this.right<e.left||this.bottom<e.top?!1:!0},writable:!0},intersection:{value:function(e){if(this.intersects(e)!=1)return new n;var t,r,i,s;return t=this.top>e.top?this.top:e.top,r=this.right<e.right?this.right:e.right,i=this.bottom<e.bottom?this.bottom:e.bottom,s=this.left>e.left?this.left:e.left,new n(s,t,r-s,i-t)},writable:!0},isEmpty:{value:function(){return this.width<=0||this.height<=0},writable:!0},offset:{value:function(e,t){this.x+=e,this.y+=t},writable:!0},offsetPoint:{value:function(e){this.offset(e.x,e.y)},writable:!0},setEmpty:{value:function(){this.x=0,this.y=0,this.width=0,this.height=0},writable:!0},union:{value:function(e){if(this.isEmpty()&&e.isEmpty())return new n;if(e.isEmpty())return this.clone();if(this.isEmpty())return e.clone();var t,r,i,s;return t=this.top<e.top?this.top:e.top,r=this.right>e.right?this.right:e.right,i=this.bottom>e.bottom?this.bottom:e.bottom,s=this.left<e.left?this.left:e.left,new n(s,t,r-s,i-t)},writable:!0},_set:{value:function(e,t,n,r){this.x=e,this.y=t,this.width=n,this.height=r},writable:!0},toString:{value:function(){return'[object Rectangle x="'+this.x+'" y="'+this.y+'" width="'+this.width+'" height="'+this.height+'"]'},writable:!0}}),n}),herlock.define("module/view_css/geom/Matrix",["lib/Class","./Point","./Rectangle"],function(e,t,n){var r=Math.PI,i=0,s=1,o=2,u=3,a=4,f=5,l=[1,0,0,1,0,0],c=function(e,t,n,r,i,s){var o=arguments.length;if(o===0)this._values=[1,0,0,1,0,0],this._isInitialValue=!0;else{var u=this._values=[o>0?e:1,o>1?t:0,o>2?n:0,o>3?r:1,o>4?i:0,o>5?s:0];this._isInitialValue=u[0]===1&&u[1]===0&&u[2]===0&&u[3]===1&&u[4]===0&&u[5]===0}this._version=Math.random()*1e7<<0};return c.prototype=Object.create({},{a:{get:function(){return this._values[0]},set:function(e){this._values[0]=e,this._increment()}},b:{get:function(){return this._values[1]},set:function(e){this._values[1]=e,this._increment()}},c:{get:function(){return this._values[2]},set:function(e){this._values[2]=e,this._increment()}},d:{get:function(){return this._values[3]},set:function(e){this._values[3]=e,this._increment()}},tx:{get:function(){return this._values[4]},set:function(e){this._values[4]=e,this._increment()}},ty:{get:function(){return this._values[5]},set:function(e){this._values[5]=e,this._increment()}},_increment:{value:function(){this._version++,this._isInitialValue=!1},writable:!0},_getVersion:{value:function(){return this._version},writable:!0},isInitialValue:{value:function(){return this._isInitialValue},writable:!0},clone:{value:function(){var e=new c;return e._values=this._values.slice(),e._version=this._version,e._isInitialValue=this._isInitialValue,e},writable:!0},concat:{value:function(e){if(e.isInitialValue())return;this._concat(e._values)},writable:!0},_concat:{value:function(e){if(this.isInitialValue())this._values=e;else{var t=this._values,n=e;this._values=[t[0]*n[0]+t[1]*n[2],t[0]*n[1]+t[1]*n[3],t[2]*n[0]+t[3]*n[2],t[2]*n[1]+t[3]*n[3],t[4]*n[0]+t[5]*n[2]+n[4],t[4]*n[1]+t[5]*n[3]+n[5]]}this._increment()},writable:!0},createBox:{value:function(){},writable:!0},createGradientBox:{value:function(){},writable:!0},deltaTransformPoint:{value:function(){},writable:!0},identity:{value:function(){this._values=[1,0,0,1,0,0],this._increment(),this._isInitialValue=!0},writable:!0},invert:{value:function(){var e=this.a*this.d-this.c*this.b;if(e===0)return;var t=1/e,n=this.tx;this.tx=(this.c*this.ty-n*this.d)*t,this.ty=(n*this.b-this.a*this.ty)*t,this.c=-this.c*t,this.b=-this.b*t,n=this.a,this.a=this.d*t,this.d=n*t,this._increment()},writable:!0},rotate:{value:function(e){var t=Math.cos(e),n=Math.sin(e);this._concat([t,n,-n,t,0,0])},writable:!0},scale:{value:function(e,t){this._concat([e,0,0,t,0,0])},writable:!0},transformPoint:{value:function(e){var n=this._values;return new t(e.x*n[0]+e.y*n[2]+1*n[4],e.x*n[1]+e.y*n[3]+1*n[5])},writable:!0},translate:{value:function(e,t){this._concat([1,0,0,1,e,t])},writable:!0},_getScaleX:{value:function(){return Math.sqrt(this.a*this.a+this.b*this.b)},writable:!0},_setScaleX:{value:function(e){this._increment();var t=this._getScaleX();if(t>0){var n=e/t;this.a*=n,this.b*=n}else{var r=this._getSkewY_();this.a=Math.cos(r)*e,this.b=Math.sin(r)*e}},writable:!0},_getScaleY:{value:function(){return Math.sqrt(this.c*this.c+this.d*this.d)},writable:!0},_setScaleY:{value:function(e){this._increment();var t=this._getScaleY();if(t>0){var n=e/t;this.c*=n,this.d*=n}else{var r=this._getSkewX_();this.c=-Math.sin(r)*e,this.d=Math.cos(r)*e}},writable:!0},_getSkewX:{value:function(){return this._getSkewX_()*(180/r)},writable:!0},_setSkewX:{value:function(e){this._setSkewX_(e*(r/180))},writable:!0},_getSkewY:{value:function(){return this._getSkewY_()*(180/r)},writable:!0},_setSkewY:{value:function(e){this._setSkewY_(e*(r/180))},writable:!0},_getRotation:{value:function(){return this._getSkewY_()*(180/r)},writable:!0},_setRotation:{value:function(e){this._setRotation_(e*(r/180))},writable:!0},_getX:{value:function(){return this.tx},writable:!0},_setX:{value:function(e){this.tx=e,this._increment()},writable:!0},_getY:{value:function(){return this.ty},writable:!0},_setY:{value:function(e){this.ty=e,this._increment()},writable:!0},_setRotation_:{value:function(e){var t=this._getSkewY_(),n=this._getSkewX_();this._setSkewX_(n+e-t),this._setSkewY_(e)},writable:!0},_getSkewX_:{value:function(){return Math.atan2(-this.c,this.d)},writable:!0},_setSkewX_:{value:function(e){var t=this._getScaleY();this.c=-t*Math.sin(e),this.d=t*Math.cos(e),this._increment()},writable:!0},_getSkewY_:{value:function(){return Math.atan2(this.b,this.a)},writable:!0},_setSkewY_:{value:function(e){var t=this._getScaleX();this.a=t*Math.cos(e),this.b=t*Math.sin(e),this._increment()},writable:!0},_calculateBoundsRect:{value:function(e){var r=[this.transformPoint(e.topLeft),this.transformPoint(new t(e.right,e.top)),this.transformPoint(new t(e.left,e.bottom)),this.transformPoint(e.bottomRight)],i=r[0].y,s=r[0].y,o=r[0].x,u=r[0].x;for(var a=1;a<4;a++){var f=r[a];i>f.y&&(i=f.y),s<f.y&&(s=f.y),o>f.x&&(o=f.x),u<f.x&&(u=f.x)}return new n(o,i,u-o,s-i)},writable:!0},_equal:{value:function(e){for(var t=0;t<6;t++)if(this._values[t]!=e._values[t])return!1;return!0},writable:!0}}),c}),herlock.define("module/view_css/flash/internal/renderer/CSSRenderingSystem",["lib/Class","../../../geom/Matrix"],function(e,t){function r(e,t){var n=e+"{";for(var r in t)n+=""+r+":"+t[r]+";";return n+="}",n}var n=e(Object,function(e,n){e.container=null,e.width=null,e.height=null,e.constructor=function(){var e=document.createElement("style");document.head.appendChild(e),this._sheet=e.sheet,this._matrixSheet=document.createElement("style"),document.head.appendChild(this._matrixSheet),this._idIncrementor=0,this._fragment=document.createDocumentFragment(),this._curr=[],this._prev=[]},e.putBitmapProxy=function(e){var t=this._sheet.cssRules.length,n="texture_"+this._idIncrementor++;this._sheet.insertRule(r("."+n,{background:"url("+(e._imageElm?e._imageElm.src:e._canvasElm.toDataURL())+")",position:"absolute",display:"block !important",top:"0",left:"0",width:e.width()+"px",height:e.height()+"px"}),t);var i={id:n,index:t};return i};var i=new t(-1,0,0,1,-100,0);e.render=function(e){var t=e.element,n=e.matrix,r=e.style;e.visible||(n=i);var s=n._values,o=e.__matrix_values||[],u=o[0]!==s[0]||o[1]!==s[1]||o[2]!==s[2]||o[3]!==s[3]||o[4]!==s[4]||o[5]!==s[5];u&&(__setTransform(r,"matrix3d( "+s[0].toFixed(8)+", "+s[1].toFixed(8)+", 0, 0, "+s[2].toFixed(8)+", "+s[3].toFixed(8)+", 0, 0, 0, 0, 1, 0, "+s[4].toFixed(8)+", "+s[5].toFixed(8)+", 0, 1 )"),e.__matrix_values=s.slice());if(!t.__clippingRect||!t.__clippingRect.equals(e.clippingRect)){if(e.clippingRect.isEmpty())r.width=null,r.height=null,r.backgroundPosition=null;else{var a=e.clippingRect;r.width=a.width+"px",r.height=a.height+"px",r.backgroundPosition=-a.x+"px "+ -a.y+"px"}t.__clippingRect=e.clippingRect}var f=e.colorTransform.alphaMultiplier;t.__alpha!==f&&(r.opacity=f,t.__alpha=f),this._curr.push(e.element)},e.render_bk=function(e){var t=e.element,n=e.matrix,r=e.style;e.visible||(n=i);if(!t.__matrix||!t.__matrix._equal(n))__setTransform(r,"matrix3d( "+n.a.toFixed(8)+", "+n.b.toFixed(8)+", 0, 0, "+n.c.toFixed(8)+", "+n.d.toFixed(8)+", 0, 0, 0, 0, 1, 0, "+n.tx.toFixed(8)+", "+n.ty.toFixed(8)+", 0, 1 )"),t.__matrix=n.clone();if(!t.__clippingRect||!t.__clippingRect.equals(e.clippingRect)){if(e.clippingRect.isEmpty())r.width=null,r.height=null,r.backgroundPosition=null;else{var s=e.clippingRect;r.width=s.width+"px",r.height=s.height+"px",r.backgroundPosition=-s.x+"px "+ -s.y+"px"}t.__clippingRect=e.clippingRect}var o=e.colorTransform.alphaMultiplier;t.__alpha!==o&&(r.opacity=o,t.__alpha=o),this._curr.push(e.element)},e.begin=function(){this._matrixSheetTexts=[]},e.end=function(){if(this._curr.length===this._prev.length){var e=!0;for(var t=0;t<this._curr.length;t++)e=e&&this._curr[t]===this._prev[t];if(e){this._prev=this._curr,this._curr=[];return}}for(var t in this._curr)this._fragment.appendChild(this._curr[t]);this.container.innerHTML="",this.container.appendChild(this._fragment),this._prev=this._curr,this._curr=[]}}),i=new n;return i}),herlock.define("module/view_css/flash/events/InteractiveObjectTouchEvent",["lib/Class","module/common/event/Event"],function(e,t){var n=e(t,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments);var e=arguments.length,n=arguments;this._touchPointID=e>3?n[3]:0,this._isPrimaryTouchPoint=e>4?n[4]:!1,this._localX=e>5?n[5]:0,this._localY=e>6?n[6]:0},e.isPrimaryTouchPoint={get:function(){return this._isPrimaryTouchPoint},set:function(e){this._isPrimaryTouchPoint=e}},e.localX={get:function(){return this._localX},set:function(e){this._localX=e}},e.localY={get:function(){return this._localY},set:function(e){this._localY=e}},e.touchPointID={get:function(){return this._touchPointID},set:function(e){this._touchPointID=e}},e.stageX={get:function(){if(this._hasStagePoint)return this._stagePoint.x;var e=this.target;return e.localToGlobal(new Point(this.localX,this.localY)).x}},e.stageY={get:function(){if(this._hasStagePoint)return this._stagePoint.y;var e=this.target;return e.localToGlobal(new Point(this.localX,this.localY)).y}},e._setStagePoint=function(e){return this._stagePoint=e,this._hasStagePoint=!0,this}});return n}),herlock.define("module/view_css/flash/display/Stage",["lib/Class","./Sprite","../internal/renderer/RenderingNode","../internal/renderer/CSSRenderingSystem","module/view/touch/TouchEventInfo","../events/InteractiveObjectTouchEvent"],function(e,t,n,r,i,s){var o=e(t,function(e,t){e.constructor=function(e,n){t.constructor.apply(this,arguments),this._stageWidth=e||100,this._stageHeight=n||100,this._layer=null,this._frameRate=60,this._quality=null,this._offscreenHandle=null,this._primaryTouchId=-1,this._touchPointerStateDictionary={},this._layerContentRenderObject=null},e.frameRate={get:function(){return this._frameRate},set:function(e){}},e.stageWidth={get:function(){return this._stageWidth},set:function(e){this._stageWidth=e,this._layer!=null&&this._layer._notifyResizeContent()}},e.stageHeight={get:function(){return this._stageHeight},set:function(e){this._stageHeight=e,this._layer!=null&&this._layer._notifyResizeContent()}},e.stage={get:function(){return this}},e.height={get:function(){}},e.width={get:function(){}},e.layer={get:function(){}},e._getContentWidth=function(){return this.stageWidth},e._getContentHeight=function(){return this.stageHeight},e.getLayer=function(){return this._layer},e._onAddedTo=function(e){this._layer=e},e._onRemovedFrom=function(e){this._layer=NULL},e._glPrepare=function(e,t){this._layerContentRenderObject||(this._layerContentRenderObject=new a);var n={};this._layerContentRenderObject.root=DisplayObjectContainer.prototype._glPrepare.call(this,n);var r=new Matrix;return r.concat(this.getLayer()._getContentMatrix()),r.concat(this.getLayer()._getMatrix()),this._layerContentRenderObject.matrix._equal(r)||(this._layerContentRenderObject.matrix=r),this._layerContentRenderObject.colorTransform=t,this._layerContentRenderObject},e._notifyDrawFrame=function(){this._notifyOnEnterFrame(),this._drawVectorGraphics()},e._notifyResizeView=function(e,t){},e._dispatchTouchEvent=function(e){var t=e,n=t.getChangedPointers(),r=n.length;for(var i=0;i<r;i++)this._dispatchTouchEventWithChangedTouchPointer(t,n[i])},e._dispatchTouchEventWithChangedTouchPointer=function(e,t){var n=this._layer._getMatrix(),r=this._layer._getContentMatrix();r.concat(n),r.invert();var o=r.transformPoint(new Point(t.x,t.y)),u=this,a=u._hitTestStrictInternal(o);a||(a=this);var l=a,c=l.globalToLocal(o),h=[];h.push(l);var p=l.parent;while(p)h.unshift(p),p=p.parent;var d="";switch(e.getAction()){case i.DOWN:d="touchBegin";break;case i.MOVE:d="touchMove";break;case i.UP:d="touchEnd";break;case i.CANCEL:default:d="touchEnd"}Object.keys(this._touchPointerStateDictionary).length<=0&&(this._primaryTouchId=t.id);var v=this._primaryTouchId==t.id,m=(new s(d,!0,!0,t.id,v,c.x,c.y))._setStagePoint(o);m._setTarget(h[h.length-1]),h[h.length-1]._propagateEvent(m,h);var g=null,a=this._touchPointerStateDictionary[t.id];a&&(g=a,delete this._touchPointerStateDictionary[t.id]);switch(e.getAction()){case i.DOWN:var y=f.create(t.id,l,l);this._touchPointerStateDictionary[t.id]=y;var m=(new s("touchOver",!0,!0,t.id,v,c.x,c.y))._setStagePoint(o);m._setTarget(h[h.length-1]),h[h.length-1]._propagateEvent(m,h);var b=h.length;for(var w=0;w<b;w++){var m=(new s("touchRollOver",!0,!0,t.id,v,c.x,c.y))._setStagePoint(o);h[w].dispatchEvent(m)}break;case i.MOVE:var y=f.create(t.id,g&&g.beganFrom?g.beganFrom:null,l);this._touchPointerStateDictionary[t.id]=y;if(g&&g.overNow==l)break;var m=(new s("touchOut",!0,!0,t.id,v,c.x,c.y))._setStagePoint(o);m._setTarget(h[h.length-1]),h[h.length-1]._propagateEvent(m,h);var m=(new s("touchOver",!0,!0,t.id,v,c.x,c.y))._setStagePoint(o);m._setTarget(h[h.length-1]),h[h.length-1]._propagateEvent(m,h);var E=-1,u=l,S=[],x=[];if(g&&g.overNow){x=g.overNow._getNodesToRoot();var T=x.length;while(E==-1){S.push(u);for(var w=0;w<T;w++)if(x[w]==u){E=w;break}u=u.parent;if(!u)break}}if(E==-1)break;for(var w=E-1;w>=0;w--){var m=(new s("touchRollOut",!0,!0,t.id,v,c.x,c.y))._setStagePoint(o);x[w].dispatchEvent(m)}var N=S.length;for(var w=0;w<N;w++){var m=(new s("touchRollOver",!0,!0,t.id,v,c.x,c.y))._setStagePoint(o);S[w].dispatchEvent(m)}break;case i.UP:case i.CANCEL:default:var m=(new s("touchOut",!0,!0,t.id,v,c.x,c.y))._setStagePoint(o),C=[];if(g&&g.overNow){C.push(g.overNow);var p=g.overNow.parent;while(p)C.unshift(p),p=p.parent;m._setTarget(g.overNow)}var b=C.length;for(var w=0;w<b;w++){var m=(new s("touchRollOut",!0,!0,t.id,v,c.x,c.y))._setStagePoint(o);C[w].dispatchEvent(m)}if(e.getAction()!=i.CANCEL&&g&&g.beganFrom&&g.beganFrom===l){var m=(new s("touchTap",!0,!0,t.id,v,c.x,c.y))._setStagePoint(o);m._setTarget(h[h.length-1]),h[h.length-1]._propagateEvent(m,h)}this._primaryTouchId==t.id&&(this._primaryTouchId=-1)}},e.toString=function(){return'[object Stage stageWidth="'+this.stageWidth+'" stageHeight="'+this.stageHeight+'"]'}}),u=function(e){e=e||{},this.parent=e.parent||new n,this.offScreenRenderingRequests=e.offScreenRenderingRequests||[],this.renderingRequests=e.renderingRequests||[]};u.prototype={clone:function(){return new u(this)}};var a=e(Object,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments),this.visitor=new u,this.visitor.parent=new n,this.visitor.offScreenRenderingRequests=[],this.visitor.renderingRequests=[],this.matrix=new Matrix,this.colorTransform=new ColorTransform,this.root=null},e.processData=function(){var e=new Matrix,t=this.matrix.clone();t.concat(e),this.visitor.parent._matrix._getVersion()!==t._getVersion()?(this.visitor.parent.setMatrix(t),this.visitor.parent.concatenatedMatrix=this.visitor.parent.getMatrix(),this.visitor.parent.concatenatedMatrixIsUpdated=!0):(this.visitor.parent.setMatrix(t),this.visitor.parent.matrixIsUpdated=!1,this.visitor.parent.concatenatedMatrixIsUpdated=!1),this.visitor.offScreenRenderingRequests=[],this.visitor.renderingRequests=[],this.root.visit(this.visitor.clone())},e.renderOffscreen=function(){},e.render=function(){r.begin();var e=this.visitor.renderingRequests,t=e.length;for(var n=0;n<t;n++)r.render(e[n]);r.end()}}),f={create:function(e,t,n){return{pointerId:e,beganFrom:t,overNow:n}}};return o}),herlock.define("module/view_css/flash/display/BitmapData",["lib/Class","module/graphics/BitmapProxy","../internal/renderer/CSSRenderingSystem"],function(e,t,n){function r(e){return typeof e=="number"}function i(e){return typeof e=="boolean"}var s=e(Object,function(e,s){e.constructor=function(){s.constructor.apply(this,arguments);var e=arguments,n=arguments.length,o=null;if(n>=2&&r(e[0])&&r(e[1])){var u=e[0],a=e[1],f=2046;if(u>=f||a>=f)throw new Error("Argument Error. over limit size!! please 2046 > size.");o=t.create(u,a);var l=!0,c=4294967295;n>=3&&i(e[2])&&(l=e[2]),n>=4&&r(e[3])&&(c=e[3]);var h=o.getCanvas();h.setFillColor(c),h.fillRect(0,0,u,a)}else{if(!(n>=1&&e[0].isInstanceOf&&e[0].isInstanceOf(Image)))throw new Error("Argument Error");o=e[0]._getBitmap()}this._bitmapProxy=o,this._sheetRow=null},e.width={get:function(){return this._bitmapProxy?this._bitmapProxy.width():0}},e.height={get:function(){return this._bitmapProxy?this._bitmapProxy.height():0}},e.transparent={get:function(){return!0}},e.rect={get:function(){return new Rectangle(0,0,this.width,this.height)}},e.dispose=function(){this._bitmapProxy=null},e._notifyEnterFrame=function(){},e._notifyFrameConstructed=function(){},e._notifyExecuteFrameScript=function(){},e._notifyExitFrame=function(){},e._notifyDrawVectorGraphics=function(){},e._glPrepare=function(){if(!this._bitmapProxy)return;this._sheetRow||(this._sheetRow=n.putBitmapProxy(this._bitmapProxy))},e._notifyUpdateForBitmap=function(){},e._getCSSId=function(){return this._sheetRow.id},e.toString=function(){return'[object BitmapData width="'+this.width+'" height="'+this.height+'"]'}});return s}),herlock.define("module/view_css/flash/internal/renderer/CSSRenderingObject",["lib/Class"],function(e){var t=0,n=e(Object,function(e,n){e.constructor=function(){n.constructor.apply(this,arguments),this.element=document.createElement("div"),this.element.style.transformOrigin="0 0",this.element.style.position="absolute",this.element.style.top=0,this.element.style.left=0,this.element.id="CSSRO_"+t++,this.style=this.element.style,this._cssId=null},e.cssId={get:function(){return this._cssId},set:function(e){if(this._cssId===e)return;this._cssId=e,this.element.className=e}},e.width=null,e.height=null,e.colorTransform=null,e.blendMode=null,e.maskNode=null,e.clippingRect=null,e.getTextureId=function(){return this.textureId}});return n}),herlock.define("module/view_css/flash/display/Bitmap",["lib/Class","./DisplayObject","../internal/renderer/RenderingNode","../internal/renderer/CSSRenderingObject"],function(e,t,n,r){var i=e(t,function(e,n){e.constructor=function(e,t,r,i){n.constructor.apply(this,arguments);var s=arguments.length;this._bitmapData=e,this._pixelSnapping=s>1?t:!1,this._smoothing=s>2?r:!1,this._clippingRect=s>3?i:new Rectangle},e.bitmapData={get:function(){return this._bitmapData},set:function(e){this._bitmapData!=null&&(this._bitmapData=null),e!=null&&(this._bitmapData=e),this._requestCalcNaturalRect()}},e.setClippingRect=function(e){this._clippingRect=e,this._requestCalcNaturalRect()},e._calculateNaturalRect=function(){if(this.bitmapData==null){this._naturalRect.setEmpty();return}if(this._clippingRect.isEmpty()){this._naturalRect.width=this.bitmapData.width,this._naturalRect.height=this.bitmapData.height;return}this._naturalRect.width=this._clippingRect.width,this._naturalRect.height=this._clippingRect.height},e._glPrepare=function(e){var n=this._getRenderingNode();return n.children=[],this.bitmapData==null?t.prototype._glPrepare.call(this,e):(this.bitmapData._glPrepare(),n.scale9Grid=this.scale9Grid,n.clippingRect=this._clippingRect,n.width=this.bitmapData.width,n.height=this.bitmapData.height,n.cssId=this.bitmapData._getCSSId(),t.prototype._glPrepare.call(this,e))},e._createRenderingNode=function(){return new s},e.toString=function(){return'[object Bitmap name="'+this.name+'"]'}}),s=e(n,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments),this._renderingObjects=[new r,new r,new r,new r,new r,new r,new r,new r,new r]},e.clippingRect=null,e.cssId=null,e.scale9Grid=null,e.width,e.height,e.setMatrix=function(e){t.setMatrix.call(this,e)},e.visit=function(e){if(!this.cssId)return;this.scale9Grid.isEmpty()&&n.prototype.visit.call(this,e);var t=this.concatenatedMatrix.clone(),r=this._renderingObjects[0];r.visible=this.visible&&e.parent.visible,r.cssId=this.cssId,r.blendMode=this.blendMode,r.maskNode=this.mask,r.colorTransform=this.concatenatedColorTransform,r.matrix=t,r.offsetX=0,r.offsetY=0,r.width=this.width,r.height=this.height,r.clippingRect=this.clippingRect,this.clippingRect.isEmpty()!=1&&(r.offsetX+=this.clippingRect.x,r.offsetY+=this.clippingRect.y,r.width=this.clippingRect.w,r.height=this.clippingRect.h),e.renderingRequests.push(r)},e.getBoundingBox=function(e){var t=this.textureImageHandle.getTextureImageInfo(),n=this.concatenatedMatrix,r=t.area.clone();this.clippingRect.isEmpty()!==!0&&(r.width=this.clippingRect.width,r.height=this.clippingRect.height),r.x=0,r.y=0;var i=n._calculateBoundsRect(r),s=e.union(i);e._set(s.x,s.y,s.width,s.height)}});return i}),herlock.define("module/view_css/flash/text/TextFormat",["lib/Class"],function(e){var t=e(Object,function(e,t){e.constructor=function(e,n,r,i,s,o,u,a,f,l,c,h,p){t.constructor.apply(this,arguments);var d=arguments.length;d>=1&&(this.font=e),d>=2&&(this.size=n),d>=3&&(this.color=r),d>=4&&(this.bold=i),d>=5&&(this.italic=s),d>=6&&(this.underline=o),d>=7&&(this.url=u),d>=8&&(this.target=a),d>=9&&(this.align=f),d>=10&&(this.leftMargin=l),d>=11&&(this.rightMargin=c),d>=12&&(this.indent=h),d>=13&&(this.leading=p)},e.align="left",e.blockIndent=0,e.bold=!1,e.color=0,e.font="",e.indent=0,e.italic=!1,e.kerning=!1,e.leading=0,e.leftMargin=0,e.letterSpacing=0,e.rightMargin=0,e.size=12,e.underline=!1,e.toString=function(){return"[object TextFormat]"}});return t}),herlock.define("module/view_css/flash/text/TextFieldAutoSize",[],function(){var e={NONE:"none",CENTER:"center",LEFT:"left",RIGHT:"right"};return e}),herlock.define("module/view_css/flash/text/TextFormatAlign",[],function(){var e={LEFT:"left",CENTER:"center",RIGHT:"right",JUSTIFY:"justify"};return e}),herlock.define("module/view_css/flash/text/TextField",["lib/Class","../display/InteractiveObject","./TextFormat","./TextFieldAutoSize","./TextFormatAlign","module/graphics/BitmapProxy","../internal/renderer/RenderingNode","../internal/renderer/CSSRenderingObject"],function(e,t,n,r,i,s,o,u){function f(e,t){return parseInt(t*255)*16777216+e}var a=2,l=e(t,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments),this._text="",this._drawTextRequested=!0,this._calcTextRequested=!0,this._bitmapProxy=null,this._textureImageHandle=null,this._autoSize=r.NONE,this._background=!1,this._backgroundColor=16777215,this._border=!1,this._borderColor=0,this._defaultTextFormat=null,this._multiline=!1,this._wordWrap=!1,this._scrollH=0,this._scrollV=0,this._maxScrollH=0,this._maxScrollV=0,this._maxChars=0,this._bottomScrollV=0,this._naturalRect.height=100,this._naturalRect.width=100,this._defaultTextFormat=new n,this._bitmapProxy=s.create(10,10)},e.autoSize={get:function(){return this._autoSize},set:function(e){if(this._autoSize==e)return;this._autoSize=e,this._requestCalcNaturalRect()}},e.background={get:function(){return this._background},set:function(e){if(this._background==e)return;this._background=e,this._requestCalcAndDrawText()}},e.backgroundColor={get:function(){return this._backgroundColor},set:function(e){if(this._backgroundColor==e)return;this._backgroundColor=e,this._requestCalcAndDrawText()}},e.border={get:function(){return this._border},set:function(e){if(this._border==e)return;this._border=e,this._requestCalcAndDrawText()}},e.borderColor={get:function(){return this._borderColor},set:function(e){if(this._borderColor==e)return;this._borderColor=e,this._requestCalcAndDrawText()}},e.bottomScrollV={get:function(){return this._bottomScrollV}},e.defaultTextFormat={get:function(){return this._defaultTextFormat},set:function(e){this._defaultTextFormat!=null&&(delete this._defaultTextFormat,this._defaultTextFormat=null),this._defaultTextFormat=e,this._requestCalcAndDrawText()}},e.length={get:function(){return this._text.length}},e.maxChars={get:function(){return this._maxChars},set:function(e){this._=e}},e.maxScrollH={get:function(){return this._maxScrollH}},e.maxScrollV={get:function(){return this._maxScrollV}},e.multiline={get:function(){return this._multiline},set:function(e){if(this._multiline==e)return;this._multiline=e,this._requestCalcAndDrawText()}},e.numLines={get:function(){return this._calcTextRequested&&this._calcText(),this._numOfLines}},e.scrollH={get:function(){return this._scrollH},set:function(e){this._scrollH=e,this._requestCalcAndDrawText()}},e.scrollV={get:function(){return this._scrollV},set:function(e){this._scrollV=e,this._requestCalcAndDrawText()}},e.text={get:function(){return this._text},set:function(e){this._text=e,this._requestCalcAndDrawText(),this._requestCalcNaturalRect()}},e.textColor={get:function(){return this._defaultTextFormat.color},set:function(e){this._defaultTextFormat.color=e,this._requestCalcAndDrawText()}},e.textHeight={get:function(){return this._calcTextRequested&&this._calcText(),this._textRect.h}},e.textWidth={get:function(){return this._calcTextRequested&&this._calcText(),this._textRect.w}},e.type={get:function(){return this._type},set:function(e){this._type=e}},e.wordWrap={get:function(){return this._wordWrap},set:function(e){this._wordWrap=e,this._requestCalcAndDrawText()}},e.appendText=function(e){this._text+=e,this._requestCalcAndDrawText()},e.getTextFormat=function(){return this._defaultTextFormat},e.setTextFormat=function(e){this._defaultTextFormat&&(this._defaultTextFormat=null),this._defaultTextFormat=e,this._requestCalcAndDrawText()},e.height={get:function(){return this._getBoundsRect().height},set:function(e){if(this._naturalRect.height==e)return;this._naturalRect.height=e,this._requestCalcNaturalRect()}},e.width={get:function(){return this._getBoundsRect().width},set:function(e){if(this._naturalRect.width==e)return;this._naturalRect.width=e,this._requestCalcNaturalRect()}},e._requestCalcAndDrawText=function(){this._drawTextRequested=!0,this._calcTextRequested=!0},e._drawVectorGraphics=function(){},e._glPrepare=function(e){this._drawTextRequested&&this._drawText();var n=this._getRenderingNode();return n.bitmapProxy=this._bitmapProxy,t._glPrepare.call(this,e)},e._calculateNaturalRect=function(){this._calcTextRequested&&this._calcText();var e=this._defaultTextFormat;switch(this._autoSize){case r.NONE:break;case r.LEFT:var t=new Rectangle;t.width=this._textRect.width+a*2+this._defaultTextFormat.leftMargin+this._defaultTextFormat.blockIndent+this._defaultTextFormat.rightMargin,t.height=this._textRect.height+a*2,this._naturalRect=t;break;case r.CENTER:var n=this._naturalRect.width,t=new Rectangle;t.width=this._textRect.width+a*2+this._defaultTextFormat.leftMargin+this._defaultTextFormat.blockIndent+this._defaultTextFormat.rightMargin,t.height=this._textRect.height+a*2,this._naturalRect=t,this.x=this.x+(n-t.width)/2;break;case r.RIGHT:var n=this._naturalRect.width,t=new Rectangle;t.width=this._textRect.width+a*2+this._defaultTextFormat.leftMargin+this._defaultTextFormat.blockIndent+this._defaultTextFormat.rightMargin,t.height=this._textRect.height+a*2,this._naturalRect=t,this.x=this.x+(n-t.width)}},e._requestCalcNaturalRect=function(e){if(e)return;this._requestCalcAndDrawText(),t._requestCalcNaturalRect.call(this,e)},e._drawText=function(){var e=this._getMatrix();if(e._getScaleX()==0||e._getScaleY()==0)return;var t=this._getNaturalRect(),n=new Rectangle(0,0,e._getScaleX()*t.width,e._getScaleY()*t.height);this._drawTextRequested=!1;if(!this._bitmapProxy||n.width!=this._bitmapProxy.width()||n.height!=this._bitmapProxy.height())this._bitmapProxy=s.create(n.width,n.height);var r=this._bitmapProxy.getCanvas();this._background?(r.setFillColor(f(this._backgroundColor,1)),r.fillRect(0,0,this._bitmapProxy.width(),this._bitmapProxy.height())):r.clear(),this._border&&(r.setStrokeColor(f(this._borderColor,1)),r.strokeRect(0,0,this._bitmapProxy.width(),this._bitmapProxy.height())),r.setFillColor(f(this._defaultTextFormat.color,1)),r.setFontSize(this._defaultTextFormat.size*e._getScaleY()),r.setLetterSpacing(this._defaultTextFormat.letterSpacing);var o=this._calcTextLinePositions(),u=r.getFontMetrics(),l=u.ascent,c=u.descent,h=this._defaultTextFormat.leading,p=a+this._defaultTextFormat.leftMargin+this._defaultTextFormat.blockIndent,d=a,v=o.length;for(var m=0;m<v;m+=2){var g=o[m],y=o[m+1];if(g<0)continue;var b=this.text.substring(g,y+1);p=a+this._defaultTextFormat.leftMargin+this._defaultTextFormat.blockIndent;if(m==0||o[m-1]+1!=g)p+=this._defaultTextFormat.indent;switch(this._defaultTextFormat.align){case i.LEFT:break;case i.CENTER:var w=r.measureText(b);p+=(n.width-p-this._defaultTextFormat.rightMargin-w)/2;break;case i.RIGHT:var w=r.measureText(b);p+=n.width-p-this._defaultTextFormat.rightMargin-w;break;case i.JUSTIFY:}d=m/2*(-l+c+h),r.fillText(p,d,b)}},e._calcText=function(){calcTextRequested=!1;var e=this._getMatrix(),t=this._calcTextLinePositions(),n=this._bitmapProxy.getCanvas();n.setFontSize(this._defaultTextFormat.size*e._getScaleY()),n.setLetterSpacing(this._defaultTextFormat.letterSpacing),this._textRect=new Rectangle;if(this._wordWrap)this._textRect.width=this._naturalRect.width-(a*2+this._defaultTextFormat.leftMargin+this._defaultTextFormat.blockIndent+this._defaultTextFormat.rightMargin);else{var r=t.length;for(var i=0;i<r;i+=2){var s=t[i],o=t[i+1];if(s<0)continue;var u=this._text.substring(s,o+1),f=n.measureText(u);this._textRect.width<f&&(this._textRect.width=f)}}var l=n.getFontMetrics(),c=l.ascent,h=l.descent,p=this._defaultTextFormat.leading,d=t.length/2;this._textRect.height=(-c+h)*d+p*(d-1)},e._calcTextLinePositions=function(){var e=this._text,t=[];t.push(0);var n;n=0;for(;;){var r=e.indexOf("\r",n);if(r==-1)break;var i=r;i+1<e.length&&e.charAt(i+1)=="\n"?(t.push(i-1),t.push(i+2)):(t.push(i-1),t.push(i+1)),n=r+1}n=0;for(;;){var r=e.indexOf("\n",n);if(r==-1)break;var i=r;i-1>=0&&e.charAt(i-1)!="\r"&&(t.push(i-1),t.push(i+1)),n=r+1}t.push(e.length-1),t.sort(function(e,t){return e-t});if(this._wordWrap!=1)return t;var s=this._getConcatenatedMatrix(),o=new Rectangle(a,a,-a*2+s._getScaleX()*this._naturalRect.width-this._defaultTextFormat.leftMargin-this._defaultTextFormat.blockIndent-this._defaultTextFormat.rightMargin,-a*2+s._getScaleY()*this._naturalRect.height),u=this._bitmapProxy.getCanvas();u.setFontSize(this._defaultTextFormat.size*s._getScaleY()),u.setLetterSpacing(this._defaultTextFormat.letterSpacing);var f=t.slice(),l=0;while(l<f.length){var c=f[l];l++,c==-1&&(c=0);var h=f[l];l<f.length&&l++;var p=h-c+1,d=e.substring(c,h+1),v=u.breakText(d,o.width-this._defaultTextFormat.indent);while(v<p){t.push(c+v-1),t.push(c+v),c+=v,p=h-c+1;var d=e.substring(c,h+1);v=u.breakText(d,o.width);if(v==p)break}}return t.sort(function(e,t){return e-t}),t},e._createRenderingNode=function(){return new c},e.toString=function(){return'[object TextField name="'+this.name+'"]'}}),c=e(o,function(e,t){e.object,e.width,e.height,e.clippingRect=null,e.bitmapProxy=null,e.scale9Grid=null,e.constructor=function(){t.constructor.call(this),this.object=new u,this.clippingRect=new Rectangle,this.scale9Grid=new Rectangle},e.visit=function(e){if(!this.bitmapProxy)return;if(!this.visible||!e.parent.visible){t.visit.call(this,e);return}this.scale9Grid.isEmpty()&&t.visit.call(this,e);var n=this.concatenatedMatrix.clone(),r=this.object;r.bitmapProxy=this.bitmapProxy,r.blendMode=this.blendMode,r.maskNode=this.mask,r.colorTransform=this.concatenatedColorTransform,r.matrix=n,r.offsetX=0,r.offsetY=0,r.width=this.width,r.height=this.height,r.clippingRect=this.clippingRect,this.clippingRect.isEmpty()!=1&&(r.offsetX+=this.clippingRect.x,r.offsetY+=this.clippingRect.y,r.width=this.clippingRect.w,r.height=this.clippingRect.h),e.renderingRequests.push(r)}});return l}),herlock.define("module/view_css/flash/flash",["./display/DisplayObject","./display/InteractiveObject","./display/DisplayObjectContainer","./display/Sprite","./display/Stage","./display/BitmapData","./display/Bitmap","./text/TextField","./text/TextFieldAutoSize","./text/TextFormat","./geom/Transform","./events/InteractiveObjectTouchEvent"],function(e,t,n,r,i,s,o,u,a,f,l,c){var h={installTo:function(h){h.DisplayObject=e,h.InteractiveObject=t,h.DisplayObjectContainer=n,h.Sprite=r,h.Stage=i,h.BitmapData=s,h.Bitmap=o,h.TextField=u,h.TextFieldAutoSize=a,h.TextFormat=f,h.Transform=l,h.InteractiveObjectTouchEvent=c},initJs:function(e){e.Event.ENTER_FRAME="enterFrame",e.Event.EXIT_FRAME="exitFrame"}};return h}),herlock.define("module/view_css/geom/ColorTransform",["lib/Class"],function(e){function s(e,t,n){return e<<16|t<<8|n<<0}function o(e,t){return Math.round(t*255)<<24|e}function u(e){return e>>24&255}function a(e){return e>>16&255}function f(e){return e>>8&255}function l(e){return e>>0&255}var t=0,n=1,r=2,i=3,c=function(e,t,n,r,i,s,o,u){var a=arguments.length;if(a===0){this._version=Math.floor(Math.random()*1e7),this.__isInitialValue=!0,this._multiplier=[1,1,1,1],this._offset=[0,0,0,0];return}e=a>0?e:1,t=a>1?t:1,n=a>2?n:1,r=a>3?r:1,i=a>4?i:0,s=a>5?s:0,o=a>6?o:0,u=a>7?u:0,this._version=Math.floor(Math.random()*1e7),this.__isInitialValue=e==1&&t==1&&n==1&&r==1&&i==0&&s==0&&o==0&&u==0,this._multiplier=[e,t,n,r],this._offset=[i,s,o,u]};return c.prototype=Object.create({},{_increment:{writable:!0,value:function(){this._version++,this.__isInitialValue=!1}},_getVersion:{writable:!0,value:function(){return this._version}},_isInitialValue:{writable:!0,value:function(){return this.__isInitialValue}},color:{get:function(){return s(this._offset[t],this._offset[n],this._offset[r])},set:function(e){this._multiplier[t]=1,this._multiplier[n]=1,this._multiplier[r]=1,this._offset[t]=a(e),this._offset[n]=f(e),this._offset[r]=l(e),this._increment()}},alphaMultiplier:{get:function(){return this._multiplier[i]},set:function(e){this._multiplier[i]=e,this._increment()}},redMultiplier:{get:function(){return this._multiplier[t]},set:function(e){this._multiplier[t]=e,this._increment()}},greenMultiplier:{get:function(){return this._multiplier[n]},set:function(e){this._multiplier[n]=e,this._increment()}},blueMultiplier:{get:function(){return this._multiplier[r]},set:function(e){this._multiplier[r]=e,this._increment()}},alphaOffset:{get:function(){return this._offset[i]},set:function(e){this._offset[i]=e,this._increment()}},redOffset:{get:function(){return this._offset[t]},set:function(e){this._offset[t]=e,this._increment()}},greenOffset:{get:function(){return this._offset[n]},set:function(e){this._offset[n]=e,this._increment()}},blueOffset:{get:function(){return this._offset[r]},set:function(e){this._offset[r]=e,this._increment()}},clone:{writable:!0,value:function(){var e=new c(this._multiplier[t],this._multiplier[n],this._multiplier[r],this._multiplier[i],this._offset[t],this._offset[n],this._offset[r],this._offset[i]);return e._version=this._version,e}},concat:{writable:!0,value:function(e){if(e._isInitialValue())return;if(e._isInitialValue()){var s=e._multiplier,o=e._offset;this._multiplier[t]=s[t],this._multiplier[n]=s[n],this._multiplier[r]=s[r],this._multiplier[i]=s[i],this._offset[t]=o[t],this._offset[n]=o[n],this._offset[r]=o[r],this._offset[i]=o[i],this._increment()}else this._concat(e._multiplier,e._offset)}},_concat:{writable:!0,value:function(e,s){this._multiplier[t]*=e[t],this._multiplier[n]*=e[n],this._multiplier[r]*=e[r],this._multiplier[i]*=e[i],this._offset[t]=this._offset[t]*e[t]+s[t],this._offset[n]=this._offset[n]*e[n]+s[n],this._offset[r]=this._offset[r]*e[r]+s[r],this._offset[i]=this._offset[i]*e[i]+s[i],this._increment()}},_isAlphaTransform:{writable:!0,value:function(){return this._multiplier[i]!=1&&this._multiplier[t]==1&&this._multiplier[n]==1&&this._multiplier[r]==1&&this._offset[t]==0&&this._offset[n]==0&&this._offset[r]==0&&this._offset[i]==0}},_isColorTransform:{writable:!0,value:function(){return!this._isInitialValue()&&!this._isAlphaTransform()}},_getValueArray:{writable:!0,value:function(){var e=[];return e[0]=this._multiplier[t],e[1]=this._multiplier[n],e[2]=this._multiplier[r],e[3]=this._multiplier[i],e[4]=this._offset[t]/255,e[5]=this._offset[n]/255,e[6]=this._offset[r]/255,e[7]=this._offset[i]/255,e}}}),c}),herlock.define("module/view_css/geom/geom",["./Point","./Rectangle","./Matrix","./ColorTransform"],function(e,t,n,r){var i={installTo:function(i){i.Point=e,i.Rectangle=t,i.Matrix=n,i.ColorTransform=r},initJs:function(e){}};return i}),window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame,function(){var e=document.createElement("div").style,t={transform:"webkitTransform"in e?"webkitTransform":"MozTransform"in e?"MozTransform":"transform",transformOrigin:"webkitTransformOrigin"in e?"webkitTransformOrigin":"MozTransformOrigin"in e?"MozTransformOrigin":"transformOrigin"};"webkitTransform"in e?window.__setTransform=function(e,t){e.webkitTransform=t}:"MozTransform"in e?window.__setTransform=function(e,t){e.MozTransform=t}:"transform"in e&&(window.__setTransform=function(e,t){e.transform=t});if("transformOrigin"in e)return;var n={};for(var r in t)(function(e,t){n[e]={get:function(){return this[t]},set:function(e){this[t]=e}}})(r,t[r]);Object.defineProperties(CSSStyleDeclaration.prototype,n)}(),herlock.define("module/view_css/NJView",["lib/Class","module/NJModule","./window/window","./layer/Layer","./image/Image","./flash/flash","./geom/geom","./geom/Rectangle","module/view/touch/TouchEventInfo","./flash/internal/renderer/CSSRenderingSystem"],function(e,t,n,r,i,s,o,u,a,f){var l=e(t,function(e,t){e.constructor=function(e,n,r){t.constructor.apply(this,arguments),f.container=this._container=e,f.width=this._width=n,f.height=this._height=r,this._layers=[];var i=this;requestAnimationFrame(function(){i._onDrawFrame(),requestAnimationFrame(arguments.callee)});var s=!1,o=function(e){var t,n=!0;switch(e.type){case"mousedown":s=!0,t=a.DOWN;break;case"mousemove":if(!s)return;t=a.MOVE;break;case"mouseup":s=!1,t=a.UP,n=!1;break;case"mouseleave":if(!s)return;s=!1,t=a.CANCEL,n=!1}var r=new a(t);if(!touchEnabled&&e.type.indexOf("mouse")!==-1){var o,u;o=e.clientX-e.currentTarget.offsetLeft,u=e.clientY-e.currentTarget.offsetTop;if(this.style.transform!==""){var f={x:o,y:u},l=this.style.transform,c=[],h;l.indexOf("matrix")!==-1&&l.split(",").forEach(function(e){c.push(parseFloat(e))}),l.indexOf("scale")!==-1&&(h=l.split("scale(")[1].split(","))&&(c=[parseFloat(h[0]),0,0,parseFloat(h[1]),0,0]),o=f.x*c[0]+f.y*c[2]+1*c[4],u=f.x*c[1]+f.y*c[3]+1*c[5]}r.addTouchPoint("mouse",o,u,!0,n)}else if(e.type.indexOf("touch")!==-1){touchEnabled=!0;var p=e.touches,d=e.changedTouches;for(var v=0;v<p.length;v++){var m=p[v],o,u;o=m.clientX-e.currentTarget.offsetLeft,u=m.clientY-e.currentTarget.offsetTop;if(this.style.transform!==""){var f={x:o,y:u},l=this.style.transform,c=[],h;l.indexOf("matrix")!==-1&&l.split(",").forEach(function(e){c.push(parseFloat(e))}),l.indexOf("scale")!==-1&&(h=l.split("scale(")[1].split(","))&&(c=[parseFloat(h[0]),0,0,parseFloat(h[1]),0,0]),o=f.x*c[0]+f.y*c[2]+1*c[4],u=f.x*c[1]+f.y*c[3]+1*c[5]}r.addTouchPoint(m.identifier,o,u,!1,!0)}for(var v=0;v<d.length;v++){var m=d[v],o,u;o=m.clientX-e.currentTarget.offsetLeft,u=m.clientY-e.currentTarget.offsetTop;if(this.style.transform!==""){var f={x:o,y:u},l=this.style.transform,c=[],h;l.indexOf("matrix")!==-1&&l.split(",").forEach(function(e){c.push(parseFloat(e))}),l.indexOf("scale")!==-1&&(h=l.split("scale(")[1].split(","))&&(c=[parseFloat(h[0]),0,0,parseFloat(h[1]),0,0]),o=f.x*c[0]+f.y*c[2]+1*c[4],u=f.x*c[1]+f.y*c[3]+1*c[5]}r.addTouchPoint(m.identifier,o,u,!0,n)}}i._notifyTouch(r)};this._container.addEventListener("touchstart",o),this._container.addEventListener("touchend",o),this._container.addEventListener("touchmove",o),this._container.addEventListener("touchcancel",o),this._container.addEventListener("mousemove",o),this._container.addEventListener("mouseup",o),this._container.addEventListener("mousedown",o),this._container.addEventListener("mouseleave",o)},e.getName=function(){return"View"},e.installTo=function(e){n.installTo(e,this),e.Layer=r,e.Image=i,s.installTo(e),o.installTo(e)},e.initJs=function(e){n.initJs(e),s.initJs(e),o.initJs(e)},e.start=function(){},e.reset=function(){},e.addLayer=function(e){return this.addLayerAt(e,this._layers.length)},e.addLayerAt=function(e,t){var n=e.isInstanceOf(r)?e:new r(e);return this.getLayerIndex(n)!=-1&&this.removeLayer(n),this._layers.splice(t,0,n),n._addedTo(this),n},e.getLayerAt=function(e){return this._layers[e]},e.getLayerIndex=function(e){return this._layers.indexOf(e)},e.removeLayer=function(e){return this.removeLayerAt(this._layers.indexOf(e))},e.removeLayerAt=function(e){var t=this.getLayerAt(e);return this._layers.splice(e,1),t},e.getViewWidth=function(){return this._width},e.getViewHeight=function(){return this._height},e.getViewTop=function(){return 0},e.getViewLeft=function(){return 0},e._onDrawFrame=function(){var e=this._glPrepare();this._glRender(e),this._notifyDrawFrame()},e._glPrepare=function(){if(this._layers.length<=0)return;var e=this._layers.length,t=[];for(var n=0;n<e;n++){var r=this._layers[n]._glPrepare();r&&t.push(r)}return t},e._glRender=function(e){if(this._layers.length<=0)return;var t=e.length;for(var n=0;n<t;n++)e[n].processData();for(var n=0;n<t;n++){var r=e[n];r.render()}},e._notifyDrawFrame=function(){for(var e in this._layers)this._layers[e]._notifyDrawFrame()},e._notifyTouch=function(e){var t=this._layers.slice(),n=t.length;for(var r=0;r<n;r++)t[r]._notifyTouch(e)}});return l}),herlock.define("module/view_canvas/window/window",[],function(){var e={installTo:function(e,t){e.addLayer=function(e){return t.addLayer(e)},e.addLayerAt=function(e,n){return t.addLayer(e,n)},e.getLayerAt=function(e){return t.getLayerAt(e)},e.getLayerIndex=function(e){return t.getLayerIndex(e)},e.removeLayer=function(e){return t.removeLayer(e)},e.removeLayerAt=function(e){return t.removeLayerAt(e)},e.innerWidth=t.getViewWidth();try{Object.defineProperties(e,{innerWidth:{get:function(){return t.getViewWidth()}},innerHeight:{get:function(){return t.getViewHeight()}}})}catch(n){console.log("SafariはinnerWidth,innerHeightが更新できません。"),e.innerWidth=t.getViewWidth(),e.innerHeight=t.getViewHeight()}e.setOrientationType=function(){}},initJs:function(e){}};return e}),herlock.define("module/view_canvas/layer/Layer",["lib/Class","module/view/touch/TouchEventInfo"],function(e,t){var n=e(Object,function(e,t){e.constructor=function(e){t.constructor.apply(this,arguments),this._content=null,this._renderingObject=new r,this._calcRequested=!0,this._horizontalAlign=n.Align.CENTER,this._verticalAlign=n.Align.MIDDLE,this._scaleMode=n.ScaleMode.SHOW_ALL,this._colorTransform=new ColorTransform,this._backgroundColor=16777215,this._backgroundAlpha=0,this._offsetPercentX=0,this._offsetPercentY=0,this._module=null,this._matrix=new Matrix,this._contentMatrix=new Matrix,this._contentDisplayRect=new Rectangle,e&&(this.content=e)},e.content={get:function(){return this._content},set:function(e){this._content!=null&&this._content._onRemovedFrom(this),this._calcRequested=!0,this._content=e,e!=null&&this._content._onAddedTo(this)}},e.contentScaleX={get:function(){return this._getContentMatrix()._getScaleX()}},e.contentScaleY={get:function(){return this._getContentMatrix()._getScaleY()}},e.horizontalAlign={get:function(){return this._horizontalAlign},set:function(e){this._horizontalAlign=e,this._calcRequested=!0}},e.verticalAlign={get:function(){return this._verticalAlign},set:function(e){this._verticalAlign=e,this._calcRequested=!0}},e.scaleMode={get:function(){return this._scaleMode},set:function(e){this._scaleMode=e,this._calcRequested=!0}},e.offsetX={get:function(){return this._offsetPercentX},set:function(e){this._offsetPercentX=e,this._calcRequested=!0}},e.offsetY={get:function(){return this._offsetPercentY},set:function(e){this._offsetPercentY=e,this._calcRequested=!0}},e.alpha={get:function(){return this._colorTransform.getAlphaMultiplier()},set:function(e){this._colorTransform.getAlphaMultiplier(e)}},e.backgroundColor={get:function(){return this._backgroundColor},set:function(e){this._backgroundColor=e}},e.backgroundAlpha={get:function(){return this._backgroundAlpha},set:function(e){this._backgroundAlpha=e}},e._notifyDrawFrame=function(){this._content&&this._content._notifyDrawFrame()},e._addedTo=function(e){this._module=e,calcRequested=!0},e._removedFrom=function(e){this._module=null},e._notifyResizeView=function(e,t){this._content!=null&&this._content._notifyResizeView(e,t),this._calcRequested=!0},e._notifyResizeContent=function(){this._calcRequested=!0},e._notifyTouch=function(e){if(!this._content)return;this._content._dispatchTouchEvent(e)},e._calculate=function(){if(this._module==null)return;if(this._content==null)return;this._calcRequested=!1;var e=this._module.getViewWidth(),t=this._module.getViewHeight(),r=e/t,i=this._content._getContentWidth(),s=this._content._getContentHeight(),o=i/s;if(this._scaleMode==n.ScaleMode.EXACT_FIT)this._contentMatrix._setScaleX(e/i),this._contentMatrix._setScaleY(t/s);else if(this._scaleMode==n.ScaleMode.SHOW_ALL){var u;r<o?u=e/i:u=t/s,this._contentMatrix._setScaleX(u),this._contentMatrix._setScaleY(u)}else if(this._scaleMode==n.ScaleMode.NO_BORDER){var u;r>o?u=e/i:u=t/s,this._contentMatrix._setScaleX(u),this._contentMatrix._setScaleY(u)}else this._scaleMode==n.ScaleMode.NO_SCALE&&(this._contentMatrix._setScaleX(1),this._contentMatrix._setScaleY(1));this._matrix._setX(e*this._offsetPercentX),this._matrix._setY(t*this._offsetPercentY),this._contentDisplayRect.width=this._content._getContentWidth()*this._contentMatrix._getScaleX(),this._contentDisplayRect.height=this._content._getContentHeight()*this._contentMatrix._getScaleY(),this._contentDisplayRect.x=this._matrix._getX(),this._contentDisplayRect.y=this._matrix._getY();var a=0,f=0;this._horizontalAlign==n.Align.LEFT?a+=0:this._horizontalAlign==n.Align.CENTER?a+=.5*(e-this._contentDisplayRect.width):this._horizontalAlign==n.Align.RIGHT&&(a+=1*(e-this._contentDisplayRect.width)),this._verticalAlign==n.Align.TOP?f+=0:this._verticalAlign==n.Align.MIDDLE?f+=.5*(t-this._contentDisplayRect.height):this._verticalAlign==n.Align.BOTTOM&&(f+=1*(t-this._contentDisplayRect.height)),this._contentDisplayRect.x+=a,this._contentDisplayRect.y+=f,this._contentMatrix._setX(a),this._contentMatrix._setY(f)},e._getMatrix=function(){return this._calcRequested&&this._calculate(),this._matrix.clone()},e._getContentMatrix=function(){return this._calcRequested&&this._calculate(),this._contentMatrix.clone()},e._getContentDisplayRect=function(){return this._calcRequested&&this._calculate(),this._contentDisplayRect},e._glPrepare=function(){if(this._module==null)return null;if(this._content==null)return null;var e=new Matrix;return this._renderingObject.contentRenderingObject=this._content._glPrepare(e,this._colorTransform),this._renderingObject}});n.Align={TOP:"top",MIDDLE:"middle",BOTTOM:"bottom",LEFT:"left",CENTER:"center",RIGHT:"right",NONE:"none"},n.ScaleMode={EXACT_FIT:"exactFit",NO_BORDER:"noBorder",NO_SCALE:"noScale",SHOW_ALL:"showAll",MODE_NONE:"none"};var r=e(Object,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments)},e.viewport=null,e.contentRenderingObject=null,e.processData=function(){if(!this.contentRenderingObject)return;this.contentRenderingObject.processData()},e.renderOffscreen=function(){},e.render=function(){if(!this.contentRenderingObject)return;this.contentRenderingObject.render()}});return n}),herlock.define("module/view_canvas/image/Image",["lib/Class","module/common/event/EventDispatcher","lib/URL","module/graphics/BitmapProxy"],function(e,t,n,r){var i=e(t,function(e,t){e.constructor=function(e){t.constructor.apply(this,arguments),this._src="",this._bitmapProxy=null,e&&(this.src=e)},e.src={get:function(){this._src},set:function(e){this._src=e;var t=new n(e);this._image=null;var i=document.createElement("img"),s=window.__herlock_ctx,o=this;i.onload=function(){o._image=i,o._bitmapProxy=new r(o._image),o._dispatchEventAndCallHandler(new Event("load"))},i.src=t.host===""?s._rootPath+t:t.toString()}},e.complete={get:function(){}},e.width={get:function(){return this._image?this._image.width:0}},e.height={get:function(){return this._image?this._image.height:0}},e.naturalWidth={get:function(){return this._image?this._image.width:0}},e.naturalHeight={get:function(){return this._image?this._image.height:0}},e.onload=function(){},e.onerror=function(){},e._getBitmap=function(){return this._bitmapProxy}});return i}),herlock.define("module/view_canvas/flash/internal/renderer/RenderingNode",["lib/Class","module/view/flash/display/BlendMode","module/view/geom/Matrix","module/view/geom/ColorTransform"],function(e,t,n,r){var i=e(Object,function(e,i){e.constructor=function(){i.constructor.apply(this,arguments),this._matrix=new n,this._colorTransform=new r,this.children=[],this.concatenatedMatrix=new n,this.concatenatedColorTransform=new r,this.concatenatedBlendMode="normal"},e.mask=null,e.visible=!0,e.cacheAsBitmap=!1,e.matrixIsUpdated=!1,e.concatenatedMatrixIsUpdated=!1,e.colorTransformIsUpdated=!1,e.concatenatedColorTransformIsUpdated=!1,e.blendMode="normal",e.setMatrix=function(e){if(this._matrix._getVersion()==e._getVersion()){this.matrixIsUpdated=!1;return}this._matrix=e.clone(),this.matrixIsUpdated=!0},e.getMatrix=function(){return this._matrix.clone()},e.setColorTransform=function(e){if(this._colorTransform._getVersion()==e._getVersion()){this.colorTransformIsUpdated=!1;return}this._colorTransform=e.clone(),this.colorTransformIsUpdated=!0},e.getColorTransform=function(){return this._colorTransform},e.visit=function(e){var n=e.parent;n.concatenatedMatrixIsUpdated||this.matrixIsUpdated?(this.concatenatedMatrix=this.getMatrix(),this.concatenatedMatrix.concat(n.concatenatedMatrix),this.concatenatedMatrixIsUpdated=!0):this.concatenatedMatrixIsUpdated=!1,n.concatenatedColorTransformIsUpdated||this.colorTransformIsUpdated?(this.concatenatedColorTransform=this._colorTransform,this.concatenatedColorTransform.concat(n.concatenatedColorTransform),this.concatenatedColorTransformIsUpdated=!0):this.concatenatedColorTransformIsUpdated=!1,this.visible=this.visible&&n.visible,this.mask=n.mask?n.mask:this.mask,this.blendMode=this.blendMode==t.NORMAL?n.blendMode:this.blendMode,e.parent=this;var r=this.children.length;for(var i=0;i<r;++i)this.children[i].visit(e.clone())},e.getBoundingBox=function(e){if(!this.visible)return;var t=this.children.length;for(var n=0;n<t;++n)this.children[n].getBoundingBox(e)}});return i}),herlock.define("module/view_canvas/flash/display/BlendMode",[],function(){var e={NORMAL:"normal",ADD:"add"};return e}),herlock.define("module/view_canvas/flash/geom/Transform",["lib/Class"],function(e){var t=e(Object,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments)},e.colorTransform={get:function(){return this._owner?this._owner._colorTransform.clone():new ColorTransform},set:function(e){if(!this._owner)return;!this._owner._setColorTransform(e)}},e.concatenatedColorTransform={get:function(){return}},e.concatenatedMatrix={get:function(){return}},e.matrix={get:function(){return this._owner?this._owner._matrix.clone():new Matrix},set:function(e){if(!this._owner)return;!this._owner._setMatrix(e)}},e._initwithOwner=function(e){this._owner=e},e._getOwner=function(){return this._owner}});return t}),herlock.define("module/view_canvas/flash/display/DisplayObject",["lib/Class","module/common/event/EventDispatcher","../internal/renderer/RenderingNode","./BlendMode","../geom/Transform","module/view/geom/Point","module/view/geom/Rectangle","module/view/geom/Matrix","module/view/geom/ColorTransform"],function(e,t,n,r,i,s,o,u,a){var f=Math.PI,l=e(t,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments),this._colorTransform=new a,this._naturalRect=new o,this._boundsRect=new o,this._matrix=new u,this._transformationPoint=null,this._scale9Grid=new o},e._blendMode=r.NORMAL,e._cacheAsBitmap=!1,e._cacheHandle=null,e._visible=!0,e._parent=null,e._mask=null,e._containable=!1,e._interactive=!1,e._xValue=0,e._yValue=0,e._scaleXValue=1,e._scaleYValue=1,e._rotationValue=0,e._skewXValue=0,e._skewYValue=0,e._calcNaturalRectRequested=!0,e._calcBoundsRectRequested=!0,e._calcMatrixRequested=!0,e._enabledTransformationPoint=!1,e.alpha={get:function(){return this._colorTransform.alphaMultiplier},set:function(e){this._colorTransform.alphaMultiplier=e}},e.blendMode={get:function(){return this._blendMode},set:function(e){this._blendMode=e}},e.cacheAsBitmap={get:function(){return this._cacheAsBitmap},set:function(e){this._cacheAsBitmap=e}},e.height={get:function(){return this._getBoundsRect().height},set:function(e){this.scaleY=this.scaleY*e/this.height}},e.mask={get:function(){this._mask},set:function(e){this._mask=e}},e.name="",e.parent={get:function(){return this._parent}},e.root={get:function(){return this._parent?this._parent.root:this}},e.scale9Grid={get:function(){return this._scale9Grid.clone()},set:function(e){e===null?this._scale9Grid.setEmpty():this._scale9Grid=e}},e.rotation={get:function(){return this._rotationValue},set:function(e){if(this._enabledTransformationPoint){this._setRotationWithTransformPoint(e,this.transformationPoint);return}while(e>180)e-=360;while(e<-180)e+=360;this._rotationValue=e;var t=new u;t._setSkewX(this._skewXValue),t._setSkewY(this._skewYValue),t.rotate((this._rotationValue-t._getRotation())/180*f),this._skewXValue=t._getSkewX(),this._skewYValue=t._getSkewY(),this._requestCalcNaturalRect()}},e._setRotationWithTransformPoint=function(e,t){var n=this._getMatrix(),r=n.transformPoint(t);while(e>180)e-=360;while(e<-180)e+=360;this._rotationValue=e;var i=new u;i._setSkewX(this._skewXValue),i._setSkewY(this._skewYValue),i.rotate((this._rotationValue-i._getRotation())/180*f),this._skewXValue=i._getSkewX(),this._skewYValue=i._getSkewY(),this._requestCalcNaturalRect(),n=this._getMatrix();var i=n.transformPoint(t);this._xValue+=r.x-i.x,this._yValue+=r.y-i.y,this._requestCalcNaturalRect()},e.scaleX={get:function(){return this._scaleXValue},set:function(e){if(this._scaleXValue===e)return;if(this._enabledTransformationPoint){this._setScaleXWithTransformPoint(e,this._transformationPoint);return}isNaN(e)&&console.error("debug scaleX",this,e),this._scaleXValue=e,this._requestCalcNaturalRect()}},e._setScaleXWithTransformPoint=function(e,t){var n=this._getMatrix(),r=n.transformPoint(t);this._scaleXValue=e,this._requestCalcNaturalRect(),n=this._getMatrix();var i=n.transformPoint(t);this._xValue+=r.x-i.x,this._yValue+=r.y-i.y,this._requestCalcNaturalRect()},e.scaleY={get:function(){return this._scaleYValue},set:function(e){if(this._scaleYValue===e)return;if(this._enabledTransformationPoint){this._setScaleYWithTransformPoint(e,this._transformationPoint);return}this._scaleYValue=e,this._requestCalcNaturalRect()}},e._setScaleYWithTransformPoint=function(e,t){var n=this._getMatrix(),r=n.transformPoint(t);this._scaleYValue=e,this._requestCalcNaturalRect(),n=this._getMatrix();var i=n.transformPoint(t);this._xValue+=r.x-i.x,this._yValue+=r.y-i.y,this._requestCalcNaturalRect()},e.stage={get:function(){return this._parent?this._parent.stage:null}},e.transform={get:function(){var e=new i;return e._initwithOwner(this),e},set:function(e){this._setColorTransform(e.getColorTransform()),this._setMatrix(e.getMatrix()),requestCalcNaturalRect()}},e.visible={get:function(){return this._visible},set:function(e){if(this._visible==e)return;this._visible=e,this._requestCalcNaturalRect()}},e.width={get:function(){return this._getBoundsRect().width},set:function(e){this.scaleX=this.scaleX*e/this.width}},e.x={get:function(){return this._xValue},set:function(e){if(this._xValue===e)return;this._xValue=e,this._requestCalcNaturalRect()}},e.y={get:function(){return this._yValue},set:function(e){if(this._yValue===e)return;this._yValue=e,this._requestCalcNaturalRect()}},e.getBounds=function(e){e||(e=this);var t=this._getConcatenatedMatrix(),n=e._getConcatenatedMatrix();n.invert(),t.concat(n);var r=this._getNaturalRect(),i=t._calculateBoundsRect(r);return i},e.getRect=function(e){return getBounds(e)},e.globalToLocal=function(e){var t=this._getConcatenatedMatrix();return t.invert(),t.transformPoint(e)},e.hitTestObject=function(e){var t=this._getNaturalRect(),n=this._getConcatenatedMatrix()._calculateBoundsRect(t);t=e._getNaturalRect();var r=e._getConcatenatedMatrix()._calculateBoundsRect(t),i=n.containsRect(r)||n.intersects(r);return i},e.hitTestPoint=function(e,t,n){var r=this.stage;if(!r)return!1;if(n){var i=this.getBounds(r);return i.containsPoint(new s(e,t))}var i=this.getBounds(r);return i.containsPoint(new s(e,t))},e.localToGlobal=function(e){return this._getConcatenatedMatrix().transformPoint(e)},e.transformationPoint={get:function(){return this._transformationPoint?this._transformationPoint.clone():new s(0,0)},set:function(e){this._transformationPoint=e.clone(),this._enabledTransformationPoint=!0,e.x==0&&e.y==0&&(this._enabledTransformationPoint=!1)}},e._getMatrix=function(){return this._getMatrixRef().clone()},e._getMatrixRef=function(){return this._calcMatrixRequested&&(this._calcMatrixRequested=!1,this._matrix.identity(),this._matrix.scale(this._scaleXValue,this._scaleYValue),this._skewXValue!=this._skewYValue?(this._matrix._setSkewX(this._skewXValue),this._matrix._setSkewY(this._skewYValue)):this._matrix.rotate(this._rotationValue/180*f),this._matrix.translate(this._xValue,this._yValue)),this._matrix},e._setMatrix=function(e){this._xValue=e._getX(),this._yValue=e._getY(),this._rotationValue=e._getRotation(),this._scaleXValue=e._getScaleX(),this._scaleYValue=e._getScaleY(),this._skewXValue=e._getSkewX(),this._skewYValue=e._getSkewY(),this._requestCalcNaturalRect()},e._getColorTransform=function(){return this._colorTransform.clone()},e._getColorTransformRef=function(){return this._colorTransform},e._setColorTransform=function(e){this._colorTransform=e},e._getConcatenatedMatrix=function(){var e=this._getMatrix(),t=this.parent;while(t){var n=t._getMatrix();e.concat(n),t=t.parent}return e},e._getConcatenatedColorTransform=function(){},e._setParent=function(e){this._parent!=null&&(this._parent=null);if(e==null)return;this._parent=e},e._notifyOnAddedToStage=function(){this._hasEventListener("addedToStage")&&this.dispatchEvent(new Event("addedToStage"))},e._notifyOnRemovedFromStage=function(){this._hasEventListener("removedFromStage")&&this.dispatchEvent(new Event("removedFromStage"))},e._notifyOnEnterFrame=function(){this._hasEventListener("enterFrame")&&this.dispatchEvent(new Event("enterFrame"))},e._notifyOnFrameConstructed=function(){},e._notifyOnExecuteFrameScript=function(){},e._notifyOnExitFrame=function(){this._hasEventListener("exitFrame")&&this.dispatchEvent(new Event("exitFrame"))},e._drawVectorGraphics=function(){},e._glPrepare=function(e){var t=this._getRenderingNode();return t.visible=this.visible,t.setMatrix(this._getMatrixRef()),t.setColorTransform(this._getColorTransform()),t.blendMode=this._blendMode,this._mask!=null?t.mask=this._mask._getRenderingNode():this._mask==null&&!!t.mask&&(t.mask=null),t},e._getNaturalRect=function(){return this._calcNaturalRectRequested&&(this._calcNaturalRectRequested=!1,this._calculateNaturalRect()),this._naturalRect},e._calculateNaturalRect=function(){this._naturalRect.setEmpty()},e._requestCalcNaturalRect=function(e){if(e==1)return;if(this._calcMatrixRequested)return;this._calcMatrixRequested=!0,this._calcNaturalRectRequested=!0,this._calcBoundsRectRequested=!0,this._parent!==null&&this._parent._requestCalcNaturalRect()},e._getBoundsRect=function(){if(this._calcBoundsRectRequested){this._calcBoundsRectRequested=!1;var e=this._getNaturalRect();this._boundsRect=this._getMatrix()._calculateBoundsRect(e),isNaN(this._boundsRect.width)&&console.error("debug",this,this._boundsRect)}return this._boundsRect},e._getNodesToRoot=function(){var e=[];if(this._parent==null)return e;var t=this;while(t!=null)e.push(t),t=t.parent;return e},e._hitTestStrictInternal=function(e){var t=this._getMatrix();t.invert();var n=t.transformPoint(e),r=this._getNaturalRect().containsPoint(n);if(r&&this.mask){var i=this.mask,s=i._getConcatenatedMatrix();s.invert(),n=this._getConcatenatedMatrix().transformPoint(n),n=s.transformPoint(n),r=i._getNaturalRect().containsPoint(n)}return r?this:null},e._renderingNode=null,e._getRenderingNode=function(){return this._renderingNode||(this._renderingNode=this._createRenderingNode()),this._renderingNode},e._createRenderingNode=function(){return new n},e.toString=function(){return'[object DisplayObject name="'+this.name+'"]'}});return l}),herlock.define("module/view_canvas/flash/display/InteractiveObject",["lib/Class","./DisplayObject"],function(e,t){var n=e(t,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments)},e.mouseEnabled=!0});return n}),herlock.define("module/view_canvas/flash/display/DisplayObjectContainer",["lib/Class","./InteractiveObject"],function(e,t){var n=e(t,function(e,n){e.constructor=function(){n.constructor.apply(this,arguments),this._children=[],this._updatedChildrenForWorkChildren=!0,this._updatedChildrenForRenderingNode=!0},e.numChildren={get:function(){return this._children.length}},e.mouseChildren=!0,e.addChild=function(e){return this.addChildAt(e,this._children.length)},e.addChildAt=function(e,t){if(!e)return console.log("warning: "+this+".addChild child="+e);if(t<0)return console.log("warning: out of range.");if(this._children.length<t)return console.log("warning: out of range.");e._parent&&e._parent.removeChild(e),this._children.splice(t,0,e),e._setParent(this),this._requestCalcNaturalRect(),this._childrenUpdated();var n=[],r=e._getNodesToRoot();for(var i=r.length-1;i>=0;i--)n.push(r[i]);return e._propagateEvent(new Event("added"),n),e.stage&&e._notifyOnAddedToStage(),e},e.getChildIndex=function(e){return this._children.indexOf(e)},e.getChildAt=function(e){return this._children.length<=e?null:this._children[e]},e.getChildByName=function(e){for(var t=this._children.length-1;t>=0;t--)if(this._children[t].name===e)return this._children[t];return null},e.removeChild=function(e){var t=this._children.indexOf(e);return t===-1?console.log("warning: "+this+".removeChild("+e+")"):this.removeChildAt(t)},e.removeChildAt=function(e){if(e<0)return console.log("warning: out of range.");if(this._children.length<=e)return console.log("warning: out of range.");var t=this._children[e],n=[],r=t._getNodesToRoot();for(var i=r.length-1;i>=0;i--)n.push(r[i]);return this._children.splice(e,1)[0],t._setParent(null),this._requestCalcNaturalRect(),this._childrenUpdated(),t._propagateEvent(new Event("removed"),n),t.stage||t._notifyOnRemovedFromStage(),t},e.contains=function(e){if(this===e)return!0;if(this._children.indexOf(e)!==-1)return!0;var t=this._children,n=t.length;for(var r=0;r<n;r++)if(t[r].contains(e))return!0;return!1},e.setChildIndex=function(e,t){this.addChildAt(e,t)},e.swapChildren=function(e,t){var n=this.getChildIndex(e),r=this.getChildIndex(t);if(n==-1||r==-1)return;this.addChildAt(e,r),this.addChildAt(t,n),this._childrenUpdated()},e.swapChildrenAt=function(e,t){var n=this.numChildren();if(e>=n||t>=n||e<0||t<0)return;this.swapChildren(this.getChildAt(e),this.getChildAt(t))},e._childrenUpdated=function(){this._updatedChildrenForWorkChildren=!0,this._updatedChildrenForRenderingNode=!0},e._notifyOnAddedToStage=function(){DisplayObject.prototype._notifyOnAddedToStage.call(this);var e=this._children.slice(),t=e.length;for(var n=0;n<t;n++)e[n]._notifyOnAddedToStage()},e._notifyOnRemovedFromStage=function(){DisplayObject.prototype._notifyOnRemovedFromStage.call(this);var e=this._children.slice(),t=e.length;for(var n=0;n<t;n++)e[n]._notifyOnRemovedFromStage()},e._notifyOnEnterFrame=function(){DisplayObject.prototype._notifyOnEnterFrame.call(this);var e=this._children.slice(),t=e.length;for(var n=0;n<t;n++)e[n]._notifyOnEnterFrame()},e._notifyOnFrameConstructed=function(){DisplayObject.prototype._notifyOnFrameConstructed.call(this);var e=this._children.slice(),t=e.length;for(var n=0;n<t;n++)e[n]._notifyOnFrameConstructed()},e._notifyOnExecuteFrameScript=function(){DisplayObject.prototype._notifyOnExecuteFrameScript.call(this);var e=this._children.slice(),t=e.length;for(var n=0;n<t;n++)e[n]._notifyOnExecuteFrameScript()},e._notifyOnExitFrame=function(){DisplayObject.prototype._notifyOnExitFrame.call(this);var e=this._children.slice(),t=e.length;for(var n=0;n<t;n++)e[n]._notifyOnExitFrame()},e._drawVectorGraphics=function(){DisplayObject.prototype._drawVectorGraphics.call(this);var e=this._children.slice(),t=e.length;for(var n=0;n<t;n++)e[n]._drawVectorGraphics()},e._glPrepare=function(e){var t=this._getRenderingNode(),n=this._children,r=n.length;if(this._updatedChildrenForRenderingNode){this._updatedChildrenForRenderingNode=!1;var i=t.children;i.length=0;for(var s=0;s<r;s++){var o=n[s]._glPrepare(e);if(o==null)continue;i.push(o)}}else for(var s=0;s<r;s++)n[s]._glPrepare(e);return DisplayObject.prototype._glPrepare.call(this,e)},e._calculateNaturalRect=function(){this._naturalRect.setEmpty();var e=this._children.slice(),t=e.length;for(var n=0;n<t;n++)e[n].visible&&(this._naturalRect=this._naturalRect.union(e[n]._getBoundsRect()))},e._hitTestStrictInternal=function(e){if(n._hitTestStrictInternal.call(this,e)==null)return null;var r=null,i=this._getMatrix();i.invert(),e=i.transformPoint(e);var s=!1;for(var o=this.numChildren-1;o>=0;o--){if(this.getChildAt(o).visible!=1)continue;r=this.getChildAt(o)._hitTestStrictInternal(e);if(r==null)continue;if(this.mouseChildren!=1)return this;if(r.isInstanceOf(t)!=1||r.mouseEnabled!=1){s=!0;continue}return r}return s?this:null},e.toString=function(){return'[object DisplayObjectContainer name="'+this.name+'"]'}});return n}),herlock.define("module/view_canvas/flash/display/Sprite",["lib/Class","./DisplayObjectContainer"],function(e,t){var n=e(t,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments)},e.toString=function(){return'[object Sprite name="'+this.name+'"]'}});return n}),herlock.define("module/view_canvas/flash/internal/renderer/CanvasRenderingSystem",["lib/Class"],function(e){function n(e,t){var n=e+"{";for(var r in t)n+=""+r+":"+t[r]+";";return n+="}",n}var t=e(Object,function(e,t){e._container=null,e.width=null,e.height=null,e.constructor=function(){this._canvas=document.createElement("canvas"),this._ctx=this._canvas.getContext("2d"),this._ctx.save(),this._idIncrementor=0,this._curr=[],this._prev=[],this._maskRect=null},e.container={get:function(){return this._container},set:function(e){this._container=e,this._container.appendChild(this._canvas)}},e.width={get:function(){return this._width},set:function(e){this._width=e,this._canvas.width=e}},e.height={get:function(){return this._height},set:function(e){this._height=e,this._canvas.height=e}},e.putBitmapProxy=function(e){},e.render=function(e){if(!e.bitmapProxy)return;var t=e.matrix,n=e.clippingRect,r=e.colorTransform.alphaMultiplier,i=e.maskNode,s=!i,o=null;s||(o=new Rectangle,i.getBoundingBox(o),s=o.isEmpty());if(s)this._maskRect&&(this._ctx.restore(),this._ctx.save(),this._maskRect=null);else if(!this._maskRect||this._maskRect.equals(o)!==!0)this._ctx.setTransform.apply(this._ctx,[1,0,0,1,0,0]),this._ctx.beginPath(),this._ctx.rect(o.x,o.y,o.width,o.height),this._ctx.clip(),this._maskRect=o;this._ctx.globalAlpha=r,this._ctx.setTransform.apply(this._ctx,t._values),n.isEmpty()?this._ctx.drawImage(e.bitmapProxy.getPixels(),0,0):this._ctx.drawImage(e.bitmapProxy.getPixels(),n.x,n.y,n.width,n.height,0,0,n.width,n.height)},e.begin=function(){this._ctx.restore(),this._ctx.clearRect(0,0,this._width,this._height),this._ctx.save()},e.end=function(){if(this._curr.length===this._prev.length){var e=!0;for(var t=0;t<this._curr.length;t++)e=e&&this._curr[t]===this._prev[t];if(e){this._prev=this._curr,this._curr=[];return}}for(var t in this._curr)this._fragment.appendChild(this._curr[t]);this.container.innerHTML="",this.container.appendChild(this._fragment),this._prev=this._curr,this._curr=[]}}),r=new t;return r}),herlock.define("module/view_canvas/flash/events/InteractiveObjectTouchEvent",["lib/Class","module/common/event/Event"],function(e,t){var n=e(t,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments);var e=arguments.length,n=arguments;this._touchPointID=e>3?n[3]:0,this._isPrimaryTouchPoint=e>4?n[4]:!1,this._localX=e>5?n[5]:0,this._localY=e>6?n[6]:0},e.isPrimaryTouchPoint={get:function(){return this._isPrimaryTouchPoint},set:function(e){this._isPrimaryTouchPoint=e}},e.localX={get:function(){return this._localX},set:function(e){this._localX=e}},e.localY={get:function(){return this._localY},set:function(e){this._localY=e}},e.touchPointID={get:function(){return this._touchPointID},set:function(e){this._touchPointID=e}},e.stageX={get:function(){if(this._hasStagePoint)return this._stagePoint.x;var e=this.target;return e.localToGlobal(new Point(this.localX,this.localY)).x}},e.stageY={get:function(){if(this._hasStagePoint)return this._stagePoint.y;var e=this.target;return e.localToGlobal(new Point(this.localX,this.localY)).y}},e._setStagePoint=function(e){return this._stagePoint=e,this._hasStagePoint=!0,this}});return n}),herlock.define("module/view_canvas/flash/display/Stage",["lib/Class","./Sprite","../internal/renderer/RenderingNode","../internal/renderer/CanvasRenderingSystem","module/view/touch/TouchEventInfo","../events/InteractiveObjectTouchEvent"],function(e,t,n,r,i,s){var o=e(t,function(e,t){e.constructor=function(e,n){t.constructor.apply(this,arguments),this._stageWidth=e||100,this._stageHeight=n||100,this._layer=null,this._frameRate=60,this._quality=null,this._offscreenHandle=null,this._primaryTouchId=-1,this._touchPointerStateDictionary={},this._layerContentRenderObject=null},e.frameRate={get:function(){return this._frameRate},set:function(e){}},e.stageWidth={get:function(){return this._stageWidth},set:function(e){this._stageWidth=e,this._layer!=null&&this._layer._notifyResizeContent()}},e.stageHeight={get:function(){return this._stageHeight},set:function(e){this._stageHeight=e,this._layer!=null&&this._layer._notifyResizeContent()}},e.stage={get:function(){return this}},e.height={get:function(){}},e.width={get:function(){}},e.layer={get:function(){}},e._getContentWidth=function(){return this.stageWidth},e._getContentHeight=function(){return this.stageHeight},e.getLayer=function(){return this._layer},e._onAddedTo=function(e){this._layer=e},e._onRemovedFrom=function(e){this._layer=NULL},e._glPrepare=function(e,t){this._layerContentRenderObject||(this._layerContentRenderObject=new a);var n={};this._layerContentRenderObject.root=DisplayObjectContainer.prototype._glPrepare.call(this,n);var r=new Matrix;return r.concat(this.getLayer()._getContentMatrix()),r.concat(this.getLayer()._getMatrix()),this._layerContentRenderObject.matrix._equal(r)||(this._layerContentRenderObject.matrix=r),this._layerContentRenderObject.colorTransform=t,this._layerContentRenderObject},e._notifyDrawFrame=function(){this._notifyOnEnterFrame(),this._drawVectorGraphics()},e._notifyResizeView=function(e,t){},e._dispatchTouchEvent=function(e){var t=e,n=t.getChangedPointers(),r=n.length;for(var i=0;i<r;i++)this._dispatchTouchEventWithChangedTouchPointer(t,n[i])},e._dispatchTouchEventWithChangedTouchPointer=function(e,t){var n=this._layer._getMatrix(),r=this._layer._getContentMatrix();r.concat(n),r.invert();var o=r.transformPoint(new Point(t.x,t.y)),u=this,a=u._hitTestStrictInternal(o);a||(a=this);var l=a,c=l.globalToLocal(o),h=[];h.push(l);var p=l.parent;while(p)h.unshift(p),p=p.parent;var d="";switch(e.getAction()){case i.DOWN:d="touchBegin";break;case i.MOVE:d="touchMove";break;case i.UP:d="touchEnd";break;case i.CANCEL:default:d="touchEnd"}Object.keys(this._touchPointerStateDictionary).length<=0&&(this._primaryTouchId=t.id);var v=this._primaryTouchId==t.id,m=(new s(d,!0,!0,t.id,v,c.x,c.y))._setStagePoint(o);m._setTarget(h[h.length-1]),h[h.length-1]._propagateEvent(m,h);var g=null,a=this._touchPointerStateDictionary[t.id];a&&(g=a,delete this._touchPointerStateDictionary[t.id]);switch(e.getAction()){case i.DOWN:var y=f.create(t.id,l,l);this._touchPointerStateDictionary[t.id]=y;var m=(new s("touchOver",!0,!0,t.id,v,c.x,c.y))._setStagePoint(o);m._setTarget(h[h.length-1]),h[h.length-1]._propagateEvent(m,h);var b=h.length;for(var w=0;w<b;w++){var m=(new s("touchRollOver",!0,!0,t.id,v,c.x,c.y))._setStagePoint(o);h[w].dispatchEvent(m)}break;case i.MOVE:var y=f.create(t.id,g&&g.beganFrom?g.beganFrom:null,l);this._touchPointerStateDictionary[t.id]=y;if(g&&g.overNow==l)break;var m=(new s("touchOut",!0,!0,t.id,v,c.x,c.y))._setStagePoint(o);m._setTarget(h[h.length-1]),h[h.length-1]._propagateEvent(m,h);var m=(new s("touchOver",!0,!0,t.id,v,c.x,c.y))._setStagePoint(o);m._setTarget(h[h.length-1]),h[h.length-1]._propagateEvent(m,h);var E=-1,u=l,S=[],x=[];if(g&&g.overNow){x=g.overNow._getNodesToRoot();var T=x.length;while(E==-1){S.push(u);for(var w=0;w<T;w++)if(x[w]==u){E=w;break}u=u.parent;if(!u)break}}if(E==-1)break;for(var w=E-1;w>=0;w--){var m=(new s("touchRollOut",!0,!0,t.id,v,c.x,c.y))._setStagePoint(o);x[w].dispatchEvent(m)}var N=S.length;for(var w=0;w<N;w++){var m=(new s("touchRollOver",!0,!0,t.id,v,c.x,c.y))._setStagePoint(o);S[w].dispatchEvent(m)}break;case i.UP:case i.CANCEL:default:var m=(new s("touchOut",!0,!0,t.id,v,c.x,c.y))._setStagePoint(o),C=[];if(g&&g.overNow){C.push(g.overNow);var p=g.overNow.parent;while(p)C.unshift(p),p=p.parent;m._setTarget(g.overNow)}var b=C.length;for(var w=0;w<b;w++){var m=(new s("touchRollOut",!0,!0,t.id,v,c.x,c.y))._setStagePoint(o);C[w].dispatchEvent(m)}if(e.getAction()!=i.CANCEL&&g&&g.beganFrom&&g.beganFrom===l){var m=(new s("touchTap",!0,!0,t.id,v,c.x,c.y))._setStagePoint(o);m._setTarget(h[h.length-1]),h[h.length-1]._propagateEvent(m,h)}this._primaryTouchId==t.id&&(this._primaryTouchId=-1)}},e.toString=function(){return'[object Stage stageWidth="'+this.stageWidth+'" stageHeight="'+this.stageHeight+'"]'}}),u=function(e){e=e||{},this.parent=e.parent||new n,this.offScreenRenderingRequests=e.offScreenRenderingRequests||[],this.renderingRequests=e.renderingRequests||[]};u.prototype={clone:function(){return new u(this)}};var a=e(Object,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments),this.visitor=new u,this.visitor.parent=new n,this.visitor.offScreenRenderingRequests=[],this.visitor.renderingRequests=[],this.matrix=new Matrix,this.colorTransform=new ColorTransform,this.root=null},e.processData=function(){var e=new Matrix,t=this.matrix.clone();t.concat(e),this.visitor.parent._matrix._getVersion()!==t._getVersion()?(this.visitor.parent.setMatrix(t),this.visitor.parent.concatenatedMatrix=this.visitor.parent.getMatrix(),this.visitor.parent.concatenatedMatrixIsUpdated=!0):(this.visitor.parent.setMatrix(t),this.visitor.parent.matrixIsUpdated=!1,this.visitor.parent.concatenatedMatrixIsUpdated=!1),this.visitor.offScreenRenderingRequests=[],this.visitor.renderingRequests=[],this.root.visit(this.visitor.clone())},e.renderOffscreen=function(){},e.render=function(){r.begin();var e=this.visitor.renderingRequests,t=e.length;for(var n=0;n<t;n++)r.render(e[n]);r.end()}}),f={create:function(e,t,n){return{pointerId:e,beganFrom:t,overNow:n}}};return o}),herlock.define("module/view_canvas/flash/display/BitmapData",["lib/Class","module/graphics/BitmapProxy"],function(e,t){function n(e){return typeof e=="number"}function r(e){return typeof e=="boolean"}var i=e(Object,function(e,i){e.constructor=function(){i.constructor.apply(this,arguments);var e=arguments,s=arguments.length,o=null;if(s>=2&&n(e[0])&&n(e[1])){var u=e[0],a=e[1],f=2046;if(u>=f||a>=f)throw new Error("Argument Error. over limit size!! please 2046 > size.");o=t.create(u,a);var l=!0,c=4294967295;s>=3&&r(e[2])&&(l=e[2]),s>=4&&n(e[3])&&(c=e[3]);var h=o.getCanvas();h.setFillColor(c),h.fillRect(0,0,u,a)}else{if(!(s>=1&&e[0].isInstanceOf&&e[0].isInstanceOf(Image)))throw new Error("Argument Error");o=e[0]._getBitmap()}this._bitmapProxy=o,this._sheetRow=null},e.width={get:function(){return this._bitmapProxy?this._bitmapProxy.width():0}},e.height={get:function(){return this._bitmapProxy?this._bitmapProxy.height():0}},e.transparent={get:function(){return!0}},e.rect={get:function(){return new Rectangle(0,0,this.width,this.height)}},e.dispose=function(){this._bitmapProxy=null},e._notifyEnterFrame=function(){},e._notifyFrameConstructed=function(){},e._notifyExecuteFrameScript=function(){},e._notifyExitFrame=function(){},e._notifyDrawVectorGraphics=function(){},e._glPrepare=function(){if(!this._bitmapProxy)return},e._notifyUpdateForBitmap=function(){},e._getCSSId=function(){return this._sheetRow.id},e.toString=function(){return'[object BitmapData width="'+this.width+'" height="'+this.height+'"]'}});return i}),herlock.define("module/view_canvas/flash/internal/renderer/CanvasRenderingObject",["lib/Class"],function(e){var t=0,n=e(Object,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments),this._bitmapProxy=null},e.bitmapProxy={get:function(){return this._bitmapProxy},set:function(e){if(this._bitmapProxy===e)return;this._bitmapProxy=e}},e.width=null,e.height=null,e.colorTransform=null,e.blendMode=null,e.maskNode=null,e.clippingRect=null,e.getTextureId=function(){return this.textureId}});return n}),herlock.define("module/view_canvas/flash/display/Bitmap",["lib/Class","./DisplayObject","../internal/renderer/RenderingNode","../internal/renderer/CanvasRenderingObject"],function(e,t,n,r){var i=e(t,function(e,n){e.constructor=function(e,t,r,i){n.constructor.apply(this,arguments);var s=arguments.length;this._bitmapData=e,this._pixelSnapping=s>1?t:!1,this._smoothing=s>2?r:!1,this._clippingRect=s>3?i:new Rectangle},e.bitmapData={get:function(){return this._bitmapData},set:function(e){this._bitmapData!=null&&(this._bitmapData=null),e!=null&&(this._bitmapData=e),this._requestCalcNaturalRect()}},e.setClippingRect=function(e){this._clippingRect=e,this._requestCalcNaturalRect()},e._calculateNaturalRect=function(){if(this.bitmapData==null){this._naturalRect.setEmpty();return}if(this._clippingRect.isEmpty()){this._naturalRect.width=this.bitmapData.width,this._naturalRect.height=this.bitmapData.height;return}this._naturalRect.width=this._clippingRect.width,this._naturalRect.height=this._clippingRect.height},e._glPrepare=function(e){var n=this._getRenderingNode();return n.children=[],this.bitmapData==null?t.prototype._glPrepare.call(this,e):(this.bitmapData._glPrepare(),n.scale9Grid=this.scale9Grid,n.clippingRect=this._clippingRect,n.width=this.bitmapData.width,n.height=this.bitmapData.height,n.bitmapProxy=this.bitmapData._bitmapProxy,t.prototype._glPrepare.call(this,e))},e._createRenderingNode=function(){return new s},e.toString=function(){return'[object Bitmap name="'+this.name+'"]'}}),s=e(n,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments),this._renderingObjects=[new r,new r,new r,new r,new r,new r,new r,new r,new r]},e.clippingRect=null,e.bitmapProxy=null,e.scale9Grid=null,e.width,e.height,e.setMatrix=function(e){t.setMatrix.call(this,e)},e.visit=function(e){if(!this.bitmapProxy)return;if(!this.visible||!e.parent.visible){n.prototype.visit.call(this,e);return}this.scale9Grid.isEmpty()&&n.prototype.visit.call(this,e);var t=this.concatenatedMatrix.clone(),r=this._renderingObjects[0];r.bitmapProxy=this.bitmapProxy,r.blendMode=this.blendMode,r.maskNode=this.mask,r.colorTransform=this.concatenatedColorTransform,r.matrix=t,r.offsetX=0,r.offsetY=0,r.width=this.width,r.height=this.height,r.clippingRect=this.clippingRect,this.clippingRect.isEmpty()!=1&&(r.offsetX+=this.clippingRect.x,r.offsetY+=this.clippingRect.y,r.width=this.clippingRect.w,r.height=this.clippingRect.h),e.renderingRequests.push(r)},e.getBoundingBox=function(e){var t=this.concatenatedMatrix,n=new Rectangle(0,0,this.bitmapProxy.width(),this.bitmapProxy.height());this.clippingRect.isEmpty()!==!0&&(n.width=this.clippingRect.width,n.height=this.clippingRect.height),n.x=0,n.y=0;var r=t._calculateBoundsRect(n),i=e.union(r);e._set(i.x,i.y,i.width,i.height)}});return i}),herlock.define("module/view_canvas/flash/text/TextFormat",["lib/Class"],function(e){var t=e(Object,function(e,t){e.constructor=function(e,n,r,i,s,o,u,a,f,l,c,h,p){t.constructor.apply(this,arguments);var d=arguments.length;d>=1&&(this.font=e),d>=2&&(this.size=n),d>=3&&(this.color=r),d>=4&&(this.bold=i),d>=5&&(this.italic=s),d>=6&&(this.underline=o),d>=7&&(this.url=u),d>=8&&(this.target=a),d>=9&&(this.align=f),d>=10&&(this.leftMargin=l),d>=11&&(this.rightMargin=c),d>=12&&(this.indent=h),d>=13&&(this.leading=p)},e.align="left",e.blockIndent=0,e.bold=!1,e.color=0,e.font="",e.indent=0,e.italic=!1,e.kerning=!1,e.leading=0,e.leftMargin=0,e.letterSpacing=0,e.rightMargin=0,e.size=12,e.underline=!1,e.toString=function(){return"[object TextFormat]"}});return t}),herlock.define("module/view_canvas/flash/text/TextFieldAutoSize",[],function(){var e={NONE:"none",CENTER:"center",LEFT:"left",RIGHT:"right"};return e}),herlock.define("module/view_canvas/flash/text/TextFormatAlign",[],function(){var e={LEFT:"left",CENTER:"center",RIGHT:"right",JUSTIFY:"justify"};return e}),herlock.define("module/view_canvas/flash/text/TextField",["lib/Class","../display/InteractiveObject","./TextFormat","./TextFieldAutoSize","./TextFormatAlign","module/graphics/BitmapProxy","../internal/renderer/RenderingNode","../internal/renderer/CanvasRenderingObject"],function(e,t,n,r,i,s,o,u){function f(e,t){return parseInt(t*255)*16777216+e}var a=2,l=e(t,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments),this._text="",this._drawTextRequested=!0,this._calcTextRequested=!0,this._bitmapProxy=null,this._textureImageHandle=null,this._autoSize=r.NONE,this._background=!1,this._backgroundColor=16777215,this._border=!1,this._borderColor=0,this._defaultTextFormat=null,this._multiline=!1,this._wordWrap=!1,this._scrollH=0,this._scrollV=0,this._maxScrollH=0,this._maxScrollV=0,this._maxChars=0,this._bottomScrollV=0,this._naturalRect.height=100,this._naturalRect.width=100,this._defaultTextFormat=new n,this._bitmapProxy=s.create(10,10)},e.autoSize={get:function(){return this._autoSize},set:function(e){if(this._autoSize==e)return;this._autoSize=e,this._requestCalcNaturalRect()}},e.background={get:function(){return this._background},set:function(e){if(this._background==e)return;this._background=e,this._requestCalcAndDrawText()}},e.backgroundColor={get:function(){return this._backgroundColor},set:function(e){if(this._backgroundColor==e)return;this._backgroundColor=e,this._requestCalcAndDrawText()}},e.border={get:function(){return this._border},set:function(e){if(this._border==e)return;this._border=e,this._requestCalcAndDrawText()}},e.borderColor={get:function(){return this._borderColor},set:function(e){if(this._borderColor==e)return;this._borderColor=e,this._requestCalcAndDrawText()}},e.bottomScrollV={get:function(){return this._bottomScrollV}},e.defaultTextFormat={get:function(){return this._defaultTextFormat},set:function(e){this._defaultTextFormat!=null&&(delete this._defaultTextFormat,this._defaultTextFormat=null),this._defaultTextFormat=e,this._requestCalcAndDrawText()}},e.length={get:function(){return this._text.length}},e.maxChars={get:function(){return this._maxChars},set:function(e){this._=e}},e.maxScrollH={get:function(){return this._maxScrollH}},e.maxScrollV={get:function(){return this._maxScrollV}},e.multiline={get:function(){return this._multiline},set:function(e){if(this._multiline==e)return;this._multiline=e,this._requestCalcAndDrawText()}},e.numLines={get:function(){return this._calcTextRequested&&this._calcText(),this._numOfLines}},e.scrollH={get:function(){return this._scrollH},set:function(e){this._scrollH=e,this._requestCalcAndDrawText()}},e.scrollV={get:function(){return this._scrollV},set:function(e){this._scrollV=e,this._requestCalcAndDrawText()}},e.text={get:function(){return this._text},set:function(e){this._text=e,this._requestCalcAndDrawText(),this._requestCalcNaturalRect()}},e.textColor={get:function(){return this._defaultTextFormat.color},set:function(e){this._defaultTextFormat.color=e,this._requestCalcAndDrawText()}},e.textHeight={get:function(){return this._calcTextRequested&&this._calcText(),this._textRect.h}},e.textWidth={get:function(){return this._calcTextRequested&&this._calcText(),this._textRect.w}},e.type={get:function(){return this._type},set:function(e){this._type=e}},e.wordWrap={get:function(){return this._wordWrap},set:function(e){this._wordWrap=e,this._requestCalcAndDrawText()}},e.appendText=function(e){this._text+=e,this._requestCalcAndDrawText()},e.getTextFormat=function(){return this._defaultTextFormat},e.setTextFormat=function(e){this._defaultTextFormat&&(this._defaultTextFormat=null),this._defaultTextFormat=e,this._requestCalcAndDrawText()},e.height={get:function(){return this._getBoundsRect().height},set:function(e){if(this._naturalRect.height==e)return;this._naturalRect.height=e,this._requestCalcNaturalRect()}},e.width={get:function(){return this._getBoundsRect().width},set:function(e){if(this._naturalRect.width==e)return;this._naturalRect.width=e,this._requestCalcNaturalRect()}},e._requestCalcAndDrawText=function(){this._drawTextRequested=!0,this._calcTextRequested=!0},e._drawVectorGraphics=function(){},e._glPrepare=function(e){this._drawTextRequested&&this._drawText();var n=this._getRenderingNode();return n.bitmapProxy=this._bitmapProxy,t._glPrepare.call(this,e)},e._calculateNaturalRect=function(){this._calcTextRequested&&this._calcText();var e=this._defaultTextFormat;switch(this._autoSize){case r.NONE:break;case r.LEFT:var t=new Rectangle;t.width=this._textRect.width+a*2+this._defaultTextFormat.leftMargin+this._defaultTextFormat.blockIndent+this._defaultTextFormat.rightMargin,t.height=this._textRect.height+a*2,this._naturalRect=t;break;case r.CENTER:var n=this._naturalRect.width,t=new Rectangle;t.width=this._textRect.width+a*2+this._defaultTextFormat.leftMargin+this._defaultTextFormat.blockIndent+this._defaultTextFormat.rightMargin,t.height=this._textRect.height+a*2,this._naturalRect=t,this.x=this.x+(n-t.width)/2;break;case r.RIGHT:var n=this._naturalRect.width,t=new Rectangle;t.width=this._textRect.width+a*2+this._defaultTextFormat.leftMargin+this._defaultTextFormat.blockIndent+this._defaultTextFormat.rightMargin,t.height=this._textRect.height+a*2,this._naturalRect=t,this.x=this.x+(n-t.width)}},e._requestCalcNaturalRect=function(e){if(e)return;this._requestCalcAndDrawText(),t._requestCalcNaturalRect.call(this,e)},e._drawText=function(){var e=this._getMatrix();if(e._getScaleX()==0||e._getScaleY()==0)return;var t=this._getNaturalRect(),n=new Rectangle(0,0,e._getScaleX()*t.width,e._getScaleY()*t.height);this._drawTextRequested=!1;if(!this._bitmapProxy||n.width!=this._bitmapProxy.width()||n.height!=this._bitmapProxy.height())this._bitmapProxy=s.create(n.width,n.height);var r=this._bitmapProxy.getCanvas();this._background?(r.setFillColor(f(this._backgroundColor,1)),r.fillRect(0,0,this._bitmapProxy.width(),this._bitmapProxy.height())):r.clear(),this._border&&(r.setStrokeColor(f(this._borderColor,1)),r.strokeRect(0,0,this._bitmapProxy.width(),this._bitmapProxy.height())),r.setFillColor(f(this._defaultTextFormat.color,1)),r.setFontSize(this._defaultTextFormat.size*e._getScaleY()),r.setLetterSpacing(this._defaultTextFormat.letterSpacing);var o=this._calcTextLinePositions(),u=r.getFontMetrics(),l=u.ascent,c=u.descent,h=this._defaultTextFormat.leading,p=a+this._defaultTextFormat.leftMargin+this._defaultTextFormat.blockIndent,d=a,v=o.length;for(var m=0;m<v;m+=2){var g=o[m],y=o[m+1];if(g<0)continue;var b=this.text.substring(g,y+1);p=a+this._defaultTextFormat.leftMargin+this._defaultTextFormat.blockIndent;if(m==0||o[m-1]+1!=g)p+=this._defaultTextFormat.indent;switch(this._defaultTextFormat.align){case i.LEFT:break;case i.CENTER:var w=r.measureText(b);p+=(n.width-p-this._defaultTextFormat.rightMargin-w)/2;break;case i.RIGHT:var w=r.measureText(b);p+=n.width-p-this._defaultTextFormat.rightMargin-w;break;case i.JUSTIFY:}d=m/2*(-l+c+h),r.fillText(p,d,b)}},e._calcText=function(){calcTextRequested=!1;var e=this._getMatrix(),t=this._calcTextLinePositions(),n=this._bitmapProxy.getCanvas();n.setFontSize(this._defaultTextFormat.size*e._getScaleY()),n.setLetterSpacing(this._defaultTextFormat.letterSpacing),this._textRect=new Rectangle;if(this._wordWrap)this._textRect.width=this._naturalRect.width-(a*2+this._defaultTextFormat.leftMargin+this._defaultTextFormat.blockIndent+this._defaultTextFormat.rightMargin);else{var r=t.length;for(var i=0;i<r;i+=2){var s=t[i],o=t[i+1];if(s<0)continue;var u=this._text.substring(s,o+1),f=n.measureText(u);this._textRect.width<f&&(this._textRect.width=f)}}var l=n.getFontMetrics(),c=l.ascent,h=l.descent,p=this._defaultTextFormat.leading,d=t.length/2;this._textRect.height=(-c+h)*d+p*(d-1)},e._calcTextLinePositions=function(){var e=this._text,t=[];t.push(0);var n;n=0;for(;;){var r=e.indexOf("\r",n);if(r==-1)break;var i=r;i+1<e.length&&e.charAt(i+1)=="\n"?(t.push(i-1),t.push(i+2)):(t.push(i-1),t.push(i+1)),n=r+1}n=0;for(;;){var r=e.indexOf("\n",n);if(r==-1)break;var i=r;i-1>=0&&e.charAt(i-1)!="\r"&&(t.push(i-1),t.push(i+1)),n=r+1}t.push(e.length-1),t.sort(function(e,t){return e-t});if(this._wordWrap!=1)return t;var s=this._getConcatenatedMatrix(),o=new Rectangle(a,a,-a*2+s._getScaleX()*this._naturalRect.width-this._defaultTextFormat.leftMargin-this._defaultTextFormat.blockIndent-this._defaultTextFormat.rightMargin,-a*2+s._getScaleY()*this._naturalRect.height),u=this._bitmapProxy.getCanvas();u.setFontSize(this._defaultTextFormat.size*s._getScaleY()),u.setLetterSpacing(this._defaultTextFormat.letterSpacing);var f=t.slice(),l=0;while(l<f.length){var c=f[l];l++,c==-1&&(c=0);var h=f[l];l<f.length&&l++;var p=h-c+1,d=e.substring(c,h+1),v=u.breakText(d,o.width-this._defaultTextFormat.indent);while(v<p){t.push(c+v-1),t.push(c+v),c+=v,p=h-c+1;var d=e.substring(c,h+1);v=u.breakText(d,o.width);if(v==p)break}}return t.sort(function(e,t){return e-t}),t},e._createRenderingNode=function(){return new c},e.toString=function(){return'[object TextField name="'+this.name+'"]'}}),c=e(o,function(e,t){e.object,e.width,e.height,e.clippingRect=null,e.bitmapProxy=null,e.scale9Grid=null,e.constructor=function(){t.constructor.call(this),this.object=new u,this.clippingRect=new Rectangle,this.scale9Grid=new Rectangle},e.visit=function(e){if(!this.bitmapProxy)return;if(!this.visible||!e.parent.visible){t.visit.call(this,e);return}this.scale9Grid.isEmpty()&&t.visit.call(this,e);var n=this.concatenatedMatrix.clone(),r=this.object;r.bitmapProxy=this.bitmapProxy,r.blendMode=this.blendMode,r.maskNode=this.mask,r.colorTransform=this.concatenatedColorTransform,r.matrix=n,r.offsetX=0,r.offsetY=0,r.width=this.width,r.height=this.height,r.clippingRect=this.clippingRect,this.clippingRect.isEmpty()!=1&&(r.offsetX+=this.clippingRect.x,r.offsetY+=this.clippingRect.y,r.width=this.clippingRect.w,r.height=this.clippingRect.h),e.renderingRequests.push(r)}});return l}),herlock.define("module/view_canvas/flash/flash",["./display/DisplayObject","./display/InteractiveObject","./display/DisplayObjectContainer","./display/Sprite","./display/Stage","./display/BitmapData","./display/Bitmap","./text/TextField","./text/TextFieldAutoSize","./text/TextFormat","./geom/Transform","./events/InteractiveObjectTouchEvent"],function(e,t,n,r,i,s,o,u,a,f,l,c){var h={installTo:function(h){h.DisplayObject=e,h.InteractiveObject=t,h.DisplayObjectContainer=n,h.Sprite=r,h.Stage=i,h.BitmapData=s,h.Bitmap=o,h.TextField=u,h.TextFieldAutoSize=a,h.TextFormat=f,h.Transform=l,h.InteractiveObjectTouchEvent=c},initJs:function(e){e.Event.ENTER_FRAME="enterFrame",e.Event.EXIT_FRAME="exitFrame"}};return h}),herlock.define("module/view_canvas/geom/Point",["lib/Class"],function(e){var t=function(e,t){this.x=0,this.y=0,arguments.length>=1&&(this.x=e),arguments.length>=2&&(this.y=t)};return t.prototype=Object.create({},{add:{value:function(e){return new t(this.x+e.x,this.y+e.y)},writable:!0},subtract:{value:function(e){return new t(this.x-e.x,this.y-e.y)},writable:!0},clone:{value:function(){return new t(this.x,this.y)},writable:!0},equals:{value:function(e){return this.x===e.x&&this.y===e.y},writable:!0},normalize:{value:function(e){var t=Math.sqrt(this.x*this.x+this.y*this.y);this.x=this.x/t*e,this.y=this.y/t*e},writable:!0},offset:{value:function(e){this.x+=e.x,this.y+=e.y},writable:!0},toString:{value:function(){return'[object Point x="'+this.x+'" y="'+this.y+'"]'},writable:!0}}),t}),herlock.define("module/view_canvas/geom/Rectangle",["lib/Class","./Point"],function(e,t){var n=function(e,t,n,r){this.x=0,this.y=0,this.width=0,this.height=0;var i=arguments.length;i>0&&(this.x=arguments[0]),i>1&&(this.y=arguments[1]),i>2&&(this.width=arguments[2]),i>3&&(this.height=arguments[3])};return n.prototype=Object.create({},{top:{get:function(){return this.y},set:function(e){this.height+=this.y-e,this.y=e}},right:{get:function(){return this.x+this.width},set:function(e){this.width+=e-this.right}},bottom:{get:function(){return this.y+this.height},set:function(e){this.height+=e-this.bottom}},left:{get:function(){return this.x},set:function(e){this.width+=this.x-e,this.x=e}},topLeft:{get:function(){return new t(this.left,this.top)},set:function(e){this.left=e.x,this.top=e.y}},bottomRight:{get:function(){return new t(this.right,this.bottom)},set:function(e){this.right=e.x,this.bottom=e.y}},size:{get:function(){return new t(this.width,this.height)},set:function(e){this.width=e.x,this.height=e.y}},clone:{value:function(){return new n(this.x,this.y,this.width,this.height)},writable:!0},contains:{value:function(e,t){return this.left<=e&&e<=this.right&&this.top<=t&&t<=this.bottom},writable:!0},containsPoint:{value:function(e){return this.contains(e.x,e.y)},writable:!0},containsRect:{value:function(e){return this.top<=e.top&&e.bottom<=this.bottom&&this.left<=e.left&&e.right<=this.right},writable:!0},equals:{value:function(e){return this.x==e.x&&this.y==e.y&&this.width==e.width&&this.height==e.height},writable:!0},inflate:{value:function(e,t){this.x-=e,this.width+=2*e,this.y-=t,this.height+=2*t},writable:!0},inflatePoint:{value:function(e){this.inflate(e.x,e.y)},writable:!0},intersects:{value:function(e){return this.top>e.bottom||this.left>e.right||this.right<e.left||this.bottom<e.top?!1:!0},writable:!0},intersection:{value:function(e){if(this.intersects(e)!=1)return new n;var t,r,i,s;return t=this.top>e.top?this.top:e.top,r=this.right<e.right?this.right:e.right,i=this.bottom<e.bottom?this.bottom:e.bottom,s=this.left>e.left?this.left:e.left,new n(s,t,r-s,i-t)},writable:!0},isEmpty:{value:function(){return this.width<=0||this.height<=0},writable:!0},offset:{value:function(e,t){this.x+=e,this.y+=t},writable:!0},offsetPoint:{value:function(e){this.offset(e.x,e.y)},writable:!0},setEmpty:{value:function(){this.x=0,this.y=0,this.width=0,this.height=0},writable:!0},union:{value:function(e){if(this.isEmpty()&&e.isEmpty())return new n;if(e.isEmpty())return this.clone();if(this.isEmpty())return e.clone();var t,r,i,s;return t=this.top<e.top?this.top:e.top,r=this.right>e.right?this.right:e.right,i=this.bottom>e.bottom?this.bottom:e.bottom,s=this.left<e.left?this.left:e.left,new n(s,t,r-s,i-t)},writable:!0},_set:{value:function(e,t,n,r){this.x=e,this.y=t,this.width=n,this.height=r},writable:!0},toString:{value:function(){return'[object Rectangle x="'+this.x+'" y="'+this.y+'" width="'+this.width+'" height="'+this.height+'"]'},writable:!0}}),n}),herlock.define("module/view_canvas/geom/Matrix",["lib/Class","./Point","./Rectangle"],function(e,t,n){var r=Math.PI,i=0,s=1,o=2,u=3,a=4,f=5,l=[1,0,0,1,0,0],c=function(e,t,n,r,i,s){var o=arguments.length,u;o===0?(u=this._values=[1,0,0,1,0,0],this._isInitialValue=!0):(u=this._values=[o>0?e:1,o>1?t:0,o>2?n:0,o>3?r:1,o>4?i:0,o>5?s:0],this._isInitialValue=u[0]===1&&u[1]===0&&u[2]===0&&u[3]===1&&u[4]===0&&u[5]===0),this._version=Math.random()*1e7<<0};return c.prototype=Object.create({},{a:{get:function(){return this._values[0]},set:function(e){this._values[0]=e,this._increment()}},b:{get:function(){return this._values[1]},set:function(e){this._values[1]=e,this._increment()}},c:{get:function(){return this._values[2]},set:function(e){this._values[2]=e,this._increment()}},d:{get:function(){return this._values[3]},set:function(e){this._values[3]=e,this._increment()}},tx:{get:function(){return this._values[4]},set:function(e){this._values[4]=e,this._increment()}},ty:{get:function(){return this._values[5]},set:function(e){this._values[5]=e,this._increment()}},_increment:{value:function(){this._version++,this._isInitialValue=!1},writable:!0},_getVersion:{value:function(){return this._version},writable:!0},isInitialValue:{value:function(){return this._isInitialValue},writable:!0},clone:{value:function(){var e=new c;return e._values=this._values.slice(),e._version=this._version,e._isInitialValue=this._isInitialValue,e},writable:!0},concat:{value:function(e){if(e.isInitialValue())return;this._concat(e._values)},writable:!0},_concat:{value:function(e){if(this.isInitialValue())this._values=e;else{var t=this._values,n=e;this._values=[t[0]*n[0]+t[1]*n[2],t[0]*n[1]+t[1]*n[3],t[2]*n[0]+t[3]*n[2],t[2]*n[1]+t[3]*n[3],t[4]*n[0]+t[5]*n[2]+n[4],t[4]*n[1]+t[5]*n[3]+n[5]]}this._increment()},writable:!0},createBox:{value:function(){},writable:!0},createGradientBox:{value:function(){},writable:!0},deltaTransformPoint:{value:function(){},writable:!0},identity:{value:function(){this._values=[1,0,0,1,0,0],this._increment(),this._isInitialValue=!0},writable:!0},invert:{value:function(){var e=this.a*this.d-this.c*this.b;if(e===0)return;var t=1/e,n=this.tx;this.tx=(this.c*this.ty-n*this.d)*t,this.ty=(n*this.b-this.a*this.ty)*t,this.c=-this.c*t,this.b=-this.b*t,n=this.a,this.a=this.d*t,this.d=n*t,this._increment()},writable:!0},rotate:{value:function(e){var t=Math.cos(e),n=Math.sin(e);this._concat([t,n,-n,t,0,0])},writable:!0},scale:{value:function(e,t){this._concat([e,0,0,t,0,0])},writable:!0},transformPoint:{value:function(e){var n=this._values;return new t(e.x*n[0]+e.y*n[2]+1*n[4],e.x*n[1]+e.y*n[3]+1*n[5])},writable:!0},translate:{value:function(e,t){this._concat([1,0,0,1,e,t])},writable:!0},_getScaleX:{value:function(){return Math.sqrt(this.a*this.a+this.b*this.b)},writable:!0},_setScaleX:{value:function(e){this._increment();var t=this._getScaleX();if(t!==0){var n=e/t;this.a*=n,this.b*=n}else{var r=this._getSkewY_();this.a=Math.cos(r)*e,this.b=Math.sin(r)*e}},writable:!0},_getScaleY:{value:function(){return Math.sqrt(this.c*this.c+this.d*this.d)},writable:!0},_setScaleY:{value:function(e){this._increment();var t=this._getScaleY();if(t!==0){var n=e/t;this.c*=n,this.d*=n}else{var r=this._getSkewX_();this.c=-Math.sin(r)*e,this.d=Math.cos(r)*e}},writable:!0},_getSkewX:{value:function(){return this._getSkewX_()*(180/r)},writable:!0},_setSkewX:{value:function(e){this._setSkewX_(e*(r/180))},writable:!0},_getSkewY:{value:function(){return this._getSkewY_()*(180/r)},writable:!0},_setSkewY:{value:function(e){this._setSkewY_(e*(r/180))},writable:!0},_getRotation:{value:function(){return this._getSkewY_()*(180/r)},writable:!0},_setRotation:{value:function(e){this._setRotation_(e*(r/180))},writable:!0},_getX:{value:function(){return this.tx},writable:!0},_setX:{value:function(e){this.tx=e,this._increment()},writable:!0},_getY:{value:function(){return this.ty},writable:!0},_setY:{value:function(e){this.ty=e,this._increment()},writable:!0},_setRotation_:{value:function(e){var t=this._getSkewY_(),n=this._getSkewX_();this._setSkewX_(n+e-t),this._setSkewY_(e)},writable:!0},_getSkewX_:{value:function(){return Math.atan2(-this.c,this.d)},writable:!0},_setSkewX_:{value:function(e){var t=this._getScaleY();this.c=-t*Math.sin(e),this.d=t*Math.cos(e),this._increment()},writable:!0},_getSkewY_:{value:function(){return Math.atan2(this.b,this.a)},writable:!0},_setSkewY_:{value:function(e){var t=this._getScaleX();this.a=t*Math.cos(e),this.b=t*Math.sin(e),this._increment()},writable:!0},_calculateBoundsRect:{value:function(e){var r=[this.transformPoint(e.topLeft),this.transformPoint(new t(e.right,e.top)),this.transformPoint(new t(e.left,e.bottom)),this.transformPoint(e.bottomRight)],i=r[0].y,s=r[0].y,o=r[0].x,u=r[0].x;for(var a=1;a<4;a++){var f=r[a];i>f.y&&(i=f.y),s<f.y&&(s=f.y),o>f.x&&(o=f.x),u<f.x&&(u=f.x)}return new n(o,i,u-o,s-i)},writable:!0},_equal:{value:function(e){for(var t=0;t<6;t++)if(this._values[t]!=e._values[t])return!1;return!0},writable:!0}}),c}),herlock.define("module/view_canvas/geom/ColorTransform",["lib/Class"],function(e){function s(e,t,n){return e<<16|t<<8|n<<0}function o(e,t){return Math.round(t*255)<<24|e}function u(e){return e>>24&255}function a(e){return e>>16&255}function f(e){return e>>8&255}function l(e){return e>>0&255}var t=0,n=1,r=2,i=3,c=function(e,t,n,r,i,s,o,u){var a=arguments.length;if(a===0){this._version=Math.floor(Math.random()*1e7),this.__isInitialValue=!0,this._multiplier=[1,1,1,1],this._offset=[0,0,0,0];return}e=a>0?e:1,t=a>1?t:1,n=a>2?n:1,r=a>3?r:1,i=a>4?i:0,s=a>5?s:0,o=a>6?o:0,u=a>7?u:0,this._version=Math.floor(Math.random()*1e7),this.__isInitialValue=e==1&&t==1&&n==1&&r==1&&i==0&&s==0&&o==0&&u==0,this._multiplier=[e,t,n,r],this._offset=[i,s,o,u]};return c.prototype=Object.create({},{_increment:{writable:!0,value:function(){this._version++,this.__isInitialValue=!1}},_getVersion:{writable:!0,value:function(){return this._version}},_isInitialValue:{writable:!0,value:function(){return this.__isInitialValue}},color:{get:function(){return s(this._offset[t],this._offset[n],this._offset[r])},set:function(e){this._multiplier[t]=1,this._multiplier[n]=1,this._multiplier[r]=1,this._offset[t]=a(e),this._offset[n]=f(e),this._offset[r]=l(e),this._increment()}},alphaMultiplier:{get:function(){return this._multiplier[i]},set:function(e){this._multiplier[i]=e,this._increment()}},redMultiplier:{get:function(){return this._multiplier[t]},set:function(e){this._multiplier[t]=e,this._increment()}},greenMultiplier:{get:function(){return this._multiplier[n]},set:function(e){this._multiplier[n]=e,this._increment()}},blueMultiplier:{get:function(){return this._multiplier[r]},set:function(e){this._multiplier[r]=e,this._increment()}},alphaOffset:{get:function(){return this._offset[i]},set:function(e){this._offset[i]=e,this._increment()}},redOffset:{get:function(){return this._offset[t]},set:function(e){this._offset[t]=e,this._increment()}},greenOffset:{get:function(){return this._offset[n]},set:function(e){this._offset[n]=e,this._increment()}},blueOffset:{get:function(){return this._offset[r]},set:function(e){this._offset[r]=e,this._increment()}},clone:{writable:!0,value:function(){var e=new c(this._multiplier[t],this._multiplier[n],this._multiplier[r],this._multiplier[i],this._offset[t],this._offset[n],this._offset[r],this._offset[i]);return e._version=this._version,e}},concat:{writable:!0,value:function(e){if(e._isInitialValue())return;if(e._isInitialValue()){var s=e._multiplier,o=e._offset;this._multiplier[t]=s[t],this._multiplier[n]=s[n],this._multiplier[r]=s[r],this._multiplier[i]=s[i],this._offset[t]=o[t],this._offset[n]=o[n],this._offset[r]=o[r],this._offset[i]=o[i],this._increment()}else this._concat(e._multiplier,e._offset)}},_concat:{writable:!0,value:function(e,s){this._multiplier[t]*=e[t],this._multiplier[n]*=e[n],this._multiplier[r]*=e[r],this._multiplier[i]*=e[i],this._offset[t]=this._offset[t]*e[t]+s[t],this._offset[n]=this._offset[n]*e[n]+s[n],this._offset[r]=this._offset[r]*e[r]+s[r],this._offset[i]=this._offset[i]*e[i]+s[i],this._increment()}},_isAlphaTransform:{writable:!0,value:function(){return this._multiplier[i]!=1&&this._multiplier[t]==1&&this._multiplier[n]==1&&this._multiplier[r]==1&&this._offset[t]==0&&this._offset[n]==0&&this._offset[r]==0&&this._offset[i]==0}},_isColorTransform:{writable:!0,value:function(){return!this._isInitialValue()&&!this._isAlphaTransform()}},_getValueArray:{writable:!0,value:function(){var e=[];return e[0]=this._multiplier[t],e[1]=this._multiplier[n],e[2]=this._multiplier[r],e[3]=this._multiplier[i],e[4]=this._offset[t]/255,e[5]=this._offset[n]/255,e[6]=this._offset[r]/255,e[7]=this._offset[i]/255,e}}}),c}),herlock.define("module/view_canvas/geom/geom",["./Point","./Rectangle","./Matrix","./ColorTransform"],function(e,t,n,r){var i={installTo:function(i){i.Point=e,i.Rectangle=t,i.Matrix=n,i.ColorTransform=r},initJs:function(e){}};return i}),window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame,function(){var e=document.createElement("div").style,t={transform:"webkitTransform"in e?"webkitTransform":"MozTransform"in e?"MozTransform":"transform",transformOrigin:"webkitTransformOrigin"in e?"webkitTransformOrigin":"MozTransformOrigin"in e?"MozTransformOrigin":"transformOrigin"};"webkitTransform"in e?window.__setTransform=function(e,t){e.webkitTransform=t}:"MozTransform"in e?window.__setTransform=function(e,t){e.MozTransform=t}:"transform"in e&&(window.__setTransform=function(e,t){e.transform=t});if("transformOrigin"in e)return;var n={};for(var r in t)(function(e,t){n[e]={get:function(){return this[t]},set:function(e){this[t]=e}}})(r,t[r]);Object.defineProperties(CSSStyleDeclaration.prototype,n)}(),herlock.define("module/view_canvas/NJView",["lib/Class","module/NJModule","./window/window","./layer/Layer","./image/Image","./flash/flash","./geom/geom","./geom/Rectangle","module/view/touch/TouchEventInfo","./flash/internal/renderer/CanvasRenderingSystem"],function(e,t,n,r,i,s,o,u,a,f){var l=e(t,function(e,t){e.constructor=function(e,n,r){t.constructor.apply(this,arguments),f.container=this._container=e,f.width=this._width=n,f.height=this._height=r,this._layers=[];var i=this;requestAnimationFrame(function(){i._onDrawFrame(),requestAnimationFrame(arguments.callee)});var s=!1,o=function(e){var t,n=!0;switch(e.type){case"mousedown":s=!0,t=a.DOWN;break;case"mousemove":if(!s)return;t=a.MOVE;break;case"mouseup":s=!1,t=a.UP,n=!1;break;case"mouseleave":if(!s)return;s=!1,t=a.CANCEL,n=!1}var r=new a(t);if(!touchEnabled&&e.type.indexOf("mouse")!==-1){var o,u;o=e.clientX-e.currentTarget.offsetLeft,u=e.clientY-e.currentTarget.offsetTop;if(this.style.transform!==""){var f={x:o,y:u},l=this.style.transform,c=[],h;l.indexOf("matrix")!==-1&&l.split(",").forEach(function(e){c.push(parseFloat(e))}),l.indexOf("scale")!==-1&&(h=l.split("scale(")[1].split(","))&&(c=[parseFloat(h[0]),0,0,parseFloat(h[1]),0,0]),o=f.x*c[0]+f.y*c[2]+1*c[4],u=f.x*c[1]+f.y*c[3]+1*c[5]}r.addTouchPoint("mouse",o,u,!0,n)}else if(e.type.indexOf("touch")!==-1){touchEnabled=!0;var p=e.touches,d=e.changedTouches;for(var v=0;v<p.length;v++){var m=p[v],o,u;o=m.clientX-e.currentTarget.offsetLeft,u=m.clientY-e.currentTarget.offsetTop;if(this.style.transform!==""){var f={x:o,y:u},l=this.style.transform,c=[],h;l.indexOf("matrix")!==-1&&l.split(",").forEach(function(e){c.push(parseFloat(e))}),l.indexOf("scale")!==-1&&(h=l.split("scale(")[1].split(","))&&(c=[parseFloat(h[0]),0,0,parseFloat(h[1]),0,0]),o=f.x*c[0]+f.y*c[2]+1*c[4],u=f.x*c[1]+f.y*c[3]+1*c[5]}r.addTouchPoint(m.identifier,o,u,!1,!0)}for(var v=0;v<d.length;v++){var m=d[v],o,u;o=m.clientX-e.currentTarget.offsetLeft,u=m.clientY-e.currentTarget.offsetTop;if(this.style.transform!==""){var f={x:o,y:u},l=this.style.transform,c=[],h;l.indexOf("matrix")!==-1&&l.split(",").forEach(function(e){c.push(parseFloat(e))}),l.indexOf("scale")!==-1&&(h=l.split("scale(")[1].split(","))&&(c=[parseFloat(h[0]),0,0,parseFloat(h[1]),0,0]),o=f.x*c[0]+f.y*c[2]+1*c[4],u=f.x*c[1]+f.y*c[3]+1*c[5]}r.addTouchPoint(m.identifier,o,u,!0,n)}}i._notifyTouch(r)};this._container.addEventListener("touchstart",o),this._container.addEventListener("touchend",o),this._container.addEventListener("touchmove",o),this._container.addEventListener("touchcancel",o),this._container.addEventListener("mousemove",o),this._container.addEventListener("mouseup",o),this._container.addEventListener("mousedown",o),this._container.addEventListener("mouseleave",o)},e.getName=function(){return"View"},e.installTo=function(e){n.installTo(e,this),e.Layer=r,e.Image=i,s.installTo(e),o.installTo(e)},e.initJs=function(e){n.initJs(e),s.initJs(e),o.initJs(e)},e.start=function(){},e.reset=function(){},e.addLayer=function(e){return this.addLayerAt(e,this._layers.length)},e.addLayerAt=function(e,t){var n=e.isInstanceOf(r)?e:new r(e);return this.getLayerIndex(n)!=-1&&this.removeLayer(n),this._layers.splice(t,0,n),n._addedTo(this),n},e.getLayerAt=function(e){return this._layers[e]},e.getLayerIndex=function(e){return this._layers.indexOf(e)},e.removeLayer=function(e){return this.removeLayerAt(this._layers.indexOf(e))},e.removeLayerAt=function(e){var t=this.getLayerAt(e);return this._layers.splice(e,1),t},e.getViewWidth=function(){return this._width},e.getViewHeight=function(){return this._height},e.getViewTop=function(){return 0},e.getViewLeft=function(){return 0},e._onDrawFrame=function(){var e=this._glPrepare();this._glRender(e),this._notifyDrawFrame()},e._glPrepare=function(){if(this._layers.length<=0)return;var e=this._layers.length,t=[];for(var n=0;n<e;n++){var r=this._layers[n]._glPrepare();r&&t.push(r)}return t},e._glRender=function(e){if(this._layers.length<=0)return;var t=e.length;for(var n=0;n<t;n++)e[n].processData();for(var n=0;n<t;n++){var r=e[n];r.render()}},e._notifyDrawFrame=function(){for(var e in this._layers)this._layers[e]._notifyDrawFrame()},e._notifyTouch=function(e){var t=this._layers.slice(),n=t.length;for(var r=0;r<n;r++)t[r]._notifyTouch(e)}});return l}),herlock.define("module/google_analytics/NJGoogleAnalytics",["lib/Class","module/NJModule"],function(e,t){var n=e(t,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments)},e.installTo=function(e){},e.initJs=function(e){e.googleAnalytics=new r}}),r=e(Object,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments)},e.init=function(e){},e.screen=function(e){},e.event=function(){}});return n}),herlock.define("module/webview/NJWebView",["lib/Class","module/NJModule","module/common/event/EventDispatcher"],function(e,t,n){var r=e(t,function(e,t){e.constructor=function(e){t.constructor.apply(this,arguments),this._container=e},e.installTo=function(e){},e.initJs=function(e){e.webview=new i(this)}}),i=e(n,function(e,t){e.constructor=function(e){t.constructor.apply(this,arguments),this._module=e,this._iframe=null,this._layout=new Rectangle,this._iframe=this._createIframe(),document.head.appendChild(this._iframe)},e._createIframe=function(){var e=document.createElement("iframe");return e.setAttribute("seamless",!0),e.style.position="absolute",e.style.top=0,e.style.left=0,e.style.width=this._layout.width+"px",e.style.height=this._layout.height+"px",e.style.border="0",e},e.load=function(e){if(!this._iframe||!this._iframe.parentNode)this._iframe=this._createIframe(),document.head.appendChild(this._iframe);var t=this;if(this._iframe.src===e){setTimeout(function(){t._dispatchEventAndCallHandler(new Event("load"))},10);return}var n=function(){t._iframe.removeEventListener("load",n),t._dispatchEventAndCallHandler(new Event("load"))};this._iframe.addEventListener("load",n),this._iframe.src=e},e.show=function(){this._module._container.appendChild(this._iframe)},e.hide=function(){this._iframe.parentNode&&this._iframe.parentNode.removeChild(this._iframe)},e.goForward=function(){},e.goBack=function(){},e.reload=function(){},e.getLayout=function(){return this._layout},e.setLayout=function(e){this._iframe.style.transform="matrix3d( 1, 0, 0, 0,  0, 1, 0, 0,  0, 0, 1, 0,  "+e.x+","+e.y+", 0, 1)",this._layout.width!=e.width&&(this._iframe.style.width=e.width+"px"),this._layout.height!=e.height&&(this._iframe.style.height=e.height+"px"),this._layout=e},e.sendMessage=function(){},e.evalJS=function(){}});return r}),herlock.define("module/xhr/NJXhr",["lib/Class","module/NJModule","lib/URL"],function(e,t,n){var r=XMLHttpRequest.prototype.open,i=e(t,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments)},e.installTo=function(e){XMLHttpRequest.prototype.open=function(e,t,i,s,o){var u=new n(t),a=window.__herlock_ctx;t=u.host===""?a._rootPath+u:u.toString(),arguments[1]=t,r.apply(this,arguments)}},e.initJs=function(e){}});return i}),herlock.define("module/sound/audio/Audio",["lib/Class","module/common/event/EventDispatcher","lib/URL"],function(e,t,n){var r=e(t,function(e,t){e.constructor=function(e,n){t.constructor.apply(this,arguments),this._src="",this._type=n||r.MUSIC,this._volume=1,this._playing=!1,this._loop=!1,e&&(this.src=e)},e.src={get:function(){return this._src},set:function(e){this._src=e;var t=new n(e);this._audio=null;var r=document.createElement("audio"),i=window.__herlock_ctx,s=this;r.oncanplaythrough=function(){s._audio=r,s._dispatchEventAndCallHandler(new Event("load")),s._audio.volume=s._volume,s._audio.loop=s._loop,s._playing&&s.play()},r.src=t.host===""?i._rootPath+t:t.toString()}},e.type={get:function(){return this._type}},e.complete={get:function(){return!!this._audio}},e.volume={get:function(){return this._volume},set:function(e){this._volume=e,this._audio&&(this._audio.volume=e)}},e.loop={get:function(){return this._loop},set:function(e){this._loop=e,this._audio&&(this._audio.loop=e)}},e.play=function(){this._playing=!0;if(!this._audio)return;this._audio.pause(),this._audio.currentTime=0,this._audio.play()},e.pause=function(){this._playing=!1;if(!this._audio)return;this._audio.pause()},e.resume=function(){this._playing=!0;if(!this._audio)return;this._audio.pause(),this._audio.play()},e.stop=function(){this._playing=!1;if(!this._audio)return;this._audio.pause(),this._audio.currentTime=0},e.clone=function(){return new r(this.src,this.type)}});return r.MUSIC="music",r.SE="se",r}),herlock.define("module/sound/NJSound",["lib/Class","module/NJModule","lib/URL","./audio/Audio"],function(e,t,n,r){var i=e(t,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments)},e.installTo=function(e){e.Audio=r},e.initJs=function(e){}});return i}),herlock.define("module/nativeui/NJNativeUI",["lib/Class","module/NJModule"],function(e,t){var n=e(t,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments)},e.getName=function(){return"NativeUI"},e.installTo=function(e){},e.initJs=function(e){var t=window.alert;e.alert=function(e,n){if(!n)throw new Error("ArgumentError! alert( String, Function() );");setTimeout(function(){t(e),n()},10)};var n=window.confirm;e.confirm=function(e,t){if(!t)throw new Error("ArgumentError! confirm( String, Function( boolean ) );");setTimeout(function(){t(n(e))},10)};var r=window.prompt;e.prompt=function(e,t,n){if(!n)throw new Error("ArgumentError! prompt( String, String, Function( String ) );");setTimeout(function(){n(r(e,t))},10)},e.picker=function(e,t,n){if(!n)throw new Error("ArgumentError! picker( Array, Number, Function( String ) );");setTimeout(function(){console.log("NJNativeUI.picker ... TODO picker UI"),n(e[t])},10)}},e.start=function(){t.start.call(this)},e.reset=function(){}});return n}),herlock.define("module/local_notification/NJLocalNotification",["lib/Class","module/NJModule","module/common/event/EventDispatcher"],function(e,t,n){var r=e(t,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments)},e.getName=function(){return"LocalNotification"},e.installTo=function(e){e.LocalNotification=i},e.initJs=function(e){e.localNotification=new i(this)},e.reset=function(){}}),i=e(n,function(e,t){e.constructor=function(e){t.constructor.call(this),this._module=e},e.enable=function(){},e.cancelAll=function(){},e.schedule=function(e,t,n){}});return r}),herlock.define("module/push/NJPush",["lib/Class","module/NJModule","module/common/event/EventDispatcher"],function(e,t,n){var r=e(t,function(e,t){e.constructor=function(){t.constructor.apply(this,arguments)},e.getName=function(){return"Push"},e.installTo=function(e){e.PushNotification=i},e.initJs=function(e){e.pushNotification=new i(this)},e.reset=function(){}}),i=e(n,function(e,t){e.constructor=function(e){t.constructor.call(this),this._module=e},e.generateDeviceToken=function(){return console.log("PushNotification.generateDeviceToken ... dummy"),null}});return r}),herlock.define("Player",["lib/Class","NativeJS","module/script/NJScript","module/app/NJApp","module/location/NJLocation","module/view/NJView","module/view_css/NJView","module/view_canvas/NJView","module/google_analytics/NJGoogleAnalytics","module/webview/NJWebView","module/xhr/NJXhr","module/sound/NJSound","module/nativeui/NJNativeUI","module/local_notification/NJLocalNotification","module/push/NJPush"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){var v=e(Object,function(e,v){e.constructor=function(e,v){v=v||{};if(!e&&window.parent)try{var m=window.parent.herlock.getParams(),g=window.parent.location.href.split("?")[0].split("#")[0];e=g.substr(0,g.lastIndexOf("/")+1)+m.mainJsURL;for(var y in m.options)v[y]=m.options[y]}catch(b){}this._container=v.container,this._container?(v.width=v.width||this._container.width,v.height=v.height||this._container.height):(this._container=document.createElement("div"),this._container.id="herlock_player",this._container.width=v.width,this._container.height=v.height,this._container.style.overflow="hidden",document.body.appendChild(this._container));var w=this._njs=new t,E=null;w.registerModule(new n),w.registerModule(E=new r),w.registerModule(new i),v.useViewCSS?w.registerModule(new o(this._container,v.width||innerWidth,v.height||innerHeight)):v.useViewCanvas?w.registerModule(new u(this._container,v.width||innerWidth,v.height||innerHeight)):w.registerModule(new s(this._container,v.width||innerWidth,v.height||innerHeight)),w.registerModule(new a),w.registerModule(new f(this._container)),w.registerModule(new l),w.registerModule(new c),w.registerModule(new h),w.registerModule(new p),w.registerModule(new d),e&&w.loadURL(e)}});return v}),herlock.require.config({baseUrl:"../"}),herlock.require(["Player"],function(e){console.log("required")}),herlock.define("grunt/compile_config",function(){});